<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Xu&#39;s Blog</title>
  
  <subtitle>Live&amp;Learn</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://zsx-cup.top/"/>
  <updated>2018-12-02T16:22:26.978Z</updated>
  <id>http://zsx-cup.top/</id>
  
  <author>
    <name>ZhaoShengxu</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>JavaWeb小结</title>
    <link href="http://zsx-cup.top/2018/12/02/JavaWeb%E5%B0%8F%E7%BB%93/"/>
    <id>http://zsx-cup.top/2018/12/02/JavaWeb小结/</id>
    <published>2018-12-02T09:40:55.000Z</published>
    <updated>2018-12-02T16:22:26.978Z</updated>
    
    <content type="html"><![CDATA[<ol><li><p>HTML：<a href="http://zsx-cup.top/2018/11/01/HTML%E5%85%A5%E9%97%A8/">HTML快速入门</a></p><ul><li>HTML的定义及作用</li><li>HTML的基本标签及其属性</li><li>form表单，Get和Post请求的区别</li><li>元素的概念理解</li><li>布局标签（最好能看懂）</li><li>相对路径与绝对路径、内部资源和外部资源</li></ul></li><li><p>CSS：<a href="http://zsx-cup.top/2018/11/04/CSS%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/">CSS快速入门</a></p><ul><li>Css的定义及作用</li><li>Css的选择器</li><li>Css和HTML结合的三种方式，即CSS引入方式</li><li>Css的 常用样式</li><li>Css+div 基本布局</li></ul></li><li><p>Javascript：<a href="http://zsx-cup.top/2018/11/06/JavaScript%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/">JavaScript快速入门</a></p><ul><li>Js的定义、作用及特点</li><li>Js和html结合的两种方式：外部使用与内部使用</li><li>Js的数据类型：原始数据类型和引用数据类型</li><li>Js的常用对象：Date、RegExp等</li><li>Js的流程控制：if，for</li><li>Js的方法声明、参数、返回值、调用</li><li><strong>常用事件及其与方法的结合方式</strong></li><li>Dom对象的常用方法</li><li><strong>表单校验</strong></li><li><strong>二级级联</strong></li></ul></li><li><p>jQuery：<a href="http://zsx-cup.top/2018/11/11/jQuery%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/">jQuery快速入门</a>|<a href="http://zsx-cup.top/2018/11/29/AJAX%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/">AJAX快速入门</a>|<a href="http://zsx-cup.top/2018/11/30/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/">动态代理</a></p><ul><li>什么是JQuery</li><li>JQuery的页面加载</li><li>JQuery的常用选择器</li><li>JQuery的效果</li><li><strong>JQuery的事件及事件绑定</strong></li><li>JQuery的文档操作</li><li>JQuery的遍历</li><li>全局加载函数</li><li>页面加载函数</li><li><strong>JQuery的Ajax</strong></li><li><strong>Jquery元素的对象</strong></li></ul></li><li><p>Bootstrap：<a href="http://zsx-cup.top/2018/11/12/Bootstrap%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/">Bootstrap快速入门</a></p><ul><li>容器</li><li>栅格系统</li><li>会用，能看懂</li></ul></li><li><p><strong>数据库</strong>：<a href="http://zsx-cup.top/2018/11/13/MYSQL%E6%95%B0%E6%8D%AE%E5%BA%93/">MySQL数据库</a></p><ul><li>数据库的增删改查</li><li>表的增删改查</li><li>表数据的增删改查</li><li>多表基本操作</li></ul></li><li><p><strong>JDBC</strong>：<a href="http://zsx-cup.top/2018/11/17/JDBC%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/">JDBC快速入门</a>|<a href="http://zsx-cup.top/2018/11/19/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/">数据库连接池</a>|<a href="http://zsx-cup.top/2018/11/20/c3p0%E5%8F%8A%E4%BA%8B%E5%8A%A1/">C3p0及事务</a></p><ul><li>Jdbc定义及作用</li><li>Jdbc的开发步骤（重要）</li><li>配置文件配置jdbc的参数</li><li>读取配置文件</li><li>什么是数据库连接池</li><li>数据库连接池的优点</li><li>数据库连接池的原理</li><li>Dbcp数据库连接池的基本使用</li><li>C3p0数据库连接池的基本使用</li><li>阿帕奇的dbUtils的基本使用</li><li>阿帕奇的beanUtils的基本使用</li><li>什么是事务，有什么用</li><li>事务的基本特性</li><li>Jdbc简单操作事务</li><li>事务不考虑隔离级别出现的问题<br>【注意依赖的jar包】</li></ul></li><li><p>HTTP协议</p><ul><li>什么是http协议</li><li>有什么用 ，有几部分组成</li><li>请求信息</li><li>响应信息</li></ul></li><li><p>Tomcat：<a href="http://zsx-cup.top/2018/11/21/Tomcat/">Tomcat</a></p><ul><li>什么是服务器</li><li>常见的服务器</li><li>tomcat的目录结构</li><li>Tomcat和eclipse结合 ,基本配置</li><li>使用Tomcat创建项目，发布项目，访问资源</li><li>知道自己发布项目的具体位置</li></ul></li><li><p>Servlet：<a href="http://zsx-cup.top/2018/11/22/Servlet/">Servlet</a>|<a href="http://zsx-cup.top/2018/11/24/Servlet%E5%BA%94%E7%94%A8%E5%B0%8F%E6%A1%88%E4%BE%8B/">Servlet应用小案例</a>|<a href="http://zsx-cup.top/2018/11/25/Xml%E8%A7%A3%E6%9E%90%E5%8F%8A%E4%BC%9A%E8%AF%9D%E6%8A%80%E6%9C%AF/">Xml解析及会话技术</a></p><ul><li>ServletConfig对象</li><li>ServletContext对象</li><li>HttpServletRequest对象</li><li>HttpServletResponse对象</li><li>HttpSession对象</li><li>Cookie对象</li><li>FIlter</li><li>Listener<br>【必须掌握页面传递参数到指定的servlet，servlet会接收页面的所有参数并操作数据库，必须会指数据展示到指定页面】</li></ul></li><li><p>JSP：<a href="http://zsx-cup.top/2018/11/26/JSP%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/">JSP快速入门</a>|<a href="http://zsx-cup.top/2018/11/27/%E5%80%9F%E5%8A%A9JSP%E5%AE%9E%E7%8E%B0%E6%B3%A8%E5%86%8C-%E7%99%BB%E5%BD%95-%E6%9F%A5%E8%AF%A2/">借助JSP实现注册|登录|查询</a>|<a href="http://zsx-cup.top/2018/11/28/JSON%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/">JSON快速入门</a></p><ul><li>什么是jsp，作用</li><li>基本语法</li><li>三大指令</li><li>Jsp的九大内置对象</li><li>Web阶段的四大作用域</li><li>什么是El表达式</li><li>EL作用</li><li>EL使用</li><li>El的11个隐式对象</li><li>JSTL的两个标签<br>C:if  test=””<br>C:foreach  items(${})  var </li></ul></li><li><p><a href="http://zsx-cup.top/2018/12/01/JavaWeb%E7%BB%BC%E5%90%88%E5%BA%94%E7%94%A8%EF%BC%9A%E5%95%86%E5%93%81%E7%AE%A1%E7%90%86/">JavaWeb综合应用：商品管理</a></p></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ol&gt;
&lt;li&gt;&lt;p&gt;HTML：&lt;a href=&quot;http://zsx-cup.top/2018/11/01/HTML%E5%85%A5%E9%97%A8/&quot;&gt;HTML快速入门&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;HTML的定义及作用&lt;/li&gt;
&lt;li&gt;HTML的基本标签及其属性
      
    
    </summary>
    
      <category term="JavaWeb" scheme="http://zsx-cup.top/categories/JavaWeb/"/>
    
    
  </entry>
  
  <entry>
    <title>JavaWeb综合应用：商品管理</title>
    <link href="http://zsx-cup.top/2018/12/01/JavaWeb%E7%BB%BC%E5%90%88%E5%BA%94%E7%94%A8%EF%BC%9A%E5%95%86%E5%93%81%E7%AE%A1%E7%90%86/"/>
    <id>http://zsx-cup.top/2018/12/01/JavaWeb综合应用：商品管理/</id>
    <published>2018-12-01T06:49:13.000Z</published>
    <updated>2018-12-02T16:15:25.674Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/2018/12/01/JavaWeb综合应用：商品管理/JavaWeb.jpg" alt="JavaWeb"></p><p>基于一个商品信息展示页面，实现以下商品管理功能：</p><ol><li>查询所有商品；</li><li>根据商品名称模糊查询；</li><li>添加商品；</li><li>删除单个或多个商品；</li><li>修改商品；</li></ol><h2 id="核心代码"><a href="#核心代码" class="headerlink" title="核心代码"></a>核心代码</h2><h3 id="主页面"><a href="#主页面" class="headerlink" title="主页面"></a>主页面</h3><h4 id="index-html"><a href="#index-html" class="headerlink" title="index.html"></a>index.html</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-home"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"nav-label"</span>&gt;</span>商品管理<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"fa arrow"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"nav nav-second-level"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"J_menuItem"</span> <span class="attr">href</span>=<span class="string">"products.jsp"</span> <span class="attr">data-index</span>=<span class="string">"0"</span>&gt;</span>查询商品<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"J_menuItem"</span> <span class="attr">href</span>=<span class="string">"add.jsp"</span>&gt;</span>添加商品<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"J_menuItem"</span> <span class="attr">href</span>=<span class="string">"edit.jsp"</span>&gt;</span>修改商品<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="products-jsp"><a href="#products-jsp" class="headerlink" title="products.jsp"></a>products.jsp</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--商品模糊查询--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/webday12/searchProductByName"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"请输入商品名"</span> <span class="attr">name</span>=<span class="string">"name"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">"form-control"</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-btn"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>搜索<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--商品模糊查询--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-bordered"</span> <span class="attr">id</span>=<span class="string">"prodctId"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>商品名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>商品价格<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>商品类目<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>商品数量<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>商品描述<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/webday12/DeleteMore"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">c:forEach</span> <span class="attr">var</span>=<span class="string">"list"</span> <span class="attr">items</span>=<span class="string">"$&#123;productList &#125;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"$&#123;list.id &#125;"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;list.name &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;list.price &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;list.category &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;list.pnum &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;list.description &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"Delete?id=$&#123;list.id &#125;"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span>|<span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">href</span>=<span class="string">"ShowEdit?id=$&#123;list.id &#125;"</span>&gt;</span>修改<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">c:forEach</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>删除多个<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    &amp;nbsp;</span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/webday12/Search"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>显示所有商品<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="add-jsp"><a href="#add-jsp" class="headerlink" title="add.jsp"></a>add.jsp</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal m-t"</span> <span class="attr">action</span>=<span class="string">"/webday12/AddProduct"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">id</span>=<span class="string">"signupForm"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-3 control-label"</span>&gt;</span>商品名称：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"name"</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-3 control-label"</span>&gt;</span>商品价格：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"price"</span> <span class="attr">name</span>=<span class="string">"price"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-3 control-label"</span>&gt;</span>类目：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"category"</span> <span class="attr">name</span>=<span class="string">"category"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-3 control-label"</span>&gt;</span>数量：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"pnum"</span> <span class="attr">name</span>=<span class="string">"pnum"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-3 control-label"</span>&gt;</span>描述：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"description"</span> <span class="attr">name</span>=<span class="string">"description"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-8 col-sm-offset-3"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-success"</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-save"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> &amp;nbsp;&amp;nbsp;添加&amp;nbsp;&amp;nbsp; <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="edit-jsp"><a href="#edit-jsp" class="headerlink" title="edit.jsp"></a>edit.jsp</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal m-t"</span> <span class="attr">id</span>=<span class="string">"signupForm"</span>   <span class="attr">action</span>=<span class="string">"/webday12/DoEdit"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"$&#123;product.id &#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-3 control-label"</span>&gt;</span>商品名称：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"name"</span> <span class="attr">name</span>=<span class="string">"name"</span>   <span class="attr">value</span>=<span class="string">"$&#123;product.name &#125;"</span>  <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-3 control-label"</span>&gt;</span>商品价格：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"price"</span> <span class="attr">name</span>=<span class="string">"price"</span> <span class="attr">value</span>=<span class="string">"$&#123;product.price &#125;"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-3 control-label"</span>&gt;</span>类目：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"cate"</span> <span class="attr">name</span>=<span class="string">"category"</span> <span class="attr">value</span>=<span class="string">"$&#123;product.category &#125;"</span>  <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-3 control-label"</span>&gt;</span>数量：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"num"</span> <span class="attr">name</span>=<span class="string">"pnum"</span>  <span class="attr">value</span>=<span class="string">"$&#123;product.pnum &#125;"</span><span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-3 control-label"</span>&gt;</span>描述：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"desc"</span> <span class="attr">name</span>=<span class="string">"description"</span>  <span class="attr">value</span>=<span class="string">"$&#123;product.description &#125;"</span><span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-8 col-sm-offset-3"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-success"</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-save"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> &amp;nbsp;&amp;nbsp;提交修改&amp;nbsp;&amp;nbsp; <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h3><h4 id="Search-java"><a href="#Search-java" class="headerlink" title="Search.java"></a>Search.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ProductService ps = <span class="keyword">new</span> ProductServiceImpl();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">//接收页面参数</span></span><br><span class="line">    String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">    <span class="comment">//查询所有商品</span></span><br><span class="line">    List&lt;Product&gt; productList = ps.searchProduct();</span><br><span class="line">    <span class="comment">//将查询结果保存到request域中</span></span><br><span class="line">    request.setAttribute(<span class="string">"productList"</span>, productList);</span><br><span class="line">    <span class="comment">//转发</span></span><br><span class="line">    request.getRequestDispatcher(<span class="string">"products.jsp"</span>).forward(request, response);</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="searchProductByName-java"><a href="#searchProductByName-java" class="headerlink" title="searchProductByName.java"></a>searchProductByName.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ProductService ps = <span class="keyword">new</span> ProductServiceImpl();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">//接收页面参数</span></span><br><span class="line">    String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">    <span class="comment">//查询所有商品</span></span><br><span class="line">    List&lt;Product&gt; productList = ps.searchProductByName(name);</span><br><span class="line">    <span class="comment">//将查询结果保存到request域中</span></span><br><span class="line">    request.setAttribute(<span class="string">"productList"</span>, productList);</span><br><span class="line">    <span class="comment">//转发</span></span><br><span class="line">    request.getRequestDispatcher(<span class="string">"products.jsp"</span>).forward(request, response);</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="AddProduct-java"><a href="#AddProduct-java" class="headerlink" title="AddProduct.java"></a>AddProduct.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Product product = <span class="keyword">new</span> Product();</span><br><span class="line">ProductService ps = <span class="keyword">new</span> ProductServiceImpl();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 接收页面参数</span></span><br><span class="line">    Map&lt;String, String[]&gt; map = request.getParameterMap();</span><br><span class="line">    BeanUtils.populate(product, map);</span><br><span class="line">    <span class="comment">// 调用service</span></span><br><span class="line">    <span class="keyword">int</span> i = ps.addProduct(product);</span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">1</span>) &#123;<span class="comment">// 添加成功，重定向至查询界面</span></span><br><span class="line">        response.sendRedirect(<span class="string">"/webday12/Search"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;<span class="comment">// 转发至商品添加页面</span></span><br><span class="line">        request.setAttribute(<span class="string">"product"</span>, product);</span><br><span class="line">        request.getRequestDispatcher(<span class="string">"add.jsp"</span>).forward(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Delete-java"><a href="#Delete-java" class="headerlink" title="Delete.java"></a>Delete.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ProductService ps = <span class="keyword">new</span> ProductServiceImpl();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    String param = request.getParameter(<span class="string">"id"</span>);</span><br><span class="line">    <span class="keyword">int</span> i = ps.deleteProduct(param);</span><br><span class="line">    <span class="keyword">if</span>(i==<span class="number">1</span>)&#123;<span class="comment">//删除成功则重定向至商品查询展示页面</span></span><br><span class="line">        response.sendRedirect(<span class="string">"/webday12/Search"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="DeleteMore-java"><a href="#DeleteMore-java" class="headerlink" title="DeleteMore.java"></a>DeleteMore.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">ProductService ps = <span class="keyword">new</span> ProductServiceImpl();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 接收页面参数</span></span><br><span class="line">    String[] ids = request.getParameterValues(<span class="string">"id"</span>);</span><br><span class="line">    <span class="comment">// 调用service删除数</span></span><br><span class="line">    <span class="keyword">int</span> i = ps.deleteMoreProduct(ids);</span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">1</span>) &#123;<span class="comment">// 删除状态提示</span></span><br><span class="line">        response.getWriter().write(<span class="string">"删除成功，页面跳转中。。。"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        response.getWriter().write(<span class="string">"删除失败，，页面跳转中。。。"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 页面重定向至查询所有商品页面</span></span><br><span class="line">    response.sendRedirect(<span class="string">"/webday12/Search"</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ShowEdit-java"><a href="#ShowEdit-java" class="headerlink" title="ShowEdit.java"></a>ShowEdit.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ProductService ps = <span class="keyword">new</span> ProductServiceImpl();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 接收页面参数</span></span><br><span class="line">    String id = request.getParameter(<span class="string">"id"</span>);</span><br><span class="line">    <span class="comment">// 调用service先根据id查询需要修改的商品</span></span><br><span class="line">    Product product = ps.getProductById(id);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> != product) &#123;<span class="comment">// 查到商品，则保存到域中，并转发至修改商品信息页面</span></span><br><span class="line">        request.setAttribute(<span class="string">"product"</span>, product);</span><br><span class="line">        request.getRequestDispatcher(<span class="string">"edit.jsp"</span>).forward(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="DoEdit-java"><a href="#DoEdit-java" class="headerlink" title="DoEdit.java"></a>DoEdit.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Product product = <span class="keyword">new</span> Product();</span><br><span class="line">ProductService ps = <span class="keyword">new</span> ProductServiceImpl();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 接收页面参数</span></span><br><span class="line">    Map&lt;String, String[]&gt; map = request.getParameterMap();</span><br><span class="line">    BeanUtils.populate(product, map);</span><br><span class="line">    <span class="comment">//调用service，修改商品信息</span></span><br><span class="line">    <span class="keyword">int</span> i = ps.editProduct(product);</span><br><span class="line">    <span class="keyword">if</span>(i==<span class="number">1</span>)&#123;<span class="comment">//如果修改成功，重定向至查询商品页面</span></span><br><span class="line">        response.sendRedirect(<span class="string">"/webday12/Search"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;<span class="comment">//如果修改失败，将重定向至查询商品页面</span></span><br><span class="line">        request.setAttribute(<span class="string">"product"</span>, product);</span><br><span class="line">        request.getRequestDispatcher(<span class="string">"edit.jsp"</span>).forward(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h3><h4 id="ProductService-java"><a href="#ProductService-java" class="headerlink" title="ProductService.java"></a>ProductService.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ProductService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//删除单个商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">deleteProduct</span><span class="params">(String id)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">    <span class="comment">//删除多个商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">deleteMoreProduct</span><span class="params">(String[] ids)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">    <span class="comment">//查询单个商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProductById</span><span class="params">(String id)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">    <span class="comment">//修改商品信息</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">editProduct</span><span class="params">(Product product)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">    <span class="comment">//添加商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addProduct</span><span class="params">(Product product)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">    <span class="comment">//查询所有商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">searchProduct</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">    <span class="comment">//根据商品名称模糊查询</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">searchProductByName</span><span class="params">(String name)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ProductServiceImpl-java"><a href="#ProductServiceImpl-java" class="headerlink" title="ProductServiceImpl.java"></a>ProductServiceImpl.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductServiceImpl</span> <span class="keyword">implements</span> <span class="title">ProductService</span> </span>&#123;</span><br><span class="line">    ProductDao pd = <span class="keyword">new</span> ProductDaoImpl();</span><br><span class="line">    <span class="comment">//删除单个商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">deleteProduct</span><span class="params">(String id)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pd.deleteProduct(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//查询单个商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProductById</span><span class="params">(String id)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pd.getProductById(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//修改商品信息</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">editProduct</span><span class="params">(Product product)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pd.editProduct(product);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//删除多个商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">deleteMoreProduct</span><span class="params">(String[] ids)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pd.deleteMoreProduct(ids);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//添加商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addProduct</span><span class="params">(Product product)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pd.addProduct(product);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//查询所有商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">searchProduct</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pd.searchProduct();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//根据商品名称模糊查询</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">searchProductByName</span><span class="params">(String name)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pd.searchProductByName(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Dao"><a href="#Dao" class="headerlink" title="Dao"></a>Dao</h3><h4 id="ProductDao-java"><a href="#ProductDao-java" class="headerlink" title="ProductDao.java"></a>ProductDao.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ProductDao</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 查询所有商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">searchProduct</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">    <span class="comment">// 根据商品名称模糊查询</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">searchProductByName</span><span class="params">(String name)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">    <span class="comment">//根据id查询商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProductById</span><span class="params">(String id)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">    <span class="comment">// 根据id删除单个商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">deleteProduct</span><span class="params">(String id)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">    <span class="comment">// 根据id删除多个商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">deleteMoreProduct</span><span class="params">(String[] ids)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">    <span class="comment">// 修改商品信息</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">editProduct</span><span class="params">(Product product)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">    <span class="comment">//添加商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addProduct</span><span class="params">(Product product)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ProductDaoImpl-java"><a href="#ProductDaoImpl-java" class="headerlink" title="ProductDaoImpl.java"></a>ProductDaoImpl.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductDaoImpl</span> <span class="keyword">implements</span> <span class="title">ProductDao</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 根据id删除单个商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">deleteProduct</span><span class="params">(String id)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        String sql = <span class="string">"delete from product where id=?"</span>;</span><br><span class="line">        <span class="keyword">int</span> i = runner.update(sql, id);</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//根据id查询商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProductById</span><span class="params">(String id)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        String sql = <span class="string">"select * from product where id=?"</span>;</span><br><span class="line">        Product product = runner.query(sql, <span class="keyword">new</span> BeanHandler&lt;Product&gt;(Product.class), id);</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 修改商品信息</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">editProduct</span><span class="params">(Product product)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        String sql = <span class="string">"update product set name=?,price=?,pnum=?,category=?,description=? where id=?"</span>;</span><br><span class="line">        <span class="keyword">int</span> i = runner.update(sql, product.getName(), product.getPrice(), product.getPnum(), product.getCategory(),</span><br><span class="line">                product.getDescription(), product.getId());</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 根据id删除多个商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">deleteMoreProduct</span><span class="params">(String[] ids)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        String sql = <span class="string">"delete from product where id=?"</span>;</span><br><span class="line">        <span class="keyword">for</span> (String id : ids) &#123;</span><br><span class="line">            <span class="keyword">int</span> i = runner.update(sql, id);</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//添加商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addProduct</span><span class="params">(Product product)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        String sql = <span class="string">"insert into product values(null,?,?,?,?,?)"</span>;</span><br><span class="line">        <span class="keyword">int</span> i = runner.update(sql, product.getName(), product.getPrice(), product.getCategory(), product.getPnum(),</span><br><span class="line">                product.getDescription());</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 查询所有商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">searchProduct</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        String sql = <span class="string">"select * from product"</span>;</span><br><span class="line">        List&lt;Product&gt; productList = runner.query(sql, <span class="keyword">new</span> BeanListHandler&lt;Product&gt;(Product.class));</span><br><span class="line">        <span class="keyword">return</span> productList;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 根据商品名称模糊查询</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">searchProductByName</span><span class="params">(String name)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        String sql = <span class="string">"select * from product where name like ?"</span>;</span><br><span class="line">        String nname = <span class="string">"%"</span> + name + <span class="string">"%"</span>;</span><br><span class="line">        List&lt;Product&gt; productList = runner.query(sql, <span class="keyword">new</span> BeanListHandler&lt;Product&gt;(Product.class), nname);</span><br><span class="line">        <span class="keyword">return</span> productList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Product对象"><a href="#Product对象" class="headerlink" title="Product对象"></a>Product对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String description;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> price;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> pnum;</span><br><span class="line">    <span class="keyword">private</span> String category;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> description;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setDescription</span><span class="params">(String description)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.description = description;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">double</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">getPnum</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pnum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setPnum</span><span class="params">(<span class="keyword">int</span> pnum)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.pnum = pnum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> category;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setCategory</span><span class="params">(String category)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.category = category;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Product [id="</span> + id + <span class="string">", name="</span> + name + <span class="string">", description="</span> + description + <span class="string">", price="</span> + price + <span class="string">", pnum="</span></span><br><span class="line">                + pnum + <span class="string">", category="</span> + category + <span class="string">"]"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/2018/12/01/JavaWeb综合应用：商品管理/JavaWeb.jpg&quot; alt=&quot;JavaWeb&quot;&gt;&lt;/p&gt;
&lt;p&gt;基于一个商品信息展示页面，实现以下商品管理功能：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;查询所有商品；&lt;/li&gt;
&lt;li&gt;根据商品名称模糊
      
    
    </summary>
    
      <category term="JavaWeb" scheme="http://zsx-cup.top/categories/JavaWeb/"/>
    
    
      <category term="Application" scheme="http://zsx-cup.top/tags/Application/"/>
    
  </entry>
  
  <entry>
    <title>动态代理</title>
    <link href="http://zsx-cup.top/2018/11/30/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/"/>
    <id>http://zsx-cup.top/2018/11/30/动态代理/</id>
    <published>2018-11-29T16:39:56.000Z</published>
    <updated>2018-11-30T16:57:40.715Z</updated>
    
    <content type="html"><![CDATA[<h2 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h2><p>动态代理的目的只有一个，即对类的方法进行增强。</p><h3 id="装饰模式"><a href="#装饰模式" class="headerlink" title="装饰模式"></a>装饰模式</h3><blockquote><p>是你，还有你，一切拜托你。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Inter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//需要增强的类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Monkey</span> <span class="keyword">implements</span> <span class="title">Inter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"play"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//增强后的类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EnMonkey</span> <span class="keyword">implements</span> <span class="title">Inter</span> </span>&#123;</span><br><span class="line">    Monkey monkey;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EnMonkey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EnMonkey</span><span class="params">(Monkey monkey)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.monkey = monkey;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"eat"</span>);</span><br><span class="line">        monkey.play();</span><br><span class="line">        System.out.println(<span class="string">"sleep"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//测试类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//有你(Monkey)，还有你(EnMonkey)，一切拜托你(monkey)</span></span><br><span class="line">        EnMonkey monkey = <span class="keyword">new</span> EnMonkey(<span class="keyword">new</span> Monkey());</span><br><span class="line">        monkey.play();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="动态代理模式"><a href="#动态代理模式" class="headerlink" title="动态代理模式"></a>动态代理模式</h3><p>动态代理，即对一个类进行动态的增强。</p><ol><li>被代理的类必须实现接口；</li><li>创建一个实现InvocationHandler接口的实现类；</li><li>重写方法。使用Method对象调用invoke(代理对象的实例)方法，要增强的功能 在invoke方法 的前后；</li><li>创建代理对象，Proxy.newProxyInstance()，并传入三个参数：<ul><li>类加载器</li><li>代理类的接口</li><li>实现InvocationHandler接口的实现类</li></ul></li></ol><h4 id="动态代理代码示例"><a href="#动态代理代码示例" class="headerlink" title="动态代理代码示例"></a>动态代理代码示例</h4><p>【被代理的对象，即想要增强的类】<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//类实现的接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updata</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//被代理的对象</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"调用jdbc操作数据库  add"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updata</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"调用jdbc操作数据库  update"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>【代理对象，即增强后的类】<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DynamicProxy</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//被代理对象，即目标对象</span></span><br><span class="line">        UserDaoImpl userDaoImpl = <span class="keyword">new</span> UserDaoImpl();</span><br><span class="line">        <span class="comment">// 生成动态代理</span></span><br><span class="line">        UserDao userDao = (UserDao)Proxy.newProxyInstance(DynamicProxy.class.getClassLoader(), UserDaoImpl.class.getInterfaces(), <span class="keyword">new</span> InvocationHandler() &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                System.out.println(<span class="string">"开启事务"</span>);</span><br><span class="line">                Object obj = method.invoke(userDaoImpl, args);</span><br><span class="line">                System.out.println(<span class="string">"关闭事务"</span>);</span><br><span class="line">                <span class="keyword">return</span> obj;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//调用方法，测试</span></span><br><span class="line">        userDao.add();</span><br><span class="line">        System.out.println(<span class="string">"-----------"</span>);</span><br><span class="line">        userDao.updata();</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="动态代理代码改造"><a href="#动态代理代码改造" class="headerlink" title="动态代理代码改造"></a>动态代理代码改造</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyFactory</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line">    Transfer trans = <span class="keyword">new</span> Transfer();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//被增强的类</span></span><br><span class="line">    Object obj;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ProxyFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ProxyFactory</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.obj = obj;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 用于增强方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        <span class="comment">//prefix();</span></span><br><span class="line">        trans.open();</span><br><span class="line">        Object object = method.invoke(obj, args);</span><br><span class="line">        <span class="comment">//suffix();</span></span><br><span class="line">        trans.close();</span><br><span class="line">        <span class="keyword">return</span> object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生成代理对象</span></span><br><span class="line"><span class="comment">     * 参数:</span></span><br><span class="line"><span class="comment">     * 1.类加载器</span></span><br><span class="line"><span class="comment">     * 2.被代理对象实现的接口，必须实现接口</span></span><br><span class="line"><span class="comment">     * 3.实现InvocationHandler接口的实现类，当前类已实现</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 代理对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getProxy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance(ProxyFactory.class.getClassLoader(), obj.getClass().getInterfaces(), <span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prefix</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"方法执行前。。。"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">suffix</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"方法执行后。。。"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//用于方法增强的类Transfer</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Transfer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"开启事务"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"关闭事务"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//测试类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 被代理对象，目标对象</span></span><br><span class="line">        ProxyFactory proxyFactory = <span class="keyword">new</span> ProxyFactory(<span class="keyword">new</span> UserDaoImpl());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 生成代理对象</span></span><br><span class="line">        UserDao userDao = (UserDao) proxyFactory.getProxy();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 调用方法</span></span><br><span class="line">        userDao.add();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;动态代理&quot;&gt;&lt;a href=&quot;#动态代理&quot; class=&quot;headerlink&quot; title=&quot;动态代理&quot;&gt;&lt;/a&gt;动态代理&lt;/h2&gt;&lt;p&gt;动态代理的目的只有一个，即对类的方法进行增强。&lt;/p&gt;
&lt;h3 id=&quot;装饰模式&quot;&gt;&lt;a href=&quot;#装饰模式&quot; clas
      
    
    </summary>
    
      <category term="JavaWeb" scheme="http://zsx-cup.top/categories/JavaWeb/"/>
    
    
      <category term="动态代理" scheme="http://zsx-cup.top/tags/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>AJAX快速入门</title>
    <link href="http://zsx-cup.top/2018/11/29/AJAX%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"/>
    <id>http://zsx-cup.top/2018/11/29/AJAX快速入门/</id>
    <published>2018-11-29T11:39:41.000Z</published>
    <updated>2018-11-30T16:40:36.734Z</updated>
    
    <content type="html"><![CDATA[<h2 id="AJAX快速入门"><a href="#AJAX快速入门" class="headerlink" title="AJAX快速入门"></a>AJAX快速入门</h2><blockquote><p>Ajax 即“Asynchronous Javascript And XML”（异步 JavaScript 和 XML），是指一种创建交互式网页应用的网页开发技术。<br>Ajax 用于创建快速动态网页，通过在后台与服务器进行少量数据交换，Ajax 可以使网页实现异步更新，即在无需重新加载整个网页的情况下，能够更新部分网页。</p></blockquote><h3 id="同步与异步"><a href="#同步与异步" class="headerlink" title="同步与异步"></a>同步与异步</h3><ul><li>同步现象：客户端发送请求到服务器端，当服务器返回响应之前，客户端都处于等待，即卡死状态；</li><li>异步现象：客户端发送请求到服务器端，无论服务器是否返回响应，客户端都可以随意做其他事情，不会被卡死。</li></ul><h3 id="Ajax原理"><a href="#Ajax原理" class="headerlink" title="Ajax原理"></a>Ajax原理</h3><p>页面发起请求，会将请求发送给浏览器内核中的Ajax引擎，Ajax引擎会提交请求到    服务器端，在这段时间里，客户端可以任意进行任意操作，直到服务器端将数据返回   给Ajax引擎后，会触发你设置的事件，从而执行自定义的js逻辑代码完成某种页面功能。</p><p>jQuery对js原生的ajax进行了封装，封装后的ajax的操作方法更简洁，功能更强大。</p><h3 id="get-url-data-callback-type"><a href="#get-url-data-callback-type" class="headerlink" title="$.get(url, [data], [callback], [type])"></a>$.get(url, [data], [callback], [type])</h3><p>$.get()和$.post()所需的4个参数均为：</p><ol><li>URL，请求的地址</li><li>携带的数据，json格式</li><li>请求成功时的回调函数，参数是请求成功返回的数据</li><li>接收数据的解析方式，如text、json、html</li></ol><p>需要注意的是，ajax不接收畸形json字符串：</p><ol><li>畸形json字符串：”{‘name’:’畸形json字符串’}”</li><li>标准的json字符串：<ul><li>“{\”name\”:\”标准的json字符串\”}”，\为转义符号）</li><li>‘{“name”:”标准的json字符串”}’， java不允许单引号</li></ul></li></ol><p>html页面代码：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">        Name:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"acc"</span> <span class="attr">name</span>=<span class="string">"account"</span> <span class="attr">onblur</span>=<span class="string">"checkName()"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/jquery-1.8.3.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">    function checkName() &#123;</span></span><br><span class="line"><span class="undefined">        $.get(</span></span><br><span class="line"><span class="undefined">        //1.url</span></span><br><span class="line"><span class="undefined">        "http://localhost:8080/webday11/Register",</span></span><br><span class="line"><span class="undefined">        //2. 请求携带的参数 ，json格式</span></span><br><span class="line"><span class="undefined">        &#123;</span></span><br><span class="line"><span class="undefined">            "name" : $("#acc").val()</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        //3.请求成功时的回调函数，参数是请求成功返回的数据</span></span><br><span class="line"><span class="undefined">        function(data) &#123;</span></span><br><span class="line"><span class="undefined">            //var json = eval('(' + data + ')') //当格式是"text"时使用</span></span><br><span class="line"><span class="undefined">            alert(data.name);</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        //4. 告诉浏览器处理数据的格式：text、json、html</span></span><br><span class="line"><span class="undefined">        //"text"</span></span><br><span class="line"><span class="undefined">        "json")</span></span><br><span class="line"><span class="undefined">    &#125;;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>servlet代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//接收页面参数</span></span><br><span class="line">String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">System.out.println(name);</span><br><span class="line"><span class="comment">//创建User对象</span></span><br><span class="line">User user = <span class="keyword">new</span> User(name,<span class="string">"123"</span>);</span><br><span class="line"><span class="comment">//将User对象转换为json字符串</span></span><br><span class="line">String str = JSON.toJSONString(user);</span><br><span class="line"><span class="comment">//向页面响应json字符串</span></span><br><span class="line">response.getWriter().println(<span class="string">"&#123;\"name\":\"标准的json字符串\"&#125;"</span>);</span><br></pre></td></tr></table></figure></p><h3 id="post-url-data-callback-type"><a href="#post-url-data-callback-type" class="headerlink" title="$.post(url, [data], [callback], [type])"></a>$.post(url, [data], [callback], [type])</h3><p>代码示例：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">        Name:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"acc"</span> <span class="attr">name</span>=<span class="string">"account"</span> <span class="attr">onblur</span>=<span class="string">"checkName()"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/jquery-1.8.3.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">    function checkName() &#123;</span></span><br><span class="line"><span class="undefined">        $.post(</span></span><br><span class="line"><span class="undefined">        //1.url</span></span><br><span class="line"><span class="undefined">        "http://localhost:8080/webday11/Register",</span></span><br><span class="line"><span class="undefined">        //2. 请求携带的参数 ，json格式</span></span><br><span class="line"><span class="undefined">        &#123;</span></span><br><span class="line"><span class="undefined">            "name" : $("#acc").val()</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        //3.请求成功时的回调函数，参数是请求成功返回的数据</span></span><br><span class="line"><span class="undefined">        function(data) &#123;</span></span><br><span class="line"><span class="undefined">            //var json = eval('(' + data + ')') //当格式是"text"时使用</span></span><br><span class="line"><span class="undefined">            alert(data.name);</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        //4. 告诉浏览器处理数据的格式：text、json、html</span></span><br><span class="line"><span class="undefined">        //"text"</span></span><br><span class="line"><span class="undefined">        "json")</span></span><br><span class="line"><span class="undefined">    &#125;;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="ajax-url-val1-data-val2-type-val3…"><a href="#ajax-url-val1-data-val2-type-val3…" class="headerlink" title="$.ajax({url:val1,data:val2,type:val3…})"></a>$.ajax({url:val1,data:val2,type:val3…})</h3><p>$.ajax()常用的参数为：</p><ol><li>url：请求的地址</li><li>data：请求携带的数据，json</li><li>type：请求类型，”get”、”post”</li><li>success：请求成功时的回调函数，参数是请求成功返回的数据</li><li>error：请求失败时的回调函数，参数是请求失败返回的数据</li><li>dataType：返回数据的解析方式</li></ol><p>代码示例：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/jquery-1.8.3.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">    function checkName() &#123;    </span></span><br><span class="line"><span class="undefined">        $.ajax(&#123;</span></span><br><span class="line"><span class="undefined">        url:"http://localhost:8080/webday11/Register",</span></span><br><span class="line"><span class="undefined">        data:&#123;"name": $("#acc").val()&#125;,</span></span><br><span class="line"><span class="undefined">        type:"post",</span></span><br><span class="line"><span class="undefined">        success:function(data)&#123;</span></span><br><span class="line"><span class="undefined">            alert(data.name);</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        error:function(data)&#123;</span></span><br><span class="line"><span class="undefined">            alert("error");</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        dataType:"json"</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined">    &#125;;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="ajax应用：判断用户名是否存在"><a href="#ajax应用：判断用户名是否存在" class="headerlink" title="ajax应用：判断用户名是否存在"></a>ajax应用：判断用户名是否存在</h3><p>步骤分析：</p><ol><li>HTML页面：发送ajax，携带数据</li><li>servlet：接收页面参数，调用service</li><li>service：调用dao</li><li>dao：操作数据库</li></ol><p>代码示例：</p><ol><li><p>html页面：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">        Name:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"acc"</span> <span class="attr">name</span>=<span class="string">"account"</span> <span class="attr">onblur</span>=<span class="string">"checkName()"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"span"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/jquery-1.8.3.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">    function checkName() &#123;</span></span><br><span class="line"><span class="undefined">        $.ajax(&#123;</span></span><br><span class="line"><span class="undefined">        url:"http://localhost:8080/webday11/Register",</span></span><br><span class="line"><span class="undefined">        data:&#123;"name": $("#acc").val()&#125;,</span></span><br><span class="line"><span class="undefined">        type:"post",</span></span><br><span class="line"><span class="undefined">        success:function(data)&#123;</span></span><br><span class="line"><span class="undefined">            //alert(data.name);</span></span><br><span class="line"><span class="undefined">            $("#span").html(data);</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        error:function(data)&#123;</span></span><br><span class="line"><span class="undefined">            alert("error");</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        //dataType:"json"</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined">    &#125;;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>servlet：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 接收页面参数</span></span><br><span class="line">    String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">    <span class="comment">// 调用service</span></span><br><span class="line">    User user = service.getUserByName(name);</span><br><span class="line">    <span class="comment">// 处理返回结果</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> == user) &#123;</span><br><span class="line">        response.getWriter().write(<span class="string">"此用户名可用"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        response.getWriter().write(<span class="string">"此用户名不可用"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>service接口及实现类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//service接口及实现类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUserByName</span><span class="params">(String name)</span> <span class="keyword">throws</span> SQLException</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//service实现类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    UserDao dao = <span class="keyword">new</span> UserDaoImpl();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUserByName</span><span class="params">(String name)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dao.getUserByName(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>dao接口及实现类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//dao接口及实现类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUserByName</span><span class="params">(String name)</span> <span class="keyword">throws</span> SQLException</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//dao实现类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUserByName</span><span class="params">(String name)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        String sql = <span class="string">"select * from user2 where name=?"</span>;</span><br><span class="line">        User user = runner.query(sql, <span class="keyword">new</span> BeanHandler&lt;User&gt;(User.class), name);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="请求后台并传递参数的三种方式"><a href="#请求后台并传递参数的三种方式" class="headerlink" title="请求后台并传递参数的三种方式"></a>请求后台并传递参数的三种方式</h3><p>请求后台并传递参数的三种方式：</p><ol><li>form表单</li><li>超链接</li><li>ajax<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- form表单 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/webday11/Param"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">        name:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 超链接 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://localhost:8080/webday11/Param?name=linda"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ajax --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">id</span>=<span class="string">"ajax"</span>&gt;</span>Ajax<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"./js/jquery-1.8.3.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">    $(function() &#123;</span></span><br><span class="line"><span class="undefined">        $("#ajax").click(function()&#123;</span></span><br><span class="line"><span class="undefined">            $.post(</span></span><br><span class="line"><span class="undefined">                    "/webday11/Param",</span></span><br><span class="line"><span class="undefined">                    &#123;"name":"mike"&#125;,</span></span><br><span class="line"><span class="undefined">            )</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;AJAX快速入门&quot;&gt;&lt;a href=&quot;#AJAX快速入门&quot; class=&quot;headerlink&quot; title=&quot;AJAX快速入门&quot;&gt;&lt;/a&gt;AJAX快速入门&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;Ajax 即“Asynchronous Javascript An
      
    
    </summary>
    
      <category term="JavaWeb" scheme="http://zsx-cup.top/categories/JavaWeb/"/>
    
    
      <category term="AJAX" scheme="http://zsx-cup.top/tags/AJAX/"/>
    
  </entry>
  
  <entry>
    <title>JSON快速入门</title>
    <link href="http://zsx-cup.top/2018/11/28/JSON%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"/>
    <id>http://zsx-cup.top/2018/11/28/JSON快速入门/</id>
    <published>2018-11-28T05:02:27.000Z</published>
    <updated>2018-11-29T11:41:36.703Z</updated>
    
    <content type="html"><![CDATA[<h2 id="JSON快速入门"><a href="#JSON快速入门" class="headerlink" title="JSON快速入门"></a>JSON快速入门</h2><blockquote><p>JSON(JavaScript Object Notation, JS 对象简谱) 是一种轻量级的数据交换格式。它基于 ECMAScript (欧洲计算机协会制定的js规范)的一个子集，采用完全独立于编程语言的文本格式来存储和表示数据。简洁和清晰的层次结构使得 JSON 成为理想的数据交换语言。 易于人阅读和编写，同时也易于机器解析和生成，并有效地提升网络传输效率。</p></blockquote><h3 id="json数据格式"><a href="#json数据格式" class="headerlink" title="json数据格式"></a>json数据格式</h3><p>json有两种格式：</p><ol><li>对象格式：{“key1”:obj,”key2”:obj,”key3”:obj…}</li><li>数组/集合格式：[obj,obj,obj…]</li></ol><p>代码示例：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">    //1. 对象格式</span></span><br><span class="line"><span class="undefined">    var j1 = &#123;"name": "linda1", "password" : "123"&#125;;</span></span><br><span class="line"><span class="undefined">    //alert(j1.name+"---"+j1.password);</span></span><br><span class="line"><span class="undefined">    </span></span><br><span class="line"><span class="undefined">    //2. list集合格式</span></span><br><span class="line"><span class="undefined">    var j2 = [ &#123;"name" : "linda1","password" : "123"&#125;, </span></span><br><span class="line"><span class="undefined">               &#123;"name" : "linda2","password" : "123"&#125;, </span></span><br><span class="line"><span class="undefined">               &#123;"name" : "linda3","password" : "123"&#125;</span></span><br><span class="line"><span class="undefined">               ]</span></span><br><span class="line"><span class="undefined">    //alert(j2[0].name);</span></span><br><span class="line"><span class="undefined">    </span></span><br><span class="line"><span class="undefined">    //3. map集合格式</span></span><br><span class="line"><span class="undefined">    var j3 = &#123; "name":"linda",</span></span><br><span class="line"><span class="undefined">                "user1": &#123;"name" : "linda1","password" : "123"&#125;, </span></span><br><span class="line"><span class="undefined">                "user2":[&#123;"name" : "mike1","password" : "123"&#125;,</span></span><br><span class="line"><span class="undefined">                        &#123;"name" : "mike2","password" : "123"&#125;]</span></span><br><span class="line"><span class="undefined">                &#125;;</span></span><br><span class="line"><span class="undefined">    //alert(j3.name);</span></span><br><span class="line"><span class="undefined">    //alert(j3.user1.name);</span></span><br><span class="line"><span class="undefined">    //alert(j3.user2[0].name);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="Json数据解析"><a href="#Json数据解析" class="headerlink" title="Json数据解析"></a>Json数据解析</h3><ol><li>json对象转换为json字符串：Eval()函数，JSON.parse(obj)；</li><li>json字符串转换为json对象：JSON.toJSONString(obj)。</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">scrip</span> <span class="attr">src</span>=<span class="string">"./js/jquery-1.8.3.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">    //jason字符串转json对象：Eval()函数js原生函数</span></span><br><span class="line"><span class="undefined">    var str = "&#123;'name':'lisa'&#125;";</span></span><br><span class="line"><span class="undefined">    var j4 = eval('(' + str + ')');</span></span><br><span class="line"><span class="undefined">    //alert(j4.name);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//jason字符串转json对象：JSON.parse(obj)</span></span><br><span class="line">String str = <span class="string">"&#123;'name':'lisa'&#125;"</span>;</span><br><span class="line">Object j5 = JSON.parse(str);</span><br><span class="line">System.out.println(j5);</span><br><span class="line"></span><br><span class="line"><span class="comment">//json对象转换为json字符串：JSON.toJSONString(obj)</span></span><br><span class="line">String str2 = JSON.toJSONString(j5);</span><br><span class="line">System.out.println(str2);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;JSON快速入门&quot;&gt;&lt;a href=&quot;#JSON快速入门&quot; class=&quot;headerlink&quot; title=&quot;JSON快速入门&quot;&gt;&lt;/a&gt;JSON快速入门&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;JSON(JavaScript Object Notation, 
      
    
    </summary>
    
    
      <category term="JSON" scheme="http://zsx-cup.top/tags/JSON/"/>
    
  </entry>
  
  <entry>
    <title>借助JSP实现注册|登录|查询</title>
    <link href="http://zsx-cup.top/2018/11/27/%E5%80%9F%E5%8A%A9JSP%E5%AE%9E%E7%8E%B0%E6%B3%A8%E5%86%8C-%E7%99%BB%E5%BD%95-%E6%9F%A5%E8%AF%A2/"/>
    <id>http://zsx-cup.top/2018/11/27/借助JSP实现注册-登录-查询/</id>
    <published>2018-11-27T15:46:39.000Z</published>
    <updated>2018-12-02T09:36:17.172Z</updated>
    
    <content type="html"><![CDATA[<p>需求：实现登录、注册、商品的查询、退出登录<br>要求：三层代码分离（web/service/dao）, mvc, jsp</p><h2 id="初步实现"><a href="#初步实现" class="headerlink" title="初步实现"></a>初步实现</h2><h3 id="实现注册功能"><a href="#实现注册功能" class="headerlink" title="实现注册功能"></a>实现注册功能</h3><p>servlet代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">UserService service = <span class="keyword">new</span> UserService();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 接收页面参数</span></span><br><span class="line">    String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">    String password = request.getParameter(<span class="string">"password"</span>);</span><br><span class="line">    User user = <span class="keyword">new</span> User(name, password);</span><br><span class="line">    <span class="comment">// 注册返回结果</span></span><br><span class="line">    <span class="keyword">int</span> register = service.register(user);</span><br><span class="line">    <span class="comment">// 将返回结果存放至request域中</span></span><br><span class="line">    request.setAttribute(<span class="string">"register"</span>, register);</span><br><span class="line">    <span class="keyword">if</span> (register == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">// 转发</span></span><br><span class="line">        request.getRequestDispatcher(<span class="string">"login.jsp"</span>).forward(request, response);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        response.getWriter().println(<span class="string">"服务器开小车喽，请客官稍后重试。。。"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>jsp代码：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">"/webday10/RegisterServlet"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">    &lt;table&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;Name:&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;input type="text" name="name"&gt;&lt;/td&gt;&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;Password:&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;input type="password" name="password"&gt;&lt;/td&gt;&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">    &lt;button type="submit"&gt;Submit&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure></p><h3 id="实现登录功能"><a href="#实现登录功能" class="headerlink" title="实现登录功能"></a>实现登录功能</h3><p>servlet代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">UserService service = <span class="keyword">new</span> UserService();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">//接收页面参数</span></span><br><span class="line">    String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">    String password = request.getParameter(<span class="string">"password"</span>);</span><br><span class="line">    User user = <span class="keyword">new</span> User(name, password);</span><br><span class="line">    <span class="comment">//登录返回结果</span></span><br><span class="line">    User login = service.login(user);</span><br><span class="line">    <span class="comment">// 将返回结果存放至request域中</span></span><br><span class="line">    request.setAttribute(<span class="string">"login"</span>, login);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">null</span>==login)&#123;</span><br><span class="line">        <span class="comment">//转发至注册页面</span></span><br><span class="line">        request.getRequestDispatcher(<span class="string">"register.jsp"</span>).forward(request, response);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//转发至查询页面</span></span><br><span class="line">        request.getRequestDispatcher(<span class="string">"search.jsp"</span>).forward(request, response);</span><br><span class="line">    &#125;   </span><br><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>jsp代码：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">"/webday10/LoginServlet"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">    &lt;table&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;Name:&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;input type="text" name="name"&gt;&lt;/td&gt;&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;Password:&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;input type="password" name="password"&gt;&lt;/td&gt;&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">    &lt;button type="submit"&gt;Submit&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure></p><h3 id="实现登录功能-1"><a href="#实现登录功能-1" class="headerlink" title="实现登录功能"></a>实现登录功能</h3><p>servlet代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">UserService service = <span class="keyword">new</span> UserService();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 接收页面参数</span></span><br><span class="line">    String keyword = request.getParameter(<span class="string">"keyword"</span>);</span><br><span class="line">    <span class="comment">// 商品查询数据</span></span><br><span class="line">    List&lt;Product&gt; plist;</span><br><span class="line">    plist = service.searchProduct(keyword);</span><br><span class="line">    <span class="comment">// 将返回结果存放至request域中</span></span><br><span class="line">    request.setAttribute(<span class="string">"plist"</span>, plist);</span><br><span class="line">    <span class="comment">// 转发</span></span><br><span class="line">    request.getRequestDispatcher(<span class="string">"search.jsp"</span>).forward(request, response);</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>jsp代码：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;table border=<span class="string">"1px"</span> cellspacing=<span class="string">"0"</span> width=<span class="string">"500px"</span> align=<span class="string">"center"</span>&gt;</span><br><span class="line">    &lt;caption&gt;Product List&lt;/caption&gt;</span><br><span class="line">    &lt;tr align=<span class="string">"center"</span>&gt;</span><br><span class="line">        &lt;th&gt;Name&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;Description&lt;/th&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;c:forEach items=<span class="string">"$&#123;plist &#125;"</span> <span class="keyword">var</span>=<span class="string">"product"</span>&gt;</span><br><span class="line">        &lt;tr align=<span class="string">"center"</span>&gt;</span><br><span class="line">            &lt;td&gt;$&#123;product.name &#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;product.description &#125;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/c:forEach&gt;</span><br><span class="line">&lt;/table&gt;</span><br></pre></td></tr></table></figure></p><h3 id="Service和Dao代码"><a href="#Service和Dao代码" class="headerlink" title="Service和Dao代码"></a>Service和Dao代码</h3><p>Service代码<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    UserDao dao = <span class="keyword">new</span> UserDao();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user 新用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 注册状态，成功返回1，失败返回0</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">register</span><span class="params">(User user)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dao.register(user);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 登录</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user 登录用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 登录状态，返回登录用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">login</span><span class="params">(User user)</span> <span class="keyword">throws</span> SQLException</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dao.login(user);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 商品信息查询</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> keyword 关键词</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 商品信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">searchProduct</span><span class="params">(String keyword)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dao.searchProduct(keyword);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>Dao代码<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user 新用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 注册状态，成功返回1，失败返回0</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">register</span><span class="params">(User user)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        String sql = <span class="string">"insert into user2 values(null,? ,?)"</span>;</span><br><span class="line">        <span class="keyword">int</span> i = runner.update(sql,user.getName(),user.getPassword());</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;   </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 登录</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user 登录用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 登录状态，返回登录用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">login</span><span class="params">(User user)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        String sql = <span class="string">"select * from user2 where name=? and password=?"</span>;</span><br><span class="line">        User user2 = runner.query(sql, <span class="keyword">new</span> BeanHandler&lt;User&gt;(User.class), user.getName(), user.getPassword());</span><br><span class="line">        <span class="keyword">return</span> user2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 商品信息查询</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> keyword 关键词</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 商品信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">searchProduct</span><span class="params">(String keyword)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        String sql = <span class="string">"select * from product where name like ?"</span>;</span><br><span class="line">        String keyword2 = <span class="string">"%"</span> + keyword + <span class="string">"%"</span>;</span><br><span class="line">        List&lt;Product&gt; plist = runner.query(sql, <span class="keyword">new</span> BeanListHandler&lt;Product&gt;(Product.class), keyword2);</span><br><span class="line">        <span class="keyword">return</span> plist;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;需求：实现登录、注册、商品的查询、退出登录&lt;br&gt;要求：三层代码分离（web/service/dao）, mvc, jsp&lt;/p&gt;
&lt;h2 id=&quot;初步实现&quot;&gt;&lt;a href=&quot;#初步实现&quot; class=&quot;headerlink&quot; title=&quot;初步实现&quot;&gt;&lt;/a&gt;初步实现&lt;
      
    
    </summary>
    
      <category term="JavaWeb" scheme="http://zsx-cup.top/categories/JavaWeb/"/>
    
    
      <category term="JSP" scheme="http://zsx-cup.top/tags/JSP/"/>
    
      <category term="Application" scheme="http://zsx-cup.top/tags/Application/"/>
    
      <category term="Servlet" scheme="http://zsx-cup.top/tags/Servlet/"/>
    
  </entry>
  
  <entry>
    <title>JSP快速入门</title>
    <link href="http://zsx-cup.top/2018/11/26/JSP%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"/>
    <id>http://zsx-cup.top/2018/11/26/JSP快速入门/</id>
    <published>2018-11-26T11:02:46.000Z</published>
    <updated>2018-11-28T04:47:45.203Z</updated>
    
    <content type="html"><![CDATA[<p>JSP(Java Server Pages)，实质上就是servlet，用于开发动态web资源。JSP其实就是在html中写Java代码，即JSP = JAVA+HTML。</p><p>JSP动态页面技术的执行过程（原理）：</p><pre><code>JSP--&gt;翻译成servlet（.Java）--&gt;编译成（.class）--&gt;初始化--&gt;实例化--&gt;服务--&gt;销毁所以第一次访问JSP时可能会比较慢。</code></pre><h2 id="JSP快速入门"><a href="#JSP快速入门" class="headerlink" title="JSP快速入门"></a>JSP快速入门</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"Java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;!-- 导包 --&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">"java.util.*"</span>%&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">"-//W3C//DTD HTML 4.01 Transitional//EN"</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;my jsp&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;!-- 写的都方法体的内容 --&gt;</span><br><span class="line">    &lt;%</span><br><span class="line">        <span class="comment">//获取当前时间</span></span><br><span class="line">        Date date = <span class="keyword">new</span> Date();</span><br><span class="line">        String date2 = date.toLocaleString();</span><br><span class="line">        <span class="comment">//response.getWriter().println(date2);</span></span><br><span class="line">    %&gt;</span><br><span class="line">    &lt;%=date2%&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- <span class="keyword">for</span>循环 --&gt;</span><br><span class="line">    &lt;%</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;h1&gt;winter is coming!&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">    &lt;%</span><br><span class="line">        &#125;</span><br><span class="line">    %&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h2 id="JSP的基本语法"><a href="#JSP的基本语法" class="headerlink" title="JSP的基本语法"></a>JSP的基本语法</h2><h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><ol><li><p>html的注释</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- html的注释 --&gt;</span><br></pre></td></tr></table></figure></li><li><p>jsp注释</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;%-- &lt;%</span><br><span class="line"><span class="comment">//java注释</span></span><br><span class="line"><span class="keyword">int</span> a = <span class="number">2</span>;</span><br><span class="line">%&gt; --%&gt;</span><br></pre></td></tr></table></figure></li><li><p>jsp小脚本可使用java注释</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//java单行注释</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">java多行注释</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="jsp小脚本"><a href="#jsp小脚本" class="headerlink" title="jsp小脚本"></a>jsp小脚本</h3><ol><li>&lt;% 此处写java代码 %&gt;</li><li>&lt;%=要输出的内容%&gt;</li><li>&lt;% 声明局部变量 %&gt;</li><li>&lt;%! 声明全局变量%&gt;</li></ol><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- java小脚本 --&gt;</span><br><span class="line">&lt;%</span><br><span class="line">String str = <span class="string">"声明局部变量"</span>;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">&lt;%!String str2=<span class="string">"声明全局变量"</span>; %&gt;</span><br><span class="line"></span><br><span class="line">&lt;%=str+<span class="string">" 输出内容"</span> %&gt;</span><br></pre></td></tr></table></figure><h2 id="三大指令"><a href="#三大指令" class="headerlink" title="三大指令"></a>三大指令</h2><h3 id="Page指令"><a href="#Page指令" class="headerlink" title="Page指令"></a>Page指令</h3><p>Page指令，作用在整个页面上。语法： &lt;%@ 指令名(page) 属性 %&gt;</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 设置语言、编码方式等 --&gt;</span><br><span class="line">&lt;%@ page language=<span class="string">"Java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 导包 --&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">"java.util.*"</span>%&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 指定出错跳转页面 --&gt;</span><br><span class="line">&lt;%@ page errorPage=<span class="string">"error.jsp"</span> %&gt;</span><br></pre></td></tr></table></figure><h3 id="Include指令"><a href="#Include指令" class="headerlink" title="Include指令"></a>Include指令</h3><p>Include指令，用于静态包含，将另一个jsp静态页面包含在此jsp页面中。</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"Java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line"></span><br><span class="line">&lt;%@ include file=<span class="string">"header.jsp"</span>%&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">"-//W3C//DTD HTML 4.01 Transitional//EN"</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Include&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;This is a include page&lt;/h1&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;%@ include file=<span class="string">"footer.jsp"</span>%&gt;</span><br></pre></td></tr></table></figure><h3 id="Taglib指令"><a href="#Taglib指令" class="headerlink" title="Taglib指令"></a>Taglib指令</h3><p>Taglib指令，用于引入一些jsp的标签库。需要jar包：jstl.jar、standard.jar。语法：</p><pre><code>&lt;%@taglib prefix=&quot;&quot; uri=&quot;&quot; %&gt;uri  标签文件的URI地址prefix  标签组的命名空间前缀</code></pre><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="meta">@taglib</span> uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span> %&gt;</span><br></pre></td></tr></table></figure><h2 id="EL表达式"><a href="#EL表达式" class="headerlink" title="EL表达式"></a>EL表达式</h2><p>EL表达式（Expression Language）是jsp的内置表达式语言，用来取代jsp中的Java代码，主要作用是获取域中的数据。 其作用为： </p><ol><li>获取域中数据<br>EL表达式主要用于替换JSP页面中的脚本表达式，以从各种类型的web域 中检索java对象、获取数据。(访问javabean属性、list集合、map集合等)</li><li>执行算数运算</li><li>获取web对象</li><li>调用Java方法</li></ol><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;%@ page language=<span class="string">"Java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"com.bean.User, java.util.*"</span>%&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">"-//W3C//DTD HTML 4.01 Transitional//EN"</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;my jsp&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;!-- 获取域中数据和算数运算 --&gt;</span><br><span class="line">    &lt;%</span><br><span class="line">        request.setAttribute(<span class="string">"name"</span>, <span class="string">"linda"</span>);</span><br><span class="line"></span><br><span class="line">        User user1 = <span class="keyword">new</span> User(<span class="string">"linda1"</span>, <span class="string">"linda1"</span>);</span><br><span class="line">        User user2 = <span class="keyword">new</span> User(<span class="string">"linda2"</span>, <span class="string">"linda2"</span>);</span><br><span class="line">        User user3 = <span class="keyword">new</span> User(<span class="string">"linda3"</span>, <span class="string">"linda3"</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;User&gt; users = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        users.add(user1);</span><br><span class="line">        users.add(user2);</span><br><span class="line">        users.add(user3);</span><br><span class="line"></span><br><span class="line">        Map&lt;String, User&gt; maps = <span class="keyword">new</span> HashMap();</span><br><span class="line">        maps.put(<span class="string">"user1"</span>, user1);</span><br><span class="line">        maps.put(<span class="string">"user2"</span>, user2);</span><br><span class="line">        maps.put(<span class="string">"user3"</span>, user3);</span><br><span class="line"></span><br><span class="line">        session.setAttribute(<span class="string">"user1"</span>, user1);</span><br><span class="line">        session.setAttribute(<span class="string">"list"</span>, users);</span><br><span class="line">        session.setAttribute(<span class="string">"map"</span>, maps);</span><br><span class="line">    %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 获取域中的字符串 --&gt;</span><br><span class="line">    $&#123;name&#125;</span><br><span class="line">    &lt;!-- 获取域中的实体bean属性 --&gt;</span><br><span class="line">    $&#123;user1.name&#125;</span><br><span class="line">    &lt;!-- 获取域中的list集合 --&gt;</span><br><span class="line">    $&#123;list[<span class="number">0</span>].name &#125;</span><br><span class="line">    &lt;!-- 获取域中的map集合 --&gt;</span><br><span class="line">    $&#123;map.user1.name &#125;</span><br><span class="line">    &lt;!-- 算数运算 --&gt;</span><br><span class="line">    $&#123;<span class="number">1</span>+<span class="number">2</span>-<span class="number">3</span>*<span class="number">4</span>/<span class="number">5</span>&#125;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h2 id="JSTL标准标签库"><a href="#JSTL标准标签库" class="headerlink" title="JSTL标准标签库"></a>JSTL标准标签库</h2><blockquote><p>JSTL(JSP Standard Tag Library，jsp标准标签库)是Apache对EL表达式的扩展，也就是说JSTL依赖EL表达式。JSTL是标签语言，使用起来非常方便。但是它不是jsp内置的标签，所以用的时候需要我们自己导包，以及指定标签库。</p></blockquote><pre><code>&lt;c:if  test=&quot;&quot;&gt;取代页面中if条件语句&lt;c:forEach items var begin varStatus&gt;取代页面中for循环</code></pre><p>代码示例：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"Java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"com.bean.User,java.util.*"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@taglib</span> uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">"-//W3C//DTD HTML 4.01 Transitional//EN"</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;my jsp&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;%</span><br><span class="line">        User user1 = <span class="keyword">new</span> User(<span class="string">"linda1"</span>, <span class="string">"linda1"</span>);</span><br><span class="line">        User user2 = <span class="keyword">new</span> User(<span class="string">"linda2"</span>, <span class="string">"linda2"</span>);</span><br><span class="line">        User user3 = <span class="keyword">new</span> User(<span class="string">"linda3"</span>, <span class="string">"linda3"</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;User&gt; users = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        users.add(user1);</span><br><span class="line">        users.add(user2);</span><br><span class="line">        users.add(user3);</span><br><span class="line">        Map&lt;String, User&gt; maps = <span class="keyword">new</span> HashMap();</span><br><span class="line">        session.setAttribute(<span class="string">"list"</span>, users);</span><br><span class="line">    %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;!empty list &#125;"</span>&gt;</span><br><span class="line">    $&#123;list &#125;</span><br><span class="line">    &lt;/c:if&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line"></span><br><span class="line">    &lt;c:forEach items=<span class="string">"$&#123;list &#125;"</span> <span class="keyword">var</span>=<span class="string">"user"</span> begin=<span class="string">"0"</span> varStatus=<span class="string">"stu"</span>&gt;</span><br><span class="line">    $&#123;stu.index &#125;</span><br><span class="line">    $&#123;stu.count &#125;</span><br><span class="line">    $&#123;user &#125; &lt;br&gt;</span><br><span class="line">    &lt;/c:forEach&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- </span><br><span class="line"> items 属性  ： 结合el表达式从域中获取要遍历的集合</span><br><span class="line"> <span class="keyword">var</span>   属性  ： 每遍历一次 获取的实体User的接收者 ，</span><br><span class="line"> begin      ：开始遍历的角标     从<span class="number">0</span> 开始计数</span><br><span class="line"> varStatus 遍历者当前的状态      index 从<span class="number">0</span>开始</span><br><span class="line">                                count 计数</span><br><span class="line">  --&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;JSP(Java Server Pages)，实质上就是servlet，用于开发动态web资源。JSP其实就是在html中写Java代码，即JSP = JAVA+HTML。&lt;/p&gt;
&lt;p&gt;JSP动态页面技术的执行过程（原理）：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;JSP--&amp;gt
      
    
    </summary>
    
      <category term="JavaWeb" scheme="http://zsx-cup.top/categories/JavaWeb/"/>
    
    
      <category term="JSP" scheme="http://zsx-cup.top/tags/JSP/"/>
    
  </entry>
  
  <entry>
    <title>Xml解析及会话技术</title>
    <link href="http://zsx-cup.top/2018/11/25/Xml%E8%A7%A3%E6%9E%90%E5%8F%8A%E4%BC%9A%E8%AF%9D%E6%8A%80%E6%9C%AF/"/>
    <id>http://zsx-cup.top/2018/11/25/Xml解析及会话技术/</id>
    <published>2018-11-25T08:58:05.000Z</published>
    <updated>2018-11-25T17:28:14.131Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>XML 指可扩展标记语言（EXtensible Markup Language），类似 HTML。<br>XML 的设计宗旨是传输数据，而非显示数据。<br>XML 标签没有被预定义，您需要自行定义标签。<br>XML 广泛应用于框架的配置文件，如ssm。<br>XML 不是 HTML 的替代，XML 和 HTML 为不同的目的而设计：<br>    XML 被设计为传输和存储数据，其焦点是数据的内容；<br>    HTML 被设计用来显示数据，其焦点是数据的外观。</p></blockquote><h2 id="XML解析"><a href="#XML解析" class="headerlink" title="XML解析"></a>XML解析</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--xml文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">books</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">book</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">author</span>&gt;</span>钱钟书<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span> <span class="attr">id</span>=<span class="string">"qzs"</span>&gt;</span>围城<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">content</span>&gt;</span>人生是一座围城，城里的人想出去，城外的人想进来，工作生活莫不是如此。<span class="tag">&lt;/<span class="name">content</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">price</span>&gt;</span>30<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">books</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//xml解析</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> DocumentException </span>&#123;</span><br><span class="line">    <span class="comment">// 创建一个解析器</span></span><br><span class="line">    SAXReader reader = <span class="keyword">new</span> SAXReader();</span><br><span class="line">    <span class="comment">// 获取代表文件的对象</span></span><br><span class="line">    Document document = reader.read(<span class="string">"src/demo.xml"</span>);</span><br><span class="line">    <span class="comment">// 获取根节点&lt;books&gt;</span></span><br><span class="line">    Element root = document.getRootElement();</span><br><span class="line">    <span class="comment">// 获取根节点下的子节点&lt;book&gt;</span></span><br><span class="line">    Element book = root.element(<span class="string">"book"</span>);</span><br><span class="line">    <span class="comment">// 获取book节点下的 子节点</span></span><br><span class="line">    Element author = book.element(<span class="string">"author"</span>);</span><br><span class="line">    Element name = book.element(<span class="string">"name"</span>);</span><br><span class="line">    Element content = book.element(<span class="string">"content"</span>);</span><br><span class="line">    <span class="comment">// 获取name节点属性</span></span><br><span class="line">    Attribute attribute = name.attribute(<span class="string">"id"</span>);</span><br><span class="line">    String id = attribute.getValue();</span><br><span class="line">    <span class="comment">// System.out.println(id);</span></span><br><span class="line">    <span class="comment">// 获取content节点的文本</span></span><br><span class="line">    String cont = content.getText();</span><br><span class="line">    <span class="comment">// System.out.println(cont);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="模拟Spring管理对象"><a href="#模拟Spring管理对象" class="headerlink" title="模拟Spring管理对象"></a>模拟Spring管理对象</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--xml文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"servlet"</span>&gt;</span>com.web.UserServlet<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"service"</span>&gt;</span>com.service.UserService<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dao"</span>&gt;</span>com.dao.UserDao<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"bean"</span>&gt;</span>com.bean.UserBean<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>模拟spring管理对象，借助他人管理对象，而非new一个对象。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 模拟spring管理对象</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap();</span><br><span class="line">    <span class="comment">// 创建一个解析器</span></span><br><span class="line">    SAXReader reader = <span class="keyword">new</span> SAXReader();</span><br><span class="line">    <span class="comment">// 获取代表文件的对象</span></span><br><span class="line">    Document document = reader.read(<span class="string">"src/application.xml"</span>);</span><br><span class="line">    <span class="comment">// 获取根节点&lt;beans&gt;</span></span><br><span class="line">    Element root = document.getRootElement();</span><br><span class="line">    <span class="comment">// 获取所有子节点</span></span><br><span class="line">    List list = root.elements();</span><br><span class="line">    <span class="keyword">for</span> (Object obj : list) &#123;</span><br><span class="line">        Element e = (Element) obj;</span><br><span class="line">        String name = e.attribute(<span class="string">"id"</span>).getValue();</span><br><span class="line">        String className = e.getText();</span><br><span class="line">        <span class="comment">// 获取实现类</span></span><br><span class="line">        Object instance = Class.forName(className).newInstance();</span><br><span class="line">        map.put(name, instance);</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(map);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="简单依赖管理"><a href="#简单依赖管理" class="headerlink" title="简单依赖管理"></a>简单依赖管理</h3><p>xml文件<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- xml文件:servlet依赖于service和dao --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"servlet"</span> <span class="attr">class</span>=<span class="string">"com.web.UserServlet"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">id</span>=<span class="string">"service"</span>&gt;</span>com.service.UserService<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">id</span>=<span class="string">"dao"</span>&gt;</span>com.dao.UserDao<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>简单依赖管理，servlet依赖于service和dao，所以先创建service和dao，然后创建servlet，避免报错。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 简单依赖管理</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap();</span><br><span class="line">    SAXReader reader = <span class="keyword">new</span> SAXReader();</span><br><span class="line">    Document document = reader.read(<span class="string">"src/bean.xml"</span>);</span><br><span class="line">    Element bean = document.getRootElement();</span><br><span class="line">    List list = bean.elements();</span><br><span class="line">    <span class="comment">//servlet依赖于service和dao，所以先创建service和dao</span></span><br><span class="line">    <span class="keyword">for</span> (Object obj : list) &#123;</span><br><span class="line">        Element e = (Element) obj;</span><br><span class="line">        String key = e.attribute(<span class="string">"id"</span>).getValue();</span><br><span class="line">        String className = e.getText();</span><br><span class="line">        Object instance = Class.forName(className).newInstance();</span><br><span class="line">        map.put(key, instance);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//创建service和dao之后，创建Servlet</span></span><br><span class="line">    String key = bean.attribute(<span class="string">"id"</span>).getValue();</span><br><span class="line">    String className = bean.attribute(<span class="string">"class"</span>).getValue();</span><br><span class="line">    Object instance = Class.forName(className).newInstance();</span><br><span class="line">    map.put(key, instance);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><blockquote><p>public class Cookie</p></blockquote><blockquote><p>Creates a cookie, a small amount of information sent by a servlet to a Web browser, saved by the browser, and later sent back to the server. A cookie’s value can uniquely identify a client, so cookies are commonly used for session management. </p></blockquote><blockquote><p>A cookie has a name, a single value, and optional attributes such as a comment, path and domain qualifiers, a maximum age, and a version number. Some Web browsers have bugs in how they handle the optional attributes, so use them sparingly to improve the interoperability of your servlets. </p></blockquote><h3 id="创建cookie"><a href="#创建cookie" class="headerlink" title="创建cookie"></a>创建cookie</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建cookie</span></span><br><span class="line">Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"name"</span>, <span class="string">"linda"</span>);</span><br><span class="line"><span class="comment">//设置路径</span></span><br><span class="line">cookie.setPath(<span class="string">"/"</span>);</span><br><span class="line"><span class="comment">//设置最大存活时间</span></span><br><span class="line">cookie.setMaxAge(<span class="number">60</span>*<span class="number">60</span>);</span><br><span class="line"><span class="comment">//将cookie发送至浏览器</span></span><br><span class="line">response.addCookie(cookie);</span><br></pre></td></tr></table></figure><h3 id="获取本地cookie"><a href="#获取本地cookie" class="headerlink" title="获取本地cookie"></a>获取本地cookie</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取本地cookie</span></span><br><span class="line">Cookie[] cookies = request.getCookies();</span><br><span class="line"><span class="comment">//遍历cookie</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">null</span>!=cookies)&#123;</span><br><span class="line">    <span class="keyword">for</span> (Cookie cookie : cookies) &#123;</span><br><span class="line">        String name = cookie.getName();</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">"name"</span>.equals(name))&#123;</span><br><span class="line">            String value = cookie.getValue();</span><br><span class="line">            response.getWriter().println(value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="访问时间案例"><a href="#访问时间案例" class="headerlink" title="访问时间案例"></a>访问时间案例</h3><p>将创建cookie与取出cookie放在一起，实现动态显示上次访问时间。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建当前访问时间cookie</span></span><br><span class="line"><span class="comment">// 获取当前访问时间</span></span><br><span class="line"><span class="keyword">long</span> currentTimeMillis = System.currentTimeMillis();</span><br><span class="line">String time = currentTimeMillis + <span class="string">""</span>;</span><br><span class="line"><span class="comment">// 创建cookie</span></span><br><span class="line">Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"time"</span>, time);</span><br><span class="line"><span class="comment">// 将cookie发送至浏览器</span></span><br><span class="line">response.addCookie(cookie);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取本地cookie</span></span><br><span class="line">Cookie[] cookies = request.getCookies();</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">null</span> != cookies) &#123;</span><br><span class="line">    <span class="keyword">for</span> (Cookie cookie2 : cookies) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"time"</span>.equals(cookie2.getName())) &#123;</span><br><span class="line">            String value = cookie2.getValue();</span><br><span class="line">            <span class="keyword">long</span> parseLong = Long.parseLong(value);</span><br><span class="line">            Date date = <span class="keyword">new</span> Date(parseLong);</span><br><span class="line">            <span class="meta">@SuppressWarnings</span>(<span class="string">"deprecation"</span>)</span><br><span class="line">            String localeString = date.toLocaleString();</span><br><span class="line">            response.getWriter().println(<span class="string">"您上次访问的时间是："</span> + localeString);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    response.getWriter().println(<span class="string">"您是第一次访问"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="解决cookie存放中文的问题"><a href="#解决cookie存放中文的问题" class="headerlink" title="解决cookie存放中文的问题"></a>解决cookie存放中文的问题</h3><p>将含有中文的cookie先以utf-8编码，然后再以utf-8解码取出。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建cookie</span></span><br><span class="line">String name = <span class="string">"琳达"</span>;</span><br><span class="line"><span class="comment">// 将中文编码</span></span><br><span class="line">String nname = URLEncoder.encode(name, <span class="string">"UTF-8"</span>);</span><br><span class="line">Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"name"</span>, nname);</span><br><span class="line">response.addCookie(cookie);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 从本地获取cookie</span></span><br><span class="line">Cookie[] cookies = request.getCookies();</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">null</span> != cookies) &#123;</span><br><span class="line">    <span class="keyword">for</span> (Cookie cookie2 : cookies) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"name"</span>.equals(cookie2.getName())) &#123;</span><br><span class="line">            String value = cookie2.getValue();</span><br><span class="line">            <span class="comment">//解码</span></span><br><span class="line">            String decode = URLDecoder.decode(value, <span class="string">"UTF-8"</span>);</span><br><span class="line">            response.getWriter().println(decode);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="HttpSession"><a href="#HttpSession" class="headerlink" title="HttpSession"></a>HttpSession</h2><blockquote><p>public abstract interface HttpSession</p></blockquote><blockquote><p>Provides a way to identify a user across more than one page request or visit to a Web site and to store information about that user. </p></blockquote><blockquote><p>The servlet container uses this interface to create a session between an HTTP client and an HTTP server. The session persists for a specified time period, across more than one connection or page request from the user. A session usually corresponds to one user, who may visit a site many times. The server can maintain a session in many ways such as using cookies or rewriting URLs.</p></blockquote><p>Session作为一个域对象，存储数据，作用范围一次会话</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取Seesion，域对象，作用范围：一次会话</span></span><br><span class="line">HttpSession session = request.getSession();</span><br><span class="line"><span class="comment">// 设置session最大存活时间</span></span><br><span class="line">session.setMaxInactiveInterval(<span class="number">60</span> * <span class="number">60</span>);</span><br><span class="line"><span class="comment">// 向seesion中存数据</span></span><br><span class="line">session.setAttribute(<span class="string">"name"</span>, <span class="string">"linda"</span>);</span><br><span class="line">session.setAttribute(<span class="string">"gender"</span>, <span class="string">"woman"</span>);</span><br><span class="line">session.setAttribute(<span class="string">"age"</span>, <span class="number">18</span>);</span><br><span class="line"><span class="comment">// 移除数据</span></span><br><span class="line"><span class="comment">// session.removeAttribute("age");</span></span><br><span class="line"><span class="comment">// 遍历存入的数据</span></span><br><span class="line">Enumeration&lt;String&gt; names = session.getAttributeNames();</span><br><span class="line"><span class="keyword">while</span> (names.hasMoreElements()) &#123;</span><br><span class="line">    String name = names.nextElement();</span><br><span class="line">    Object value = session.getAttribute(name);</span><br><span class="line">    System.out.println(name + <span class="string">"="</span> + value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="借助session改进登录案列"><a href="#借助session改进登录案列" class="headerlink" title="借助session改进登录案列"></a>借助session改进登录案列</h3><p>登录时，先从session中取用户信息。</p><ol><li>如果取到，说明在登录状态，页面跳转；</li><li><p>如果没有取到，说明session过期，或者没有登录，需要从数据库查询数据登录。</p><ul><li>操作数据库登录成功后，将用户信息放在session中。</li><li>如果登录失败，页面跳转。</li></ul></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取session域对象</span></span><br><span class="line">HttpSession session = request.getSession();</span><br><span class="line">User user = (User) session.getAttribute(<span class="string">"user"</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">null</span> == user) &#123;<span class="comment">// user为空，表明没有未登录</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 从数据库查询数据登录</span></span><br><span class="line">        <span class="comment">// 接收页面参数</span></span><br><span class="line">        String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">        String pwd = request.getParameter(<span class="string">"pwd"</span>);</span><br><span class="line">        <span class="comment">// 直接操作数据库登录</span></span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        String sql = <span class="string">"select * from user2 where name=? and password=?"</span>;</span><br><span class="line">        User user2 = runner.query(sql, <span class="keyword">new</span> BeanHandler&lt;User&gt;(User.class), name, pwd);</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">null</span>!=user2)&#123;<span class="comment">//登录成功，页面跳转，并将参数存入session</span></span><br><span class="line">            response.sendRedirect(<span class="string">"/webday09/success.html"</span>);</span><br><span class="line">            session.setAttribute(<span class="string">"user"</span>, user2);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;<span class="comment">//跳转登录失败页面</span></span><br><span class="line">            response.sendRedirect(<span class="string">"/webday09/sorry.html"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;<span class="comment">//页面跳转，已登录状态</span></span><br><span class="line">    response.sendRedirect(<span class="string">"/webday09/successing.html"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;XML 指可扩展标记语言（EXtensible Markup Language），类似 HTML。&lt;br&gt;XML 的设计宗旨是传输数据，而非显示数据。&lt;br&gt;XML 标签没有被预定义，您需要自行定义标签。&lt;br&gt;XML 广泛应用于框架的配置文件，如
      
    
    </summary>
    
      <category term="JavaWeb" scheme="http://zsx-cup.top/categories/JavaWeb/"/>
    
    
      <category term="XML" scheme="http://zsx-cup.top/tags/XML/"/>
    
      <category term="Cookie" scheme="http://zsx-cup.top/tags/Cookie/"/>
    
      <category term="HttpSession" scheme="http://zsx-cup.top/tags/HttpSession/"/>
    
  </entry>
  
  <entry>
    <title>Servlet应用小案例</title>
    <link href="http://zsx-cup.top/2018/11/24/Servlet%E5%BA%94%E7%94%A8%E5%B0%8F%E6%A1%88%E4%BE%8B/"/>
    <id>http://zsx-cup.top/2018/11/24/Servlet应用小案例/</id>
    <published>2018-11-24T13:45:04.000Z</published>
    <updated>2018-12-02T09:37:04.916Z</updated>
    
    <content type="html"><![CDATA[<h2 id="转账案例"><a href="#转账案例" class="headerlink" title="转账案例"></a>转账案例</h2><p>开发环境准备：jar包、c3p0.properties、db.properties(MyDbUtil工具类)</p><p>步骤分析:</p><ol><li>html页面： form，action，method</li><li>servlet： 接收参数，调用service</li><li>service： 事务管理，调用dao</li><li>dao： 操作数据库</li></ol><p>Connection的两种传递方式：</p><ol><li>作为参数传递：dao</li><li>从本地线程中传递</li></ol><h3 id="html转账页：form表单"><a href="#html转账页：form表单" class="headerlink" title="html转账页：form表单"></a>html转账页：form表单</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="servlet：接收参数，调用service"><a href="#servlet：接收参数，调用service" class="headerlink" title="servlet：接收参数，调用service"></a>servlet：接收参数，调用service</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Transfer</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="comment">// 调用UserService</span></span><br><span class="line">    <span class="comment">// UserService service = new UserService();</span></span><br><span class="line">    UserService2 service = <span class="keyword">new</span> UserService2();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        response.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>);</span><br><span class="line">        <span class="comment">// 转账</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 接收页面参数</span></span><br><span class="line">            String from = request.getParameter(<span class="string">"from"</span>);</span><br><span class="line">            String to = request.getParameter(<span class="string">"to"</span>);</span><br><span class="line">            String money = request.getParameter(<span class="string">"money"</span>);</span><br><span class="line">            <span class="keyword">int</span> i = service.transfer(from, to, money);</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">1</span>) &#123;</span><br><span class="line">                response.sendRedirect(<span class="string">"/webday08/success.html"</span>);</span><br><span class="line">                <span class="comment">// System.out.println("转账成功");</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                response.sendRedirect(<span class="string">"/webday08/sorry.html"</span>);</span><br><span class="line">                <span class="comment">// System.out.println("转账失败");</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="service：事务管理，调用dao"><a href="#service：事务管理，调用dao" class="headerlink" title="service：事务管理，调用dao"></a>service：事务管理，调用dao</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService2</span> </span>&#123;</span><br><span class="line">    UserDao2 dao = <span class="keyword">new</span> UserDao2();</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 转账服务</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> from 付款人</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> to 收款人</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> money 金额</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 状态码，1表示转账成功，0表示转账失败</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">transfer</span><span class="params">(String from, String to, String money)</span> <span class="keyword">throws</span> SQLException</span>&#123;</span><br><span class="line">        Connection connection = MyDbUtil2.getConnection();</span><br><span class="line">        <span class="comment">//开启事务</span></span><br><span class="line">        connection.setAutoCommit(<span class="keyword">false</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//付款</span></span><br><span class="line">        <span class="keyword">int</span> i = dao.payMoney(to, money);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//bug</span></span><br><span class="line">        <span class="comment">//int a = 1/0;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//收款</span></span><br><span class="line">        <span class="keyword">int</span> j = dao.receMoney(from, money);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//提交事务</span></span><br><span class="line">        connection.commit();</span><br><span class="line">        <span class="keyword">return</span> i&amp;j;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="dao：操作数据库"><a href="#dao：操作数据库" class="headerlink" title="dao：操作数据库"></a>dao：操作数据库</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">payMoney</span><span class="params">(String to, String money)</span> <span class="keyword">throws</span> SQLException</span>&#123;</span><br><span class="line">        Connection connection = MyDbUtil2.getConnection();</span><br><span class="line">        <span class="comment">//付款，执行SQL语句</span></span><br><span class="line">        String sql = <span class="string">"update user set money = money-? where name=?"</span>;</span><br><span class="line">        PreparedStatement statement = connection.prepareStatement(sql);</span><br><span class="line">        statement.setString(<span class="number">1</span>, money);</span><br><span class="line">        statement.setString(<span class="number">2</span>, to);</span><br><span class="line">        <span class="keyword">int</span> i = statement.executeUpdate();</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">receMoney</span><span class="params">(String from, String money)</span> <span class="keyword">throws</span> SQLException</span>&#123;</span><br><span class="line">        Connection connection = MyDbUtil2.getConnection();</span><br><span class="line">        <span class="comment">//收款，执行SQL语句</span></span><br><span class="line">        String sql = <span class="string">"update user set money = money+? where name=?"</span>;</span><br><span class="line">        PreparedStatement statement = connection.prepareStatement(sql);</span><br><span class="line">        statement.setString(<span class="number">1</span>, money);</span><br><span class="line">        statement.setString(<span class="number">2</span>, from);</span><br><span class="line">        <span class="keyword">int</span> j = statement.executeUpdate();</span><br><span class="line">        <span class="keyword">return</span> j;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="MyDbUtil：获取连接的工具类"><a href="#MyDbUtil：获取连接的工具类" class="headerlink" title="MyDbUtil：获取连接的工具类"></a>MyDbUtil：获取连接的工具类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyDbUtil2</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> String url = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">static</span> String name = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">static</span> String password = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 静态表代码块:加载配置文件，注册驱动</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="comment">// 加载配置文件</span></span><br><span class="line">        ResourceBundle bundle = ResourceBundle.getBundle(<span class="string">"db"</span>);</span><br><span class="line">        String driverClass = bundle.getString(<span class="string">"driverClass"</span>);</span><br><span class="line">        url = bundle.getString(<span class="string">"url"</span>);</span><br><span class="line">        name = bundle.getString(<span class="string">"name"</span>);</span><br><span class="line">        password = bundle.getString(<span class="string">"password"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 注册驱动</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(driverClass);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 从本地线程中获取连接</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 连接</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     *             数据库异常</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> ThreadLocal&lt;Connection&gt; thread = <span class="keyword">new</span> ThreadLocal&lt;&gt;();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="comment">//可理解为一个本地线程连接池</span></span><br><span class="line">        Connection connection = thread.get();</span><br><span class="line">        <span class="keyword">if</span>(connection == <span class="keyword">null</span>)&#123;</span><br><span class="line">            connection = DriverManager.getConnection(url, name, password);</span><br><span class="line">            thread.set(connection);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> connection;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 释放资源</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> connection</span></span><br><span class="line"><span class="comment">     *            连接</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> statement</span></span><br><span class="line"><span class="comment">     *            发送执行sql语句的对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> resultSet</span></span><br><span class="line"><span class="comment">     *            查询返回的结果集</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">release</span><span class="params">(Connection connection, Statement statement, ResultSet resultSet)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">null</span> != resultSet) &#123;</span><br><span class="line">                resultSet.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">null</span> != statement) &#123;</span><br><span class="line">                statement.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">null</span> != connection) &#123;</span><br><span class="line">                connection.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="查询商品案列"><a href="#查询商品案列" class="headerlink" title="查询商品案列"></a>查询商品案列</h2><h3 id="查询页面"><a href="#查询页面" class="headerlink" title="查询页面"></a>查询页面</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Search<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Search Product<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/webday08/Search"</span> <span class="attr">method</span>=<span class="string">"get"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"keywords"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>Search<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="servlet：获取页面参数，调用service"><a href="#servlet：获取页面参数，调用service" class="headerlink" title="servlet：获取页面参数，调用service"></a>servlet：获取页面参数，调用service</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Search</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    SearchService service = <span class="keyword">new</span> SearchService();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        response.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 接收页面参数</span></span><br><span class="line">            String keywords = request.getParameter(<span class="string">"keywords"</span>);</span><br><span class="line">            <span class="comment">// 调用service</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="string">""</span>.equals(keywords)) &#123;</span><br><span class="line">                List&lt;Product&gt; products = service.SearchAllProducts();</span><br><span class="line">                response.getWriter().write(products.toString());</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                List&lt;Product&gt; products = service.SearchProductsLikeName(keywords);</span><br><span class="line">                response.getWriter().write(products.toString());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="service-查询事务管理，调用dao"><a href="#service-查询事务管理，调用dao" class="headerlink" title="service:查询事务管理，调用dao"></a>service:查询事务管理，调用dao</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SearchService</span> </span>&#123;</span><br><span class="line">    SearchDao dao = <span class="keyword">new</span> SearchDao();</span><br><span class="line">    <span class="comment">//查询所有商品</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">SearchAllProducts</span><span class="params">()</span> <span class="keyword">throws</span> SQLException</span>&#123;</span><br><span class="line">        List&lt;Product&gt; products = dao.SearchAllProducts();</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//查询含有关键词的商品，条件模糊查询</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">SearchProductsLikeName</span><span class="params">(String keywords)</span> <span class="keyword">throws</span> SQLException</span>&#123;</span><br><span class="line">        List&lt;Product&gt; products = dao.SearchProductsLikeName(keywords);</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="dao-操作数据库"><a href="#dao-操作数据库" class="headerlink" title="dao:操作数据库"></a>dao:操作数据库</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SearchDao</span> </span>&#123;</span><br><span class="line">    <span class="comment">//查询所有</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">SearchAllProducts</span><span class="params">()</span> <span class="keyword">throws</span> SQLException</span>&#123;</span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        String sql = <span class="string">"select * from product"</span>;</span><br><span class="line">        List&lt;Product&gt; list = runner.query(sql, <span class="keyword">new</span> BeanListHandler&lt;Product&gt;(Product.class));</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//条件模糊查询</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">SearchProductsLikeName</span><span class="params">(String keywords)</span> <span class="keyword">throws</span> SQLException</span>&#123;</span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        String sql = <span class="string">"select * from product where name like ?"</span>;</span><br><span class="line">        String nkeywords = <span class="string">"%"</span>+keywords+<span class="string">"%"</span>;</span><br><span class="line">        List&lt;Product&gt; list = runner.query(sql, <span class="keyword">new</span> BeanListHandler&lt;Product&gt;(Product.class), nkeywords);</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="面向接口编程"><a href="#面向接口编程" class="headerlink" title="面向接口编程"></a>面向接口编程</h2><p>面向对象编程：</p><pre><code>类：属性（数据）和方法找对象--&gt;类的实例 --&gt;打点调方法</code></pre><p>面向接口编程：</p><pre><code>接口--&gt;多态--&gt;一种事物的多种表现形式左边接口   右边实现类</code></pre><h3 id="面向接口解耦合"><a href="#面向接口解耦合" class="headerlink" title="面向接口解耦合"></a>面向接口解耦合</h3><p>接口UserDao<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ou;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>实现类UserDaoImpl1<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ou;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl1</span> <span class="keyword">implements</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"UserDaoImpl1"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>实现类UserDaoImpl2<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ou;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl2</span> <span class="keyword">implements</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"UserDaoImpl2"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>配置文件<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">userdao=com.ou.UserDaoImpl2</span><br></pre></td></tr></table></figure></p><p>演示实例<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//加载配置文件</span></span><br><span class="line">        InputStream in = MyTest.class.getClassLoader().getResourceAsStream(<span class="string">"dao.properties"</span>);</span><br><span class="line">        Properties p = <span class="keyword">new</span> Properties();</span><br><span class="line">        p.load(in);</span><br><span class="line">        <span class="comment">//获取类名称</span></span><br><span class="line">        String className = p.getProperty(<span class="string">"userdao"</span>);</span><br><span class="line">        <span class="comment">//左边接口，右边实现类</span></span><br><span class="line">        <span class="comment">//UserDao userdao = new UserDaoImpl1();</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//实现dao解耦合：修改配置文件可以改变实现类，然后创建实例</span></span><br><span class="line">        UserDao userdao = (UserDao) Class.forName(className).newInstance();</span><br><span class="line">        <span class="comment">//调用实现类方法</span></span><br><span class="line">        userdao.test();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="登录案列：接口-三层代码分离"><a href="#登录案列：接口-三层代码分离" class="headerlink" title="登录案列：接口+三层代码分离"></a>登录案列：接口+三层代码分离</h2><h3 id="Servlet：接收页面参数，调用service"><a href="#Servlet：接收页面参数，调用service" class="headerlink" title="Servlet：接收页面参数，调用service"></a>Servlet：接收页面参数，调用service</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Login</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    LoginService service = <span class="keyword">new</span> LoginServiceImpl();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        response.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//接收页面参数</span></span><br><span class="line">            String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">            String pwd = request.getParameter(<span class="string">"pwd"</span>);</span><br><span class="line">            <span class="comment">//调用service</span></span><br><span class="line">            User user = service.login(name, pwd);</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Service-事务管理，调用dao"><a href="#Service-事务管理，调用dao" class="headerlink" title="Service: 事务管理，调用dao"></a>Service: 事务管理，调用dao</h3><p>Service接口<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">LoginService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">login</span><span class="params">(String name, String pwd)</span> <span class="keyword">throws</span> SQLException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>Service实现类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServiceImpl</span> <span class="keyword">implements</span> <span class="title">LoginService</span> </span>&#123;</span><br><span class="line">    LoginDao dao = <span class="keyword">new</span> LoginDaoImpl();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">login</span><span class="params">(String name, String pwd)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        User user = dao.login(name, pwd);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="Dao-操作数据库"><a href="#Dao-操作数据库" class="headerlink" title="Dao: 操作数据库"></a>Dao: 操作数据库</h3><p>Dao接口<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">LoginDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">login</span><span class="params">(String name, String pwd)</span> <span class="keyword">throws</span> SQLException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>Dao实现类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginDaoImpl</span> <span class="keyword">implements</span> <span class="title">LoginDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">login</span><span class="params">(String name, String pwd)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        String sql = <span class="string">"select * from user2 where name=? and password=?"</span>;</span><br><span class="line">        User user = runner.query(sql, <span class="keyword">new</span> BeanHandler&lt;User&gt;(User.class), name, pwd);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;转账案例&quot;&gt;&lt;a href=&quot;#转账案例&quot; class=&quot;headerlink&quot; title=&quot;转账案例&quot;&gt;&lt;/a&gt;转账案例&lt;/h2&gt;&lt;p&gt;开发环境准备：jar包、c3p0.properties、db.properties(MyDbUtil工具类)&lt;/p&gt;
&lt;p&gt;
      
    
    </summary>
    
      <category term="JavaWeb" scheme="http://zsx-cup.top/categories/JavaWeb/"/>
    
    
      <category term="Application" scheme="http://zsx-cup.top/tags/Application/"/>
    
      <category term="Servlet" scheme="http://zsx-cup.top/tags/Servlet/"/>
    
  </entry>
  
  <entry>
    <title>Servlet</title>
    <link href="http://zsx-cup.top/2018/11/22/Servlet/"/>
    <id>http://zsx-cup.top/2018/11/22/Servlet/</id>
    <published>2018-11-22T12:56:41.000Z</published>
    <updated>2018-11-25T17:31:33.934Z</updated>
    
    <content type="html"><![CDATA[<p>servlet是一个运行在web服务上的java程序。servlet通常通过HTTP协议，接收并响应来自Web客户端的请求。</p><p>在用Eclipse进行web开发时，默认创建的Servlet有很多注释，不够简洁，可以在Eclipse中添加Servlet模板。 详见教程:<a href="https://blog.csdn.net/newmemory/article/details/54603786" target="_blank" rel="noopener">Eclipse for JavaEE中修改Servlet新建模板</a></p><h2 id="注册案例分析"><a href="#注册案例分析" class="headerlink" title="注册案例分析"></a>注册案例分析</h2><h3 id="初级代码"><a href="#初级代码" class="headerlink" title="初级代码"></a>初级代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        response.getWriter().append(<span class="string">"Served at: "</span>).append(request.getContextPath());</span><br><span class="line">        <span class="comment">//接收页面参数</span></span><br><span class="line">        String username = request.getParameter(<span class="string">"username"</span>);</span><br><span class="line">        String password = request.getParameter(<span class="string">"pwd"</span>);</span><br><span class="line">        <span class="comment">//操作数据</span></span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        String sql = <span class="string">"INSERT INTO user2 VALUES(null,?,?)"</span>;</span><br><span class="line">        <span class="keyword">int</span> i = runner.update(sql, username,password);</span><br><span class="line">        <span class="comment">//页面跳转</span></span><br><span class="line">        <span class="keyword">if</span>(i == <span class="number">1</span>)&#123;<span class="comment">//注册成功跳转登录页面</span></span><br><span class="line">            response.sendRedirect(<span class="string">"/webday07/login.html"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;<span class="comment">//注册不成功跳转注册页面</span></span><br><span class="line">            response.sendRedirect(<span class="string">"/webday07/register.html"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="三层代码分离"><a href="#三层代码分离" class="headerlink" title="三层代码分离"></a>三层代码分离</h3><p>代码分离步骤分析及代码示例：</p><ul><li>Servlet 接收页面参数，处理请求–&gt;调用 Service：new UserService().register（参数）</li><li>Service 处理事务：register（参数）–&gt;调用dao：new UserDao.addUser（参数）</li><li>Dao 执行sql语句: addUser（参数）–&gt;执行sql语句</li></ul><h4 id="Servlet-接收页面参数，处理请求"><a href="#Servlet-接收页面参数，处理请求" class="headerlink" title="Servlet 接收页面参数，处理请求"></a>Servlet 接收页面参数，处理请求</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        response.getWriter().append(<span class="string">"Served at: "</span>).append(request.getContextPath());</span><br><span class="line">        request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        <span class="comment">//接收页面参数</span></span><br><span class="line">        String username = request.getParameter(<span class="string">"username"</span>);</span><br><span class="line">        String password = request.getParameter(<span class="string">"pwd"</span>);</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setName(username);</span><br><span class="line">        user.setPassword(password);</span><br><span class="line">        <span class="comment">//操作数据</span></span><br><span class="line">        <span class="comment">//int i = dao.addUser(user);</span></span><br><span class="line">        <span class="keyword">int</span> i = service.register(user);</span><br><span class="line">        <span class="comment">//页面跳转</span></span><br><span class="line">        <span class="keyword">if</span>(i == <span class="number">1</span>)&#123;<span class="comment">//注册成功跳转登录页面</span></span><br><span class="line">            response.sendRedirect(<span class="string">"/webday07/login.html"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;<span class="comment">//注册不成功跳转注册页面</span></span><br><span class="line">            response.sendRedirect(<span class="string">"/webday07/register.html"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">    request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">    String from = <span class="string">"mike"</span>;</span><br><span class="line">    String to = <span class="string">"marry"</span>;</span><br><span class="line">    <span class="keyword">int</span> money = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 转账</span></span><br><span class="line">    <span class="keyword">int</span> i = userService.trans(from, to, money);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Service-处理事务"><a href="#Service-处理事务" class="headerlink" title="Service 处理事务"></a>Service 处理事务</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//转账，收付款</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    UserDao dao = <span class="keyword">new</span> UserDao();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">trans</span><span class="params">(String from, String to ,<span class="keyword">int</span> money)</span></span>&#123;</span><br><span class="line">        <span class="comment">//开启事务</span></span><br><span class="line">        <span class="comment">//收款</span></span><br><span class="line">        <span class="keyword">int</span> receMoney = dao.receMoney(from, money);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//付款</span></span><br><span class="line">        <span class="keyword">int</span> payMoney = dao.payMoney(to, receMoney);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="comment">//提交事务</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//register</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">register</span><span class="params">(User user)</span> <span class="keyword">throws</span> SQLException</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dao.addUser(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Dao-执行sql语句"><a href="#Dao-执行sql语句" class="headerlink" title="Dao 执行sql语句"></a>Dao 执行sql语句</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addUser</span><span class="params">(User user)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="comment">// 操作数据</span></span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        String sql = <span class="string">"INSERT INTO user2 VALUES(null,?,?)"</span>;</span><br><span class="line">        <span class="keyword">int</span> i = runner.update(sql, user.getName(), user.getPassword());</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 收款</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">receMoney</span><span class="params">(String from, <span class="keyword">int</span> money)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 付款</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">payMoney</span><span class="params">(String to, <span class="keyword">int</span> money)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Servlet生命周期"><a href="#Servlet生命周期" class="headerlink" title="Servlet生命周期"></a>Servlet生命周期</h2><ol><li>发送请求</li><li>解析请求: web.xml-&gt;url-&gt;name-&gt;class</li><li>实例化，反射</li><li>初始化，调用init（）方法，调用1次</li><li>服务，调用service（）方法</li><li>返回响应信息</li><li>销毁，调用destroy（）方法，Servlet正常关闭时调用</li></ol><p>如下图所示：</p><p><img src="/2018/11/22/Servlet/ServletLife.png" alt="ServletLife"></p><h2 id="ServletConfig"><a href="#ServletConfig" class="headerlink" title="ServletConfig"></a>ServletConfig</h2><p>ServletConfig这个对象在 Servlet 初始化时就传给 Servlet，所以从servlet对象中去取。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 初始化参数配置   web.xml中配置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>ConfigObj<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ConfigObj<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.demo.ConfigObj<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 初始化参数 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>name<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>lili<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br></pre></td></tr></table></figure></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    <span class="comment">// 获取ServletConfig对象</span></span><br><span class="line">    ServletConfig servletConfig = <span class="keyword">this</span>.getServletConfig();</span><br><span class="line">    <span class="comment">//获取初始化参数名，枚举</span></span><br><span class="line">    Enumeration&lt;String&gt; inits = servletConfig.getInitParameterNames();</span><br><span class="line">    String nextElement = inits.nextElement();</span><br><span class="line">    <span class="comment">//获取初始化参数对应的值</span></span><br><span class="line">    String initParameter = servletConfig.getInitParameter(nextElement);</span><br><span class="line">    System.out.println(nextElement+<span class="string">"---"</span>+initParameter);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ServletContext"><a href="#ServletContext" class="headerlink" title="ServletContext"></a>ServletContext</h2><p>ServletContext对象是Servlet三大（域）对象之一，每个Web应用程序都只有一个ServletContext对象，该对象是Web应用程序的全局对象，可以在整个Web应用中共享数据资源。Tomcat服务器在启动时，会自动创建一个ServletContext对象（域）。在关闭时，会自动销毁这个ServletContext对象。</p><h3 id="ServletContext对象的作用"><a href="#ServletContext对象的作用" class="headerlink" title="ServletContext对象的作用"></a>ServletContext对象的作用</h3><ol><li>获取全局的初始化参数</li><li>实现整个web应用程序中多个servlet之间的数据共享</li><li>实现转发:一般使用request对象来转发</li><li><p>获取文件的真实路径和项目名（路径），web项目中文件的真实路径有三种:</p><ul><li>第一种，src目录下的文件(src下的代码都在/WEB-INF/classes/目录下)，如/WEB-INF/classes/db.properties</li><li>第二种，WebContent目录下的文件(默认在根目录下)，如/db.properties</li><li>第三种，WEB-INF目录下的文件，如/WEB-INF/db.properties</li></ul></li></ol><h3 id="获取全局初始化参数"><a href="#获取全局初始化参数" class="headerlink" title="获取全局初始化参数"></a>获取全局初始化参数</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 全局初始化参数 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>content<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>servletContext<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取context对象</span></span><br><span class="line">ServletContext context = <span class="keyword">this</span>.getServletContext();</span><br><span class="line"><span class="comment">// 获取全局初始化参数</span></span><br><span class="line">Enumeration&lt;String&gt; names = context.getInitParameterNames();</span><br><span class="line">String name = names.nextElement();</span><br><span class="line">String value = context.getInitParameter(name);</span><br><span class="line">System.out.println(name+<span class="string">"---"</span>+value);<span class="comment">//content---servletContext</span></span><br></pre></td></tr></table></figure><h3 id="全局共享数据"><a href="#全局共享数据" class="headerlink" title="全局共享数据"></a>全局共享数据</h3><p>全局域对象context，实现整个web项目中多个servlet之间的数据共享（application域）。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 全局数据共享，域，范围，整个web项目，存储数据</span></span><br><span class="line">context.setAttribute(<span class="string">"name"</span>, <span class="string">"zsx"</span>);</span><br><span class="line"><span class="comment">// 获取域中的数据</span></span><br><span class="line">value = (String) context.getAttribute(<span class="string">"name"</span>);</span><br><span class="line">System.out.println(value);<span class="comment">//zsx</span></span><br></pre></td></tr></table></figure><h3 id="转发和重定向"><a href="#转发和重定向" class="headerlink" title="转发和重定向"></a>转发和重定向</h3><ul><li>转发：服务器内部的行为，1次请求，url不变，携带request。</li><li>重定向：2次请求，地址栏改变，不携带request。 url需要加项目名。</li><li>代码示例如下：</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 转发</span></span><br><span class="line">context.getRequestDispatcher(<span class="string">"/hello.html"</span>).forward(request,response);</span><br><span class="line"><span class="comment">// 重定向</span></span><br><span class="line">response.sendRedirect(<span class="string">"/webday07/hello.html"</span>);</span><br></pre></td></tr></table></figure><h3 id="获取文件真实路径及项目名"><a href="#获取文件真实路径及项目名" class="headerlink" title="获取文件真实路径及项目名"></a>获取文件真实路径及项目名</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取文件的真实路径 、输入流 、读取内容</span></span><br><span class="line"><span class="comment">// src目录下的文件</span></span><br><span class="line">String path1 = context.getRealPath(<span class="string">"/WEB-INF/classes/dbcp.properties"</span>);</span><br><span class="line"><span class="comment">// WebContent目录下的文件</span></span><br><span class="line">String path2 = context.getRealPath(<span class="string">"/dbcp.properties"</span>);</span><br><span class="line"><span class="comment">// WEB-INF目录下的文件</span></span><br><span class="line">String path3 = context.getRealPath(<span class="string">"/WEB-INF/dbcp.properties"</span>);</span><br><span class="line">System.out.println(path1);</span><br><span class="line"><span class="comment">// 通过真实路径获取输入流</span></span><br><span class="line">FileInputStream fileInputStream = <span class="keyword">new</span> FileInputStream(<span class="keyword">new</span> File(path1));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 直接获取输入流</span></span><br><span class="line">InputStream in = context.getResourceAsStream(<span class="string">"/WEB-INF/classes/dbcp.properties"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取项目名</span></span><br><span class="line">String contextPath = context.getContextPath();</span><br><span class="line"><span class="comment">// System.out.println(contextPath);// /webday07</span></span><br></pre></td></tr></table></figure><p>ServletContext代码示例：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    <span class="comment">// 获取context对象</span></span><br><span class="line">    ServletContext context = <span class="keyword">this</span>.getServletContext();</span><br><span class="line">    <span class="comment">// 获取全局初始化参数</span></span><br><span class="line">    Enumeration&lt;String&gt; names = context.getInitParameterNames();</span><br><span class="line">    String name = names.nextElement();</span><br><span class="line">    String value = context.getInitParameter(name);</span><br><span class="line">    <span class="comment">// System.out.println(name+"---"+value);//content---servletContext</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 全局数据共享，域，范围，整个web项目，存储数据</span></span><br><span class="line">    context.setAttribute(<span class="string">"name"</span>, <span class="string">"zsx"</span>);</span><br><span class="line">    <span class="comment">// 获取域中的数据</span></span><br><span class="line">    value = (String) context.getAttribute(<span class="string">"name"</span>);</span><br><span class="line">    <span class="comment">// System.out.println(value);//zsx</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 转发</span></span><br><span class="line">    <span class="comment">// context.getRequestDispatcher("/hello.html").forward(request,response);</span></span><br><span class="line">    <span class="comment">// 重定向</span></span><br><span class="line">    response.sendRedirect(<span class="string">"/webday07/hello.html"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取文件的真实路径 、输入流 、读取内容</span></span><br><span class="line">    <span class="comment">// src目录下的文件</span></span><br><span class="line">    String path1 = context.getRealPath(<span class="string">"/WEB-INF/classes/dbcp.properties"</span>);</span><br><span class="line">    <span class="comment">// WebContent目录下的文件</span></span><br><span class="line">    String path2 = context.getRealPath(<span class="string">"/dbcp.properties"</span>);</span><br><span class="line">    <span class="comment">// WEB-INF目录下的文件</span></span><br><span class="line">    String path3 = context.getRealPath(<span class="string">"/WEB-INF/dbcp.properties"</span>);</span><br><span class="line">    <span class="comment">// System.out.println(path1);</span></span><br><span class="line">    <span class="comment">// 通过真实路径获取输入流</span></span><br><span class="line">    FileInputStream fileInputStream = <span class="keyword">new</span> FileInputStream(<span class="keyword">new</span> File(path1));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 直接获取输入流</span></span><br><span class="line">    InputStream in = context.getResourceAsStream(<span class="string">"/WEB-INF/classes/dbcp.properties"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取项目名</span></span><br><span class="line">    String contextPath = context.getContextPath();</span><br><span class="line">    <span class="comment">// System.out.println(contextPath);// /webday07</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="HttpServletRequest"><a href="#HttpServletRequest" class="headerlink" title="HttpServletRequest"></a>HttpServletRequest</h2><h3 id="GET乱码问题"><a href="#GET乱码问题" class="headerlink" title="GET乱码问题"></a>GET乱码问题</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">    response.getWriter().append(<span class="string">"Served at: "</span>).append(request.getContextPath());</span><br><span class="line">    request.setCharacterEncoding(<span class="string">"UTF_8"</span>);<span class="comment">//只针对POST乱码问题</span></span><br><span class="line">    response.setCharacterEncoding(<span class="string">"UTF_8"</span>);</span><br><span class="line">    response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>);</span><br><span class="line">    <span class="comment">//GET乱码问题</span></span><br><span class="line">    String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">    <span class="comment">//解码</span></span><br><span class="line">    <span class="keyword">byte</span>[] bytes = name.getBytes(<span class="string">"iso8859-1"</span>);</span><br><span class="line">    <span class="comment">//编码</span></span><br><span class="line">    String nname = <span class="keyword">new</span> String(bytes,<span class="string">"utf-8"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="接收页面参数"><a href="#接收页面参数" class="headerlink" title="接收页面参数"></a>接收页面参数</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">    response.getWriter().append(<span class="string">"Served at: "</span>).append(request.getContextPath());</span><br><span class="line">    request.setCharacterEncoding(<span class="string">"UTF-8"</span>);<span class="comment">//只针对POST乱码问题</span></span><br><span class="line">    response.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">    response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>);</span><br><span class="line">    <span class="comment">//接收页面参数</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//接收单个参数</span></span><br><span class="line">        String email = request.getParameter(<span class="string">"email"</span>);</span><br><span class="line">        <span class="comment">//System.out.println(email);</span></span><br><span class="line">        <span class="comment">//接收多个参数</span></span><br><span class="line">        String[] hobby = request.getParameterValues(<span class="string">"hobby"</span>);</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * for (String string : hobby) &#123; System.out.println(string); &#125;</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">//接收一个map对象</span></span><br><span class="line">        MyUser user = <span class="keyword">new</span> MyUser();</span><br><span class="line">        Map&lt;String, String[]&gt; map = request.getParameterMap();</span><br><span class="line">        Set&lt;Entry&lt;String, String[]&gt;&gt; entrySet = map.entrySet();</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * for (Entry&lt;String, String[]&gt; entry : entrySet) &#123; String key =</span></span><br><span class="line"><span class="comment">         * entry.getKey(); String[] value = entry.getValue();</span></span><br><span class="line"><span class="comment">         * System.out.println(key+"---"+value); &#125;</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//需要jar包：commons-beanutils-1.8.3.jar|commons-logging-1.1.1.jar</span></span><br><span class="line">        BeanUtils.populate(user,map);</span><br><span class="line">        <span class="comment">//System.out.println(user);</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="作为一个域对象，作用范围一次请求"><a href="#作为一个域对象，作用范围一次请求" class="headerlink" title="作为一个域对象，作用范围一次请求"></a>作为一个域对象，作用范围一次请求</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestObj</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//作为一个域对象，作用范围一次请求</span></span><br><span class="line">        request.setAttribute(<span class="string">"name"</span>, <span class="string">"linda"</span>);<span class="comment">//向域中存储数据</span></span><br><span class="line">        String value = (String)request.getAttribute(<span class="string">"name"</span>);<span class="comment">//从域中取数据</span></span><br><span class="line">        <span class="comment">//System.out.println(value);//linda</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="转发"><a href="#转发" class="headerlink" title="转发"></a>转发</h3><p>转发的特点：</p><ol><li>url不变；</li><li>一次请求；</li><li>服务器内部的行为；</li><li>携带request域中的数据；</li><li>WEB-INF受保护，但转发可以访问。</li></ol><p>重定向的特点：</p><ol><li>两次请求；</li><li>地址栏改变；</li><li>不携带request域中的数据；</li><li>无法访问WEB-INF中的文件。</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//转发，转发会携带request域中的数据</span></span><br><span class="line">request.getRequestDispatcher(<span class="string">"/Demo"</span>).forward(request, response);</span><br><span class="line"><span class="comment">//request.getRequestDispatcher("/WEB-INF/hello.html").forward(request, response);</span></span><br><span class="line"><span class="comment">//response.sendRedirect("/webday08/WEB-INF/hello.html");//404</span></span><br></pre></td></tr></table></figure><h3 id="获取项目名"><a href="#获取项目名" class="headerlink" title="获取项目名"></a>获取项目名</h3><p>与context对象相似。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取项目名</span></span><br><span class="line">String contextPath = request.getContextPath();</span><br><span class="line">System.out.println(contextPath);<span class="comment">// /webday08</span></span><br></pre></td></tr></table></figure></p><h2 id="HttpServletResponse"><a href="#HttpServletResponse" class="headerlink" title="HttpServletResponse"></a>HttpServletResponse</h2><ol><li>重定向  指定页面  url   状态码302  +   location地址</li><li>写一个页面–&gt;响应–&gt;浏览器   html  字符流</li><li>图片   io    字节流                      </li><li>响应字节流和字符流不能同时使用，两个个方法互斥</li></ol><p>代码示例：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResponseObj</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        response.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>);</span><br><span class="line">        <span class="comment">// 字符流响应</span></span><br><span class="line">        <span class="comment">// response.getWriter().write("&lt;h1&gt;hello&lt;/h1&gt;");</span></span><br><span class="line">        <span class="comment">// sresponse.getWriter().write("&lt;h1&gt;你好&lt;/h1&gt;");</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 字节流响应</span></span><br><span class="line">        response.getOutputStream().write(<span class="string">"你好"</span>.getBytes());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;servlet是一个运行在web服务上的java程序。servlet通常通过HTTP协议，接收并响应来自Web客户端的请求。&lt;/p&gt;
&lt;p&gt;在用Eclipse进行web开发时，默认创建的Servlet有很多注释，不够简洁，可以在Eclipse中添加Servlet模板。 详见
      
    
    </summary>
    
      <category term="JavaWeb" scheme="http://zsx-cup.top/categories/JavaWeb/"/>
    
    
      <category term="Servlet" scheme="http://zsx-cup.top/tags/Servlet/"/>
    
  </entry>
  
  <entry>
    <title>Tomcat</title>
    <link href="http://zsx-cup.top/2018/11/21/Tomcat/"/>
    <id>http://zsx-cup.top/2018/11/21/Tomcat/</id>
    <published>2018-11-21T15:05:55.000Z</published>
    <updated>2018-11-24T17:09:15.332Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/2018/11/21/Tomcat/Tomcat.jpg" alt="Tomcat"><br>Tomcat服务器目前最为流行的web服务器，Tomcat服务器是Apache-Jarkarta开源项目中的一个子项目，是一个小型、轻量级的支持JSP和Servlet技术的Web服务器，也是初学者学习开发JSP应用的首选。</p><h2 id="Tomcat下载"><a href="#Tomcat下载" class="headerlink" title="Tomcat下载"></a>Tomcat下载</h2><p>Tomcat下载链接：<a href="http://tomcat.apache.org/whichversion.html" target="_blank" rel="noopener">Tomcat官方下载</a></p><p>Tomcat有安装版和解压版（绿色版）</p><ul><li>安装版，以.exe形式的安装包，双击安装到电脑上，用的比较少。</li><li>解压版，即绿色版，解压后直接使用，用的比较多。</li></ul><h2 id="Tomcat在eclipse中发布web项目"><a href="#Tomcat在eclipse中发布web项目" class="headerlink" title="Tomcat在eclipse中发布web项目"></a>Tomcat在eclipse中发布web项目</h2><ol><li>添加服务器运行环境<br> Window/Preferences/Server/Runtime Environmen/Add/Apache Tomcat v8.0</li><li>设置服务器安装目录<br> D:\tool\apache-tomcat-8.0.53</li><li>显示服务器<br> Window/Show View/Other/Server/Servers</li><li>修改Tomcat发布位置<br> 双击Tomcat v8.0 Server at localhost/Use Tomcat installtion</li><li>创建web项目<br> New/Project/Web/Dynamic Web Project/项目名称/Dynamic web module version 改为2.5<br> 右击Tomcat v8.0 Server at localhost/Add and Remove/添加上面建立的项目</li></ol><h2 id="用户登录应用实例"><a href="#用户登录应用实例" class="headerlink" title="用户登录应用实例"></a>用户登录应用实例</h2><ol><li>HTML登录页面。包括form action  method</li><li>创建服务器。接收页面的参数：name，passsword</li><li>查询数据库。拿到表单中的输入数据后，去数据库中查询。有数据 ，则登录成功，否则失败</li><li>跳转页面。登录成功跳转登录成功页面，登录失败则跳转登录页面</li><li>登录成功页面HTML</li></ol><p>核心代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 接收页面参数</span></span><br><span class="line">        String username = request.getParameter(<span class="string">"username"</span>);</span><br><span class="line">        String pwd = request.getParameter(<span class="string">"pwd"</span>);</span><br><span class="line">        <span class="comment">// 操作数据库 ，jar:驱动|c3p0|pool|dbutils</span></span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        String sql = <span class="string">"select * from user2 where name=? and password=?"</span>;</span><br><span class="line">        User user = runner.query(sql, <span class="keyword">new</span> BeanHandler&lt;User&gt;(User.class), username, pwd);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != user) &#123;<span class="comment">// 不为空表明登录成功</span></span><br><span class="line">            response.sendRedirect(<span class="string">"/webday06/hello.html"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            response.sendRedirect(<span class="string">"/webday06/login.html"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>登录页面:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>登录页面<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/webday06/MyServlet"</span> <span class="attr">method</span>=<span class="string">"get"</span>&gt;</span></span><br><span class="line">        用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>/&gt;</span> </span><br><span class="line">        密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"pwd"</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>/&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"登录"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>登录成功页面:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Insert title here<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>winter is coming!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    目前最为流行的Tomcat服务器是Apache-Jarkarta开源项目中的一个子项目，</span><br><span class="line">    是一个小型、轻量级的支持JSP和Servlet 技术的Web服务器，也是初学者学习开发JSP应用的首选。</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>User:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"User [name="</span> + name + <span class="string">", password="</span> + password + <span class="string">"]"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/2018/11/21/Tomcat/Tomcat.jpg&quot; alt=&quot;Tomcat&quot;&gt;&lt;br&gt;Tomcat服务器目前最为流行的web服务器，Tomcat服务器是Apache-Jarkarta开源项目中的一个子项目，是一个小型、轻量级的支持JSP和Ser
      
    
    </summary>
    
      <category term="JavaWeb" scheme="http://zsx-cup.top/categories/JavaWeb/"/>
    
    
      <category term="Tomcat" scheme="http://zsx-cup.top/tags/Tomcat/"/>
    
  </entry>
  
  <entry>
    <title>C3p0及事务</title>
    <link href="http://zsx-cup.top/2018/11/20/c3p0%E5%8F%8A%E4%BA%8B%E5%8A%A1/"/>
    <id>http://zsx-cup.top/2018/11/20/c3p0及事务/</id>
    <published>2018-11-20T15:14:10.000Z</published>
    <updated>2018-11-25T17:25:46.622Z</updated>
    
    <content type="html"><![CDATA[<h2 id="C3p0"><a href="#C3p0" class="headerlink" title="C3p0"></a>C3p0</h2><h3 id="导入jar包"><a href="#导入jar包" class="headerlink" title="导入jar包"></a>导入jar包</h3><pre><code>c3p0-0.9.1.2.jarcommons-dbutils-1.4.jarcommons-pool-1.5.6.jarmysql-connector-java-5.0.4-bin.jar</code></pre><h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 文件名 c3p0.properties</span></span><br><span class="line"><span class="comment">// 配置文件在src下，也可以建立Source Folder</span></span><br><span class="line">c3p0.driverClass=com.mysql.jdbc.Driver</span><br><span class="line">c3p0.jdbcUrl=jdbc:mysql:<span class="comment">///mydb1?characterEncoding=UTF-8</span></span><br><span class="line">c3p0.user=root</span><br><span class="line">c3p0.password=root</span><br></pre></td></tr></table></figure><h3 id="C3p0代码示例"><a href="#C3p0代码示例" class="headerlink" title="C3p0代码示例"></a>C3p0代码示例</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="comment">//获取数据库连接池对象</span></span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        <span class="comment">//创建工具类，参数：数据库连接池对象</span></span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        <span class="comment">//执行sql语句  封装结果集</span></span><br><span class="line">        String sql = <span class="string">"select * from user"</span>;</span><br><span class="line">        List&lt;User&gt; query = runner.query(sql, <span class="keyword">new</span> BeanListHandler&lt;User&gt;(User.class));</span><br><span class="line">        System.out.println(query);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结果集的实际映射是根据sql语句来进行映射的，不是按照表中原有名称进行映射的。代码示例如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> uid <span class="string">'id'</span>,<span class="keyword">NAME</span> <span class="string">'name'</span> <span class="keyword">from</span> <span class="keyword">user</span></span><br><span class="line"><span class="comment">--返回结果</span></span><br><span class="line"><span class="keyword">id</span>  <span class="keyword">name</span></span><br><span class="line"><span class="number">1</span>   tom</span><br><span class="line"><span class="number">2</span>   fox</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 原表user</span></span><br><span class="line">uid  <span class="keyword">NAME</span></span><br><span class="line"><span class="number">1</span>   tom</span><br><span class="line"><span class="number">2</span>   fox</span><br></pre></td></tr></table></figure><h3 id="条件查询"><a href="#条件查询" class="headerlink" title="条件查询"></a>条件查询</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="comment">//获取数据库连接池对象</span></span><br><span class="line">        ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">        <span class="comment">//创建工具类，参数：数据库连接池对象</span></span><br><span class="line">        QueryRunner runner = <span class="keyword">new</span> QueryRunner(dataSource);</span><br><span class="line">        <span class="comment">//执行sql语句，返回查询结果</span></span><br><span class="line">        String sql = <span class="string">"select * from user where uid=? and name=?"</span>;</span><br><span class="line">        User query = runner.query(sql, <span class="keyword">new</span> BeanHandler&lt;User&gt;(User.class), <span class="number">1</span>,<span class="string">"tom"</span>);</span><br><span class="line">        System.out.println(query);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><ol><li>一致性：事务中的SQL语句要么同时执行，要么都不执行。如代码示例中的价格一増一减，保持总和不变；如果中途出错，则都不变。</li><li>持久性：事务中的数据提交之后，可以持久存储查询。</li><li>原子性：不可再分。</li><li>隔离性：互不影响，避免混淆。</li></ol><p>代码示例：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo3</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 事务</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        PreparedStatement statement = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = MyDbUtil.getConnection();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 事务的开启：关闭mysql的事务自动提交</span></span><br><span class="line">            connection.setAutoCommit(<span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 上海减1000</span></span><br><span class="line">            String sql1 = <span class="string">"update orders set money=money+1000 where id=2 "</span>;</span><br><span class="line">            statement = connection.prepareStatement(sql1);</span><br><span class="line">            statement.executeUpdate();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// bug</span></span><br><span class="line">            <span class="comment">// int i = 1/0;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 广州加1000</span></span><br><span class="line">            String sql2 = <span class="string">"update orders set money=money-1000 where id=3 "</span>;</span><br><span class="line">            statement = connection.prepareStatement(sql2);</span><br><span class="line">            statement.executeUpdate();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 事务的关闭</span></span><br><span class="line">            connection.commit();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="comment">// 回滚</span></span><br><span class="line">            connection.rollback();</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;C3p0&quot;&gt;&lt;a href=&quot;#C3p0&quot; class=&quot;headerlink&quot; title=&quot;C3p0&quot;&gt;&lt;/a&gt;C3p0&lt;/h2&gt;&lt;h3 id=&quot;导入jar包&quot;&gt;&lt;a href=&quot;#导入jar包&quot; class=&quot;headerlink&quot; title=&quot;导入jar
      
    
    </summary>
    
      <category term="JavaWeb" scheme="http://zsx-cup.top/categories/JavaWeb/"/>
    
    
      <category term="c3p0" scheme="http://zsx-cup.top/tags/c3p0/"/>
    
  </entry>
  
  <entry>
    <title>数据库连接池</title>
    <link href="http://zsx-cup.top/2018/11/19/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/"/>
    <id>http://zsx-cup.top/2018/11/19/数据库连接池/</id>
    <published>2018-11-19T15:58:10.000Z</published>
    <updated>2018-11-25T17:26:00.147Z</updated>
    
    <content type="html"><![CDATA[<h2 id="数据库连接池"><a href="#数据库连接池" class="headerlink" title="数据库连接池"></a>数据库连接池</h2><p>数据库连接池（Data Base Connection Pooling，简称DBCP）是程序启动时建立足够的数据库连接，并将这些连接组成一个连接池，由程序动态地对池中的连接进行申请，使用，释放。<br>优点：</p><ul><li>节省创建连接与释放连接的性能消耗 </li><li>连接池中连接起到复用的作用，提高程序性能</li></ul><p>数据库连接池的运行机制：</p><ol><li>程序初始化时，创建连接池</li><li>使用时，向连接池申请可用连接</li><li>使用完毕，将连接返还给连接池</li><li>程序退出时，断开所有连接，并释放资源</li></ol><h2 id="数据库连接池的使用"><a href="#数据库连接池的使用" class="headerlink" title="数据库连接池的使用"></a>数据库连接池的使用</h2><p>首先，导入jar包：</p><pre><code>commons-dbcp-1.4.jarcommons-pool-1.5.6.jarmysql-connector-java-5.0.4-bin.jar</code></pre><h3 id="手动方式"><a href="#手动方式" class="headerlink" title="手动方式"></a>手动方式</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo1</span> </span>&#123;</span><br><span class="line"><span class="comment">//手动方式</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="comment">// 获取数据库连接池对象</span></span><br><span class="line">        BasicDataSource basicDataSource = <span class="keyword">new</span> BasicDataSource();</span><br><span class="line">        <span class="comment">// 设置四大参数</span></span><br><span class="line">        basicDataSource.setDriverClassName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">        basicDataSource.setUrl(<span class="string">"jdbc:mysql://localhost:3306/mydb"</span>);</span><br><span class="line">        basicDataSource.setUsername(<span class="string">"root"</span>);</span><br><span class="line">        basicDataSource.setPassword(<span class="string">"zsx"</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 获取连接</span></span><br><span class="line">        Connection connection = basicDataSource.getConnection();</span><br><span class="line">        <span class="comment">// 获取发送执行sql语句的PreparedStatement</span></span><br><span class="line">        String sql = <span class="string">"select * from user"</span>;</span><br><span class="line">        PreparedStatement statement = connection.prepareStatement(sql);</span><br><span class="line">        <span class="comment">// 执行sql语句，如果是查询返回结果集</span></span><br><span class="line">        ResultSet resultSet = statement.executeQuery();</span><br><span class="line">        <span class="comment">// 遍历查询返回的结果集</span></span><br><span class="line">        <span class="keyword">while</span> (resultSet.next()) &#123;</span><br><span class="line">            System.out.println(resultSet.getString(<span class="string">"uid"</span>));</span><br><span class="line">            System.out.println(resultSet.getString(<span class="string">"NAME"</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="半自动方式"><a href="#半自动方式" class="headerlink" title="半自动方式"></a>半自动方式</h3><p>配置文件<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 文件名 dbcp.properties</span></span><br><span class="line"><span class="comment">// 配置文件在src下，key不能改</span></span><br><span class="line">driverClassName=com.mysql.jdbc.Driver</span><br><span class="line">url=jdbc:mysql:<span class="comment">//localhost:3306/mydb?characterEncoding=UTF-8</span></span><br><span class="line">username=root</span><br><span class="line">password=zsx</span><br></pre></td></tr></table></figure></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo2</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 半自动方式</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//获取数据库连接工厂对象</span></span><br><span class="line">        BasicDataSourceFactory basicDataSourceFactory = <span class="keyword">new</span> BasicDataSourceFactory();</span><br><span class="line">        <span class="comment">//加载配置文件</span></span><br><span class="line">        FileInputStream inputStream = <span class="keyword">new</span> FileInputStream(<span class="keyword">new</span> File(<span class="string">"src/dbcp.properties"</span>));</span><br><span class="line">        Properties p = <span class="keyword">new</span> Properties();</span><br><span class="line">        p.load(inputStream);</span><br><span class="line">        <span class="comment">//创建数据源</span></span><br><span class="line">        DataSource dataSource = basicDataSourceFactory.createDataSource(p);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//获取连接</span></span><br><span class="line">        Connection connection = dataSource.getConnection();</span><br><span class="line">        <span class="comment">// 获取发送执行sql语句的PreparedStatement</span></span><br><span class="line">        String sql = <span class="string">"select * from user"</span>;</span><br><span class="line">        PreparedStatement statement = connection.prepareStatement(sql);</span><br><span class="line">        <span class="comment">// 执行sql语句，如果是查询返回结果集</span></span><br><span class="line">        ResultSet resultSet = statement.executeQuery();</span><br><span class="line">        <span class="comment">// 遍历查询返回的结果集</span></span><br><span class="line">        <span class="keyword">while</span> (resultSet.next()) &#123;</span><br><span class="line">            System.out.println(resultSet.getString(<span class="string">"uid"</span>));</span><br><span class="line">            System.out.println(resultSet.getString(<span class="string">"NAME"</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;数据库连接池&quot;&gt;&lt;a href=&quot;#数据库连接池&quot; class=&quot;headerlink&quot; title=&quot;数据库连接池&quot;&gt;&lt;/a&gt;数据库连接池&lt;/h2&gt;&lt;p&gt;数据库连接池（Data Base Connection Pooling，简称DBCP）是程序启动时建立足够的
      
    
    </summary>
    
      <category term="JavaWeb" scheme="http://zsx-cup.top/categories/JavaWeb/"/>
    
    
      <category term="DBCP" scheme="http://zsx-cup.top/tags/DBCP/"/>
    
  </entry>
  
  <entry>
    <title>JDBC快速入门</title>
    <link href="http://zsx-cup.top/2018/11/17/JDBC%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"/>
    <id>http://zsx-cup.top/2018/11/17/JDBC快速入门/</id>
    <published>2018-11-17T04:39:01.000Z</published>
    <updated>2018-11-24T17:11:42.924Z</updated>
    
    <content type="html"><![CDATA[<p>JDBC（Java Data Base Connectivity,java数据库连接）是一种用于执行SQL语句的Java API，可以为多种关系数据库提供统一访问，它由一组用Java语言编写的类和接口组成。JDBC提供了一种基准，据此可以构建更高级的工具和接口，使数据库开发人员能够编写数据库应用程序。</p><ul><li>Java DataBase Connectivity（java数据库连接）</li><li>组成包：java.sql.<em>;javax.sql.</em>;这两个包都包含在了JDK中。</li><li>还需要数据库的驱动，这些驱动就相当于对JDBC规范的实现</li></ul><h2 id="JDBC入门程序"><a href="#JDBC入门程序" class="headerlink" title="JDBC入门程序"></a>JDBC入门程序</h2><h3 id="JDBC创建流程"><a href="#JDBC创建流程" class="headerlink" title="JDBC创建流程"></a>JDBC创建流程</h3><ol><li>创建一个java项目</li><li><p>导入mysql的数据库驱动jar包：</p><p> 新建文件lib-&gt;将mysql-connector-java-5.0.4-bin.jar包粘贴到lib文件夹<br> -&gt;右击Bulid Path-&gt;Add To Bulid Path</p></li><li><p>注册驱动</p></li><li>建立与数据库的连接</li><li>获取发送和执行SQL语句的对象 Statement</li><li>执行SQL语句，获取查询结果集</li><li>如果执行的是查询语句，则遍历查询结果集</li><li>关闭资源</li></ol><h3 id="初级代码示例"><a href="#初级代码示例" class="headerlink" title="初级代码示例"></a>初级代码示例</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JdbcDemo1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//注册驱动</span></span><br><span class="line">        <span class="comment">//DriverManager.registerDriver(new Driver());//两次注册</span></span><br><span class="line">        Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">        <span class="comment">//建立连接</span></span><br><span class="line">        String url = <span class="string">"jdbc:mysql://localhost:3306/mydb"</span>;</span><br><span class="line">        String user = <span class="string">"root"</span>;</span><br><span class="line">        String password = <span class="string">"zsx"</span>;</span><br><span class="line">        Connection connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">        <span class="comment">//获取发送执行sql语句的对象statement</span></span><br><span class="line">        Statement statement = connection.createStatement();</span><br><span class="line">        <span class="comment">//发送执行sql语句，返回查询结果</span></span><br><span class="line">        String sql = <span class="string">"select * from user"</span>;<span class="comment">//查询</span></span><br><span class="line">        ResultSet resultSet = statement.executeQuery(sql);</span><br><span class="line">        <span class="comment">//如果是查询，需要遍历查询结果</span></span><br><span class="line">        <span class="keyword">while</span>(resultSet.next())&#123;</span><br><span class="line">            System.out.println(resultSet.getString(<span class="number">1</span>)); <span class="comment">//uid</span></span><br><span class="line">            System.out.println(resultSet.getString(<span class="number">2</span>)); <span class="comment">//NAME</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//关闭资源</span></span><br><span class="line">        resultSet.close();</span><br><span class="line">        statement.close();</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="更新代码示例"><a href="#更新代码示例" class="headerlink" title="更新代码示例"></a>更新代码示例</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JdbcDemo2</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 修订jdbc入门程序 </span></span><br><span class="line"><span class="comment">     * 1. 驱动注册两次问题：Class.forName() </span></span><br><span class="line"><span class="comment">     * 2. 四大参数硬编码问题 ：加载配置文件 </span></span><br><span class="line"><span class="comment">     * 3. 释放资源：异常处理</span></span><br><span class="line"><span class="comment">     * 异常不能正常关系</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String driverClass = <span class="keyword">null</span>;</span><br><span class="line">        String url = <span class="keyword">null</span>;</span><br><span class="line">        String name = <span class="keyword">null</span>;</span><br><span class="line">        String password = <span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">// 加载配置文件</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Properties p = <span class="keyword">new</span> Properties();</span><br><span class="line">            String conf = <span class="string">"C:/Users/Administrator/Desktop/code/JDBC/config/db.properties"</span>;</span><br><span class="line">            p.load(<span class="keyword">new</span> FileReader(conf));</span><br><span class="line">            driverClass = p.getProperty(<span class="string">"driverClass"</span>);</span><br><span class="line">            url = p.getProperty(<span class="string">"url"</span>);</span><br><span class="line">            name = p.getProperty(<span class="string">"name"</span>);</span><br><span class="line">            password = p.getProperty(<span class="string">"password"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        Statement statement = <span class="keyword">null</span>;</span><br><span class="line">        ResultSet resultSet = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 1.注册驱动</span></span><br><span class="line">            Class.forName(driverClass);</span><br><span class="line">            <span class="comment">// 2.建立连接</span></span><br><span class="line">            connection = DriverManager.getConnection(url, name, password);</span><br><span class="line">            <span class="comment">// 3.获取发送执行sql语句的statement对象</span></span><br><span class="line">            statement = connection.createStatement();</span><br><span class="line">            <span class="comment">// 4.执行sql语句</span></span><br><span class="line">            String sql = <span class="string">"select * from user"</span>;<span class="comment">// 查询</span></span><br><span class="line">            statement.executeQuery(sql);</span><br><span class="line">            <span class="comment">// 5.如果是查询，返回查询结果集，并遍历结果集</span></span><br><span class="line">            resultSet = statement.getResultSet();</span><br><span class="line">            <span class="keyword">while</span> (resultSet.next()) &#123;</span><br><span class="line">                System.out.println(resultSet.getString(<span class="string">"uid"</span>));</span><br><span class="line">                System.out.println(resultSet.getString(<span class="string">"NAME"</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// 6.关闭资源</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != resultSet) &#123;</span><br><span class="line">                    resultSet.close();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != statement) &#123;</span><br><span class="line">                    statement.close();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != connection) &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="读取配置文件"><a href="#读取配置文件" class="headerlink" title="读取配置文件"></a>读取配置文件</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetProperties</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 加载.properties配置文件的方法（相对路径）</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * //1. 获取类加载器 获取文件的输入流 InputStream in =</span></span><br><span class="line"><span class="comment">         * GetProperties.class.getClassLoader().getResourceAsStream(</span></span><br><span class="line"><span class="comment">         * "db.properties"); Properties p = new Properties(); p.load(in); String</span></span><br><span class="line"><span class="comment">         * url = p.getProperty("url"); System.out.println(url);</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. ResourceBundle 加载文件 参数文件的基名(不加文件后缀)</span></span><br><span class="line">        ResourceBundle bundle = ResourceBundle.getBundle(<span class="string">"db"</span>);</span><br><span class="line">        String url = bundle.getString(<span class="string">"url"</span>);</span><br><span class="line">        System.out.println(url);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="封装工具类"><a href="#封装工具类" class="headerlink" title="封装工具类"></a>封装工具类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyDbUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> String url = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">static</span> String name = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">static</span> String password = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 静态表代码块:加载配置文件，注册驱动</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="comment">// 加载配置文件</span></span><br><span class="line">        ResourceBundle bundle = ResourceBundle.getBundle(<span class="string">"db"</span>);</span><br><span class="line">        String driverClass = bundle.getString(<span class="string">"driverClass"</span>);</span><br><span class="line">        url = bundle.getString(<span class="string">"url"</span>);</span><br><span class="line">        name = bundle.getString(<span class="string">"name"</span>);</span><br><span class="line">        password = bundle.getString(<span class="string">"password"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 注册驱动</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(driverClass);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 与数据库建立连接</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 连接</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     *             数据库异常</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> DriverManager.getConnection(url, name, password);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 释放资源</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> connection</span></span><br><span class="line"><span class="comment">     *            连接</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> statement</span></span><br><span class="line"><span class="comment">     *            发送执行sql语句的对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> resultSet</span></span><br><span class="line"><span class="comment">     *            查询返回的结果集</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">release</span><span class="params">(Connection connection, Statement statement, ResultSet resultSet)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">null</span> != resultSet) &#123;</span><br><span class="line">                resultSet.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">null</span> != statement) &#123;</span><br><span class="line">                statement.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">null</span> != connection) &#123;</span><br><span class="line">                connection.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"before"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"test"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="测试工具类"><a href="#测试工具类" class="headerlink" title="测试工具类"></a>测试工具类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestUtil</span> </span>&#123;</span><br><span class="line">    Connection connection = <span class="keyword">null</span>;</span><br><span class="line">    Statement statement = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="comment">// 建立连接</span></span><br><span class="line">        connection = MyDbUtil.getConnection();</span><br><span class="line">        <span class="comment">// 获取发送执行sql语句的statement对象</span></span><br><span class="line">        statement = connection.createStatement();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 操作数据：查询、增加、删除</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 执行sql</span></span><br><span class="line">            String sql = <span class="string">"select * from user"</span>;</span><br><span class="line">            <span class="comment">// String sql = "insert into user values(3, 'jack')";</span></span><br><span class="line">            <span class="comment">// String sql = "delete from user where uid=3";</span></span><br><span class="line">            ResultSet resultSet = statement.executeQuery(sql);</span><br><span class="line">            <span class="comment">// statement.executeUpdate(sql);</span></span><br><span class="line">            <span class="comment">// 处理查询返回的结果集，对结果进行封装</span></span><br><span class="line">            ArrayList&lt;User&gt; userList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            <span class="keyword">while</span> (resultSet.next()) &#123;</span><br><span class="line">                <span class="comment">// System.out.println(resultSet.getString("uid"));</span></span><br><span class="line">                <span class="comment">// System.out.println(resultSet.getString("NAME"));</span></span><br><span class="line">                User user = <span class="keyword">new</span> User();</span><br><span class="line">                user.setUid(resultSet.getString(<span class="string">"uid"</span>));</span><br><span class="line">                user.setName(resultSet.getString(<span class="string">"Name"</span>));</span><br><span class="line">                userList.add(user);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(userList);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 释放资源</span></span><br><span class="line">            MyDbUtil.release(connection, statement, <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * prepareStatement </span></span><br><span class="line"><span class="comment">     * 1. 有缓存区，所以效率更高 </span></span><br><span class="line"><span class="comment">     * 2. 有缓存区，更安全，防止sql注入(1=1)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPre</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        Connection conn = MyDbUtil.getConnection();</span><br><span class="line">        String sql = <span class="string">"select * from user where uid = ? and NAME = ?"</span>;</span><br><span class="line">        PreparedStatement ps = conn.prepareStatement(sql);</span><br><span class="line">        ps.setString(<span class="number">1</span>, <span class="string">"1"</span>);</span><br><span class="line">        ps.setString(<span class="number">2</span>, <span class="string">"tom"</span>);</span><br><span class="line">        ResultSet resultSet = ps.executeQuery();</span><br><span class="line">        System.out.println(resultSet);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>创建的User对象如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String uid;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> uid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUid</span><span class="params">(String uid)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.uid = uid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"User [uid="</span> + uid + <span class="string">", name="</span> + name + <span class="string">"]"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>中文乱码解决办法</strong>：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url=jdbc:mysql:<span class="comment">//localhost:3306/mydb?characterEncoding=utf8</span></span><br></pre></td></tr></table></figure></p><h2 id="常用对象：类或接口"><a href="#常用对象：类或接口" class="headerlink" title="常用对象：类或接口"></a>常用对象：类或接口</h2><ol><li>DriverManger：<br>注册驱动；<br>获取与数据库的链接</li><li>Connection：<br>获取发送执行sql语句的statement对象</li><li>Statement：<br>向数据库发送并执行具体的SQL语句</li><li>PreparedStatement：</li></ol><ul><li>需要预编译以及需要参数；</li><li>有缓存区，效率更高；</li><li>有缓存区，更安全，防止了sql注入（1=1）；</li><li>语句中的参数可以使用占位符(?)。</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;JDBC（Java Data Base Connectivity,java数据库连接）是一种用于执行SQL语句的Java API，可以为多种关系数据库提供统一访问，它由一组用Java语言编写的类和接口组成。JDBC提供了一种基准，据此可以构建更高级的工具和接口，使数据库开发
      
    
    </summary>
    
      <category term="JavaWeb" scheme="http://zsx-cup.top/categories/JavaWeb/"/>
    
    
      <category term="JDBC" scheme="http://zsx-cup.top/tags/JDBC/"/>
    
  </entry>
  
  <entry>
    <title>北京主要景点参观指南</title>
    <link href="http://zsx-cup.top/2018/11/16/%E5%8C%97%E4%BA%AC%E4%B8%BB%E8%A6%81%E6%99%AF%E7%82%B9%E5%8F%82%E8%A7%82%E6%8C%87%E5%8D%97/"/>
    <id>http://zsx-cup.top/2018/11/16/北京主要景点参观指南/</id>
    <published>2018-11-16T15:31:01.000Z</published>
    <updated>2018-11-25T17:43:41.623Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/2018/11/16/北京主要景点参观指南/Bejing.jpg" alt="Bejing.jpg"></p><ol><li><strong>景点</strong>：开放时间，参观耗时门票，交通</li><li><strong>住宿</strong>：酒店，民宿（适合人多）</li><li><strong>注意事项</strong>：交通方式，北京特产，其他</li></ol><h2 id="北京主要景点清单"><a href="#北京主要景点清单" class="headerlink" title="北京主要景点清单"></a>北京主要景点清单</h2><ol><li><strong>天安门</strong>：毛主席纪念堂、天安门城楼、故宫、人民大会堂、中国国家博物馆</li><li><strong>故宫依次向北</strong>：景山公园、北海公园、后海、奥体中心</li><li><strong>皇家园林</strong>：北大、清华、圆明园、颐和园</li><li><strong>距离最远</strong>：八达岭长城、十三陵</li><li><strong>位置靠南</strong>：天坛</li></ol><p>下面简单说明各景点的开放时间、门票价格、参观耗时、交通等。以下内容中的蓝色字体为链接，点击可查看详情。</p><h2 id="天安门：毛主席纪念堂-天安门城楼-故宫"><a href="#天安门：毛主席纪念堂-天安门城楼-故宫" class="headerlink" title="天安门：毛主席纪念堂|天安门城楼|故宫"></a>天安门：毛主席纪念堂|天安门城楼|故宫</h2><ul><li>乘地铁1号线至<strong>天安门西站</strong>或<strong>天安门东站</strong>下车即达</li><li>参观天安门最好携带身份证，随机查证；参观毛主席纪念堂和天安门城楼严禁携带任何大包小包、相机、液体等入场。如带有上述物需到存包处寄存。</li><li>参观顺序：人民大会堂-&gt;毛主席纪念堂-&gt;天安门城楼(单向参观)，国家博物馆酌时间和喜好参观</li></ul><h3 id="1-毛主席纪念堂："><a href="#1-毛主席纪念堂：" class="headerlink" title="1. 毛主席纪念堂："></a>1. <a href="https://baike.baidu.com/item/%E6%AF%9B%E4%B8%BB%E5%B8%AD%E7%BA%AA%E5%BF%B5%E5%A0%82/727003?fr=aladdin" target="_blank" rel="noopener"><strong>毛主席纪念堂</strong></a>：</h3><p><img src="/2018/11/16/北京主要景点参观指南/chairman%20mao.jpg" alt="image"></p><p>毛主席纪念堂于2017年3月1日至8月31日进行施工，最早于2017年9月1日重新对外开放。</p><ul><li>开放时间：周二至周日8:00—12:00，特殊活动及节假日除外。</li><li>门票价格：免门票，自愿献花，10元每支。</li><li>参观耗时：半小时至一小时不等，主要是排队时间不确定。</li></ul><h3 id="2-天安门城楼："><a href="#2-天安门城楼：" class="headerlink" title="2. 天安门城楼："></a>2. <a href="https://baike.baidu.com/item/%E5%A4%A9%E5%AE%89%E9%97%A8/63708?fr=aladdin&amp;fromid=9821514&amp;fromtitle=%E5%A4%A9%E5%AE%89%E9%97%A8%E5%9F%8E%E6%A5%BC#8" target="_blank" rel="noopener"><strong>天安门城楼</strong></a>：</h3><p><img src="/2018/11/16/北京主要景点参观指南/tian%20an%20men.jpg" alt="image"></p><ul><li>开放时间：周一至周日，8:30-17:00(16:30止票)，特殊活动除外。</li><li>门票价格：成人15元，学生、老人5元。</li><li>参观耗时：半小时。</li></ul><h3 id="3-故宫："><a href="#3-故宫：" class="headerlink" title="3. 故宫："></a>3. <a href="http://www.dpm.org.cn/Home.html" target="_blank" rel="noopener"><strong>故宫</strong></a>：</h3><p><img src="/2018/11/16/北京主要景点参观指南/gu%20gong.jpg" alt="image"></p><p>故宫目前试行每日限流8万人，可提前登录故宫博物院官网购票，凭身份证在午门入口直接入园（<a href="http://gugong.228.com.cn/OrderSingle/PersonInfo" target="_blank" rel="noopener">故宫博物院门票预售系统</a>）</p><ul><li>开放时间：8:30-16:00，周一下午闭馆，节假日及暑假(7月1日至8月31日)除外。</li><li>门票价格：60元/人；学生票半价，60岁以上老人凭身份证原件半价优惠。</li><li>参观耗时：两小时至半天不等。</li><li>参观路线：<a href="http://www.mafengwo.cn/travel-news/217531.html" target="_blank" rel="noopener">故宫两小时最佳游览路线</a></li></ul><h3 id="4-人民大会堂："><a href="#4-人民大会堂：" class="headerlink" title="4. 人民大会堂："></a>4. <a href="https://baike.baidu.com/item/%E4%BA%BA%E6%B0%91%E5%A4%A7%E4%BC%9A%E5%A0%82/29472?fr=aladdin" target="_blank" rel="noopener"><strong>人民大会堂</strong></a>：</h3><p><img src="/2018/11/16/北京主要景点参观指南/re%20min.jpg" alt="image"></p><ul><li>开放时间：7月、8月：7:30至16:00，法定节日延长开放时间。</li><li>门票价格：成人30元，学生、老人15元。</li><li>参观耗时：1-2小时。</li><li>游客参观需按顺序从东门入场。请勿带包，大会堂南门东侧设有存包处。</li></ul><h3 id="5-中国家博物馆："><a href="#5-中国家博物馆：" class="headerlink" title="5. 中国家博物馆："></a>5. <a href="https://baike.baidu.com/item/%E4%B8%AD%E5%9B%BD%E5%9B%BD%E5%AE%B6%E5%8D%9A%E7%89%A9%E9%A6%86" target="_blank" rel="noopener"><strong>中国家博物馆</strong></a>：</h3><ul><li>开放时间：9：00-17：00（周一闭馆）。</li><li>门票价格：免门票，凭身份证取票。</li><li>参观耗时：2-3小时。</li></ul><h2 id="景山-北海-后海"><a href="#景山-北海-后海" class="headerlink" title="景山|北海|后海"></a>景山|北海|后海</h2><p>景山公园万春亭可以俯瞰故宫和北海，北海又紧邻后海</p><h3 id="1-景山公园：俯瞰故宫和北海"><a href="#1-景山公园：俯瞰故宫和北海" class="headerlink" title="1. 景山公园：俯瞰故宫和北海"></a>1. <a href="https://baike.baidu.com/item/%E6%99%AF%E5%B1%B1%E5%85%AC%E5%9B%AD/63814#7" target="_blank" rel="noopener"><strong>景山公园</strong></a>：俯瞰故宫和北海</h3><p><img src="/2018/11/16/北京主要景点参观指南/jing%20shan%20park.jpg" alt="image"></p><p>如果你去过故宫，或者是没有时间参观故宫，景山公园都将是一个不错的选择。景山公园万春亭北面的地面上有一个“北京城南北中轴线”黄铜圆盘，标志着景山公园万春亭坐落在明清北京城的中轴线上。</p><p>站在万春亭，往南俯瞰故宫，映入眼帘的是，红色的宫墙，黄色的琉璃瓦，各级宫殿高低起伏沿南北中轴线鳞次栉比对称排列。往北可以望见坐落在中轴线上的钟鼓楼以及远方奥体中心这几年新建的北京奥林匹克塔。往西可以瞥见北海和白塔，顿时唤醒你往昔的记忆。</p><ul><li>开放时间：夏季6:30-21:00，冬季6:30-20:00</li><li>门票价格：15元（学生票5元）</li><li>参观耗时：1-2h</li><li>交通：乘地铁1号线至天安门东站下车，步行或骑共享单车很快到达。</li></ul><h3 id="2-北海公园：让我们荡起双桨"><a href="#2-北海公园：让我们荡起双桨" class="headerlink" title="2. 北海公园：让我们荡起双桨"></a>2. <a href="https://baike.baidu.com/item/%E5%8C%97%E6%B5%B7%E5%85%AC%E5%9B%AD" target="_blank" rel="noopener"><strong>北海公园</strong></a>：让我们荡起双桨</h3><ul><li>开放时间：06:30~20:00</li><li>门票价格：旺季10，淡季5</li><li>参观耗时：1-2h</li><li>交通：乘地铁8号线至什刹海下车，步行850m到达。</li></ul><h3 id="3-后海：晚上酒吧很热闹"><a href="#3-后海：晚上酒吧很热闹" class="headerlink" title="3. 后海：晚上酒吧很热闹"></a>3. <a href="https://baike.baidu.com/item/%E5%90%8E%E6%B5%B7/6037?fr=aladdin" target="_blank" rel="noopener"><strong>后海</strong></a>：晚上酒吧很热闹</h3><p><img src="/2018/11/16/北京主要景点参观指南/hou%20hai.jpg" alt="图片源自网络"></p><ul><li>开放时间：全天</li><li>门票价格：免门票</li><li>参观耗时：1-2h</li><li>交通：乘地铁8号线至什刹海下车，步行即达。</li></ul><h2 id="奥体中心：鸟巢-水立方"><a href="#奥体中心：鸟巢-水立方" class="headerlink" title="奥体中心：鸟巢|水立方"></a>奥体中心：鸟巢|水立方</h2><p>乘地铁8号线在奥体中心站下车即达。<br>鸟巢水立方可远观而不可亵玩，进入场馆内画风突变，找不到看点。</p><p><a href="https://baike.baidu.com/item/%E5%9B%BD%E5%AE%B6%E4%BD%93%E8%82%B2%E5%9C%BA/1297632?fr=aladdin&amp;fromid=4247529&amp;fromtitle=%E9%B8%9F%E5%B7%A2" target="_blank" rel="noopener"><strong>鸟巢</strong></a>：夜晚有灯光，或许会更美</p><p><img src="/2018/11/16/北京主要景点参观指南/niao%20chao.jpg" alt="image"></p><ul><li>开放时间：开放时间：9:00-21:00。</li><li>门票价格：成人50元，学生、老人25元。</li><li>参观耗时：0.5小时。</li></ul><p><a href="https://baike.baidu.com/item/%E5%9B%BD%E5%AE%B6%E6%B8%B8%E6%B3%B3%E4%B8%AD%E5%BF%83?fromtitle=%E6%B0%B4%E7%AB%8B%E6%96%B9&amp;fromid=1718643" target="_blank" rel="noopener"><strong>水立方</strong></a>：夜晚有灯光，或许会更美</p><p><img src="/2018/11/16/北京主要景点参观指南/shui%20li%20fang.jpg" alt="image"></p><ul><li>开放时间：开放时间：8:30-16:00，特殊活动及节假日除外。</li><li>门票价格：成人30元，学生、老人15元。</li><li>参观耗时：0.5小时。</li></ul><h2 id="北大-清华-圆明园-颐和园"><a href="#北大-清华-圆明园-颐和园" class="headerlink" title="北大|清华|圆明园|颐和园"></a>北大|清华|圆明园|颐和园</h2><ul><li>北大、清华、圆明园、颐和园相邻，乘地铁4号线至北京大学东门站下，步行即达北大东门，参观完北大，从北大西门出来，步行或骑共享单车很快到达清华西门，再往前走就是圆明园南门。</li><li>圆明园东门不远有公交站，出来步行、共享单车到达，乘车前往下一个目的地。</li><li>北大西门至颐和园：584路/332路 </li><li>清华至颐和园：取决于<br>从清华哪个门出来 </li></ul><h3 id="1-北京大学：未名湖-北大西门"><a href="#1-北京大学：未名湖-北大西门" class="headerlink" title="1. 北京大学：未名湖-北大西门"></a>1. 北京大学：未名湖-北大西门</h3><p><img src="/2018/11/16/北京主要景点参观指南/bo%20ya%20ta.jpg" alt="image"></p><ul><li>参观入口： 北京大学东门</li><li>开放时间：8:30-16:30(不限时间)</li><li>门票价格：免门票</li><li>参观耗时：1-2h</li></ul><h3 id="2-清华大学：清华西门-清华园"><a href="#2-清华大学：清华西门-清华园" class="headerlink" title="2. 清华大学：清华西门-清华园"></a>2. 清华大学：清华西门-清华园</h3><p><img src="/2018/11/16/北京主要景点参观指南/qing%20hua.jpg" alt="image"></p><ul><li>参观入口： 清华大学西门</li><li>开放时间：上午8:30-16:30(不限时间)</li><li>门票价格：免门票</li><li>参观耗时：1-2h</li></ul><h3 id="3-圆明园：西洋楼遗址"><a href="#3-圆明园：西洋楼遗址" class="headerlink" title="3. 圆明园：西洋楼遗址"></a>3. 圆明园：西洋楼遗址</h3><p><img src="/2018/11/16/北京主要景点参观指南/yuan%20ming%20yuan.jpg" alt="image"></p><ul><li>开放时间：6:30-18:00</li><li>门票价格：10元/人，学生老人半价，西洋楼遗址门票15元/人，学生老人半价。</li><li>参观耗时：1-2小时</li><li>参观路线：<a href="http://mp.weixin.qq.com/s/nBZmGCVyeVRG8UaBWkfosw" target="_blank" rel="noopener">圆明园官方游园指南</a></li></ul><h3 id="4-颐和园：万寿山-昆明湖-十七孔桥"><a href="#4-颐和园：万寿山-昆明湖-十七孔桥" class="headerlink" title="4. 颐和园：万寿山|昆明湖|十七孔桥"></a>4. 颐和园：万寿山|昆明湖|十七孔桥</h3><ul><li>开放时间：6:30—18:00</li><li>门票价格：30元/张（旺季），20元/张（淡季）学生票半价</li><li>参观耗时：1-2小时</li></ul><h2 id="八达岭长城-十三陵之定陵"><a href="#八达岭长城-十三陵之定陵" class="headerlink" title="八达岭长城|十三陵之定陵"></a>八达岭长城|十三陵之定陵</h2><p> 八达岭长城在延庆，十三陵在昌平，都在北京西北方向，顺路。</p><h3 id="1-八达岭长城："><a href="#1-八达岭长城：" class="headerlink" title="1. 八达岭长城："></a>1. <a href="https://baike.baidu.com/item/%E5%85%AB%E8%BE%BE%E5%B2%AD%E9%95%BF%E5%9F%8E" target="_blank" rel="noopener"><strong>八达岭长城</strong></a>：</h3><p><img src="/2018/11/16/北京主要景点参观指南/chang%20cheng.jpg" alt="image"></p><ul><li>开放时间：6:30-19:00</li><li>门票价格：旺季40元，淡季35元，学生半价。</li><li>参观耗时：3-4小时</li><li>交通：2号线积水潭站A口（西北口）或B口（东南口）出站，步行到德胜门正后方乘877路公交直达八达岭长城，现金票价13元，刷卡6.5元，耗时2.5小时左右，如果不幸遇见高速堵车，路上将耗时三四个小时。</li></ul><h3 id="2-十三陵之定陵：地宫"><a href="#2-十三陵之定陵：地宫" class="headerlink" title="2. 十三陵之定陵：地宫"></a>2. <a href="https://baike.baidu.com/item/%E6%98%8E%E5%AE%9A%E9%99%B5/878416?fr=aladdin&amp;fromid=45384&amp;fromtitle=%E5%AE%9A%E9%99%B5" target="_blank" rel="noopener">十三陵之定陵</a>：地宫</h3><ul><li>开放时间：旺季8:00-17:30（停票时间）</li><li>门票价格：旺季60元/张，学生老人半价</li><li>参观耗时：1-2小时</li><li>交通：2号线积水潭站A口（西北口）或B口（东南口）出站，步行到德胜门正后方乘坐872路公交车直达定陵，耗时1.5小时。</li></ul><h2 id="天坛"><a href="#天坛" class="headerlink" title="天坛"></a><a href="https://baike.baidu.com/item/%E5%A4%A9%E5%9D%9B%E5%85%AC%E5%9B%AD/3973437?fromtitle=%E5%A4%A9%E5%9D%9B&amp;fromid=2820294" target="_blank" rel="noopener"><strong>天坛</strong></a></h2><p><img src="/2018/11/16/北京主要景点参观指南/tian%20tan.jpg" alt="image"></p><ul><li>开放时间：6:00-17:30</li><li>门票价格：15.00元</li><li>参观耗时：1-2h</li><li>交通：乘地铁5号线至天坛东门下车，步行即达。</li></ul><h2 id="住宿：可考虑酒店或民宿"><a href="#住宿：可考虑酒店或民宿" class="headerlink" title="住宿：可考虑酒店或民宿"></a>住宿：可考虑酒店或民宿</h2><ul><li>考虑到有老人和小孩一同出行，建议选择离北京站较近的房源。便于出行，避免在地铁上花费太多时间，从而留出更多的参观时间。</li><li>房源非常多，价格因地段不一。基于上述原则，筛选出下面所列的酒店或民宿。不过，无需拘泥于这些酒店，而应根据具体情况，如老人小孩身体状况、景点位置、天气等做出合适选择。</li></ul><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><h3 id="1-交通方式"><a href="#1-交通方式" class="headerlink" title="1. 交通方式"></a>1. 交通方式</h3><p>帝都交通比较发达，可供选择的交通方式较多。</p><ol><li><strong>地铁</strong>：四通八达，准时准点，时间有保证，自动售票机比较方便，自备现金。</li><li><strong>公交</strong>：到达时间不确定，不过仍是去八达岭和十三陵的不二之选。另外，公交卡买票半价，办卡押金可退。</li><li><strong>共享单车</strong>：解决从目的地到地铁站或者公交站的最后一公里。如摩拜单车、小黄车、哈罗单车等</li></ol><ul><li>哈罗单车，支付宝蚂蚁信用700分以上可免押金骑。</li><li>摩拜单车，微信扫码骑车，如使用摩拜客户端可用支付宝花呗交押金。</li><li>小黄车，支付宝扫码骑车，可用花呗支付。</li></ul><ol start="4"><li><strong>滴滴</strong>：如果天气很热、人困马乏，滴滴将是一种不错的选择，目前13元起步。</li></ol><h3 id="2-北京特产"><a href="#2-北京特产" class="headerlink" title="2. 北京特产"></a>2. 北京特产</h3><p>关于购买北京特产，基本上任意一家大型超市都有，而且种类价格都差不太多。</p><h3 id="3-其他"><a href="#3-其他" class="headerlink" title="3. 其他"></a>3. 其他</h3><ol><li>保管好手机钱包等贵重物品，小心人多手杂。</li><li>前往八达岭长城，路途遥远，请自备干粮。</li><li>从八达岭返回的公交上人比较多，耐心等待。</li><li>如果你是研究生还在为不能享受门票半价优惠不平衡，不妨尝试一下学生卡而非学生证，亲测有效，故宫没试过。</li></ol><hr><h2 id="参观时间及路线规划（2017年暑假）"><a href="#参观时间及路线规划（2017年暑假）" class="headerlink" title="参观时间及路线规划（2017年暑假）"></a>参观时间及路线规划（2017年暑假）</h2><p> 进京时间：8.3（周四）12:04；离京时间：8.6（周日）13:06。</p><h4 id="8-3（周四）下午及晚上：景山公园-后海-奥体中心"><a href="#8-3（周四）下午及晚上：景山公园-后海-奥体中心" class="headerlink" title="8.3（周四）下午及晚上：景山公园|后海|奥体中心"></a>8.3（周四）下午及晚上：景山公园|后海|奥体中心</h4><ul><li>后海和奥体中心开放至晚上，后海酒吧街晚上灯红酒绿很是热闹，奥体中心的鸟巢、水立方、玲珑塔及北京奥利匹克塔夜晚有灯光，看起来很漂亮。</li><li>景山公园地理位置优越，地处故宫后门对面，去往景山公园的路上可以看到美丽的故宫角楼。</li><li>进入景山公园登上万春亭，向南可以俯瞰故宫：红色的宫墙，黄色的琉璃瓦，各级宫殿高低起伏沿南北中轴线鳞次栉比对称排列。向北可以看到钟鼓楼以及远方奥体中心的玲珑塔。向西可以瞥见北海和白塔，满满的都是回忆。</li></ul><h4 id="8-4（周五）全天：毛主席纪念堂-天安门城楼-故宫-北大-清华-颐和园"><a href="#8-4（周五）全天：毛主席纪念堂-天安门城楼-故宫-北大-清华-颐和园" class="headerlink" title="8.4（周五）全天：毛主席纪念堂|天安门城楼|故宫|北大|清华|颐和园"></a>8.4（周五）全天：毛主席纪念堂|天安门城楼|故宫|北大|清华|颐和园</h4><ul><li>毛主席纪念堂因施工最早于2017年9月1日开放参观。</li><li>登天安门城楼不允许携带任何大包小包、液体等。</li><li>故宫目前每日限流8万人，如果参观故宫，提前在故宫博物院官网购票。如去过景山公园，故宫可放在后边有时间再参观，而且有些宫殿并不开放，比如金銮殿，只能在门口隔着人群远观。</li><li>北大清华排队参观的人通常比较多，特别是节假日或周末。</li><li>有所取舍，清华北大人多，去圆明园，颐和园看看也不错。参观圆明园如果从南门进东门出，不要错过了黑天鹅和全景模型。时间紧张，这次参观不完，且为下次留作念想。</li></ul><h4 id="8-5（周六）全天：八达岭长城、定陵"><a href="#8-5（周六）全天：八达岭长城、定陵" class="headerlink" title="8.5（周六）全天：八达岭长城、定陵"></a>8.5（周六）全天：八达岭长城、定陵</h4><ul><li>八达岭长城地处北京西北边缘，乘公交需要2小时左右，如果高速堵车耗时更长，所以能早起最好。八达岭长城分为南北两支，南边那支稍短，北边那支较长，可酌体力和时间选择。</li><li>十三陵其实非常大，如果时间允许，八达岭长城出口有公交直达十三陵景区。可选择去定陵，而且定陵有地宫。</li></ul><h4 id="8-6（周日）上午"><a href="#8-6（周日）上午" class="headerlink" title="8.6（周日）上午"></a>8.6（周日）上午</h4><p> 上午的时间比较短暂，可休整一下，就近逛逛王府井或天坛公园，晴天里的天坛在蓝天白云的衬托下格外漂亮。或者去超市购买特产，准备火车上吃的食物之类。预祝各位旅途愉快。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/2018/11/16/北京主要景点参观指南/Bejing.jpg&quot; alt=&quot;Bejing.jpg&quot;&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;景点&lt;/strong&gt;：开放时间，参观耗时门票，交通&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;住宿&lt;/stron
      
    
    </summary>
    
      <category term="Travel" scheme="http://zsx-cup.top/categories/Travel/"/>
    
    
      <category term="北京" scheme="http://zsx-cup.top/tags/%E5%8C%97%E4%BA%AC/"/>
    
  </entry>
  
  <entry>
    <title>Machine Learning-Coursera</title>
    <link href="http://zsx-cup.top/2018/11/15/Machine-Learning-Coursera/"/>
    <id>http://zsx-cup.top/2018/11/15/Machine-Learning-Coursera/</id>
    <published>2018-11-15T14:19:49.000Z</published>
    <updated>2018-11-15T14:49:40.901Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/2018/11/15/Machine-Learning-Coursera/cover_machine_learning.jpg" alt="cover_machine_learning"></p><blockquote><p>Source: <a href="https://www.coursera.org/learn/machine-learning/home/welcome" target="_blank" rel="noopener">Coursera: Machine Learning</a> &amp; Stanford-CS229A-Fall2011</p></blockquote><h2 id="L1-机器学习概述：应用、定义、分类"><a href="#L1-机器学习概述：应用、定义、分类" class="headerlink" title="L1 机器学习概述：应用、定义、分类"></a>L1 机器学习概述：应用、定义、分类</h2><p>机器学习分类：监督学习，非监督学习。其他如，增强学习，推荐系统等。</p><ul><li>监督学习：有标签；</li><li>非监督学习：无标签。</li></ul><h3 id="监督学习（有标签）"><a href="#监督学习（有标签）" class="headerlink" title="监督学习（有标签）"></a>监督学习（有标签）</h3><ul><li>回归：预测连续结果，如房价、股价等；</li><li>分类：预测离散结果，如是否患有癌症、是否是垃圾邮件等。</li></ul><h3 id="非监督学习（无标签）"><a href="#非监督学习（无标签）" class="headerlink" title="非监督学习（无标签）"></a>非监督学习（无标签）</h3><ul><li>聚类热点新闻</li><li>社交网络分析</li><li>市场划分等</li></ul><h2 id="L2-机器学习模型"><a href="#L2-机器学习模型" class="headerlink" title="L2 机器学习模型"></a>L2 机器学习模型</h2><p>以单因素线性回归为例，预测房价</p><p><img src="/2018/11/15/Machine-Learning-Coursera/cost-function.jpg" alt="cost-function"><br><img src="/2018/11/15/Machine-Learning-Coursera/gradient-descent.jpg" alt="gradient-descent"></p><ul><li>同步更新假设中的所有参数</li><li>学习速度小，则梯度下降速度慢；学习速度大，则可能错过最小值，可能不收敛，甚至发散。</li><li>凸函数，碗状，全局最优，不出现局部最优</li><li>批量梯度下降法：每次梯度下降，使用所有的训练样本</li></ul><h2 id="L3-线性代数：矩阵、向量及其运算"><a href="#L3-线性代数：矩阵、向量及其运算" class="headerlink" title="L3 线性代数：矩阵、向量及其运算"></a>L3 线性代数：矩阵、向量及其运算</h2><p>加法、乘法、求逆、转置</p><h2 id="L4-多变量线性回归"><a href="#L4-多变量线性回归" class="headerlink" title="L4 多变量线性回归"></a>L4 多变量线性回归</h2><p>与单个变量的模型及求解方法相似</p><h3 id="特征缩放：均值归一化"><a href="#特征缩放：均值归一化" class="headerlink" title="特征缩放：均值归一化"></a>特征缩放：均值归一化</h3><ul><li>特征缩放，保证特征在相似范围内，加速梯度下降，如[-3, 3]或[-1/3, 1/3]</li><li>均值归一化，样本值减去均值，除以标准差或级差</li></ul><h3 id="选择学习速度"><a href="#选择学习速度" class="headerlink" title="选择学习速度"></a>选择学习速度</h3><blockquote><p>尝试不同学习速度：0.001，0.003，0.01，0.03，0.1，0.3，1，…</p><ul><li>足够小的学习速度，代价函数随迭代次数降低。</li><li>学习速度太小，则梯度下降的收敛速度慢。太大，则可能不收敛，甚至发散。</li></ul></blockquote><h3 id="梯度下降法VS标准方程法"><a href="#梯度下降法VS标准方程法" class="headerlink" title="梯度下降法VS标准方程法"></a>梯度下降法VS标准方程法</h3><ol><li><strong>梯度下降法</strong></li></ol><ul><li>选择学习速度</li><li>多次迭代计算</li><li>特征非常多（n非常大，如10^6）时计算速度也很快</li></ul><ol start="2"><li><strong>标准方程法</strong></li></ol><ul><li>无需选择学习速度；</li><li>无需多次迭代计算；</li><li>需要计算n×n矩阵的逆矩阵，计算复杂度O(n^3)；</li><li>特征非常多（n非常大,如100,1000,10000）时，计算速度非常慢；</li></ul><h3 id="不可逆矩阵求逆"><a href="#不可逆矩阵求逆" class="headerlink" title="不可逆矩阵求逆"></a>不可逆矩阵求逆</h3><ul><li>Octave：<br>函数pinv()可求解伪逆矩阵，即便矩阵不可逆。<br>函数inv()求解逆矩阵，只有在矩阵可逆才能使用。</li></ul><p><strong>矩阵不可逆原因及对策</strong></p><ul><li>特征冗余，存在特征线性相关，如不同单位表示的房屋面积；</li><li>特征数量太多，如特征数量多余样品数量。对策，删除部分特征，正则化处理。</li></ul><h2 id="L5-Octave教程"><a href="#L5-Octave教程" class="headerlink" title="L5 Octave教程"></a>L5 Octave教程</h2><ul><li>基本操作</li><li>数据移动</li><li>数据计算</li><li>数据可视化：作图</li><li>控制语句：for，while，if</li><li>向量化应用</li></ul><h2 id="L6-逻辑回归：预测离散结果"><a href="#L6-逻辑回归：预测离散结果" class="headerlink" title="L6 逻辑回归：预测离散结果"></a>L6 逻辑回归：预测离散结果</h2><p><img src="/2018/11/15/Machine-Learning-Coursera/logistic-regression.jpg" alt="logistic-regression"></p><h3 id="二元分类（0-or-1）"><a href="#二元分类（0-or-1）" class="headerlink" title="二元分类（0 or 1）"></a>二元分类（0 or 1）</h3><p>是否为垃圾邮件、线上交易是否为诈骗、恶性or良性肿瘤</p><ol><li>模型假设：基于输入参数，预测输出结果为真(y=1)的可能性</li><li>S形函数</li><li>决策边界</li><li>代价函数</li><li>高级优化算法。<br>一般常用算法为梯度下降法，高级算法无需手动选择学习速度，通常比梯度下降法的速度要快，但是比较复杂。包含以下几种方法：</li></ol><ul><li>共轭梯度</li><li>BFGS</li><li>L-BFGS</li></ul><h3 id="多元分类：one-vs-all"><a href="#多元分类：one-vs-all" class="headerlink" title="多元分类：one vs. all"></a>多元分类：one vs. all</h3><p>拆成多个二元分类进行处理，取最大可能性</p><ul><li>邮件分组：工作、朋友、家庭、爱好</li><li>病情诊断：没病、感冒、流感</li><li>天气：晴天、多云、下雨、下雪</li></ul><h2 id="L7-正则化：应对过拟合问题"><a href="#L7-正则化：应对过拟合问题" class="headerlink" title="L7 正则化：应对过拟合问题"></a>L7 正则化：应对过拟合问题</h2><p>选用过多输入特征（变量），模型假设用训练集拟合非常好，而用测试集预测效果差</p><p>解决过拟合问题的对策：</p><ul><li>减少特征数量：手动挑选特征，调整模型算法</li><li>正则化：保留所有特征，适当减小参数值，特征很多时依然可行</li></ul><p>代价函数及其梯度引入正则化项，lambda非常大，参数接近零，则导致模型假设欠拟合</p><h2 id="L8-神经网络：正向传播"><a href="#L8-神经网络：正向传播" class="headerlink" title="L8 神经网络：正向传播"></a>L8 神经网络：正向传播</h2><p>起源：模拟大脑的算法</p><p>应用：80年代和90年代早期广泛应用，90年代末热度下降，近些年重新变得热门，得到广泛应用</p><p>神经网络结构：</p><ul><li>输入层</li><li>隐藏层（中间层）</li><li>输出层</li></ul><p>神经网络学习生成自己的特征（隐藏层）</p><p>应用举例</p><ul><li>以逻辑运算或（or）、与（and）、非（not）模拟同或（xnor，输入相同为真）</li><li>手写数字分类</li></ul><h2 id="L9-神经网络：反向传播"><a href="#L9-神经网络：反向传播" class="headerlink" title="L9 神经网络：反向传播"></a>L9 神经网络：反向传播</h2><p><strong>代价函数</strong></p><p><img src="/2018/11/15/Machine-Learning-Coursera/neural_network_cost_function.jpg" alt="neural_network_cost_function"></p><p><strong>应用细节</strong></p><ul><li>矩阵展开为列向量，matrix(:)</li><li>列向量转换成矩阵，reshape(vector, num_rows, num_columns)</li><li>梯度检查：数值计算估计梯度</li><li>随机初始化theta</li></ul><p><strong>神经网络算法</strong></p><ul><li>随机初始化theta</li><li>正向传播神经网络计算代价函数</li><li>反向传播神经网络计算梯度</li><li>数值模拟检查梯度，检查完毕关闭梯度</li><li>使用高级优化算法fminuc或计算梯度结合反向传播神经网络计算theta</li></ul><p><img src="/2018/11/15/Machine-Learning-Coursera/NN-1.jpg" alt="NN-1"><br><img src="/2018/11/15/Machine-Learning-Coursera/NN-2.jpg" alt="NN-2"></p><p>反向传播神经网络应用实例：自动驾驶</p><h2 id="L10-应用机器学习的建议"><a href="#L10-应用机器学习的建议" class="headerlink" title="L10 应用机器学习的建议"></a>L10 应用机器学习的建议</h2><h3 id="评价模型假设"><a href="#评价模型假设" class="headerlink" title="评价模型假设"></a>评价模型假设</h3><ul><li>数据集划分：70%训练集，30%测试集</li><li>利用训练集得到theta</li><li>计算测试集误差</li><li>或计算分类错误比例</li></ul><h3 id="模型选择"><a href="#模型选择" class="headerlink" title="模型选择"></a>模型选择</h3><ul><li>数据集划分：60%训练集，20%交叉验证集，20%测试集</li><li>利用训练集得到theta</li><li>利用交叉验证集选择最优模型（最高幂次）</li><li>利用测试集检查模型泛化能力</li></ul><h3 id="诊断偏差vs方差"><a href="#诊断偏差vs方差" class="headerlink" title="诊断偏差vs方差"></a>诊断偏差vs方差</h3><ol><li>选择模型幂次</li></ol><ul><li>模型幂次低，欠拟合，高偏差，训练集误差和交叉验证集误差都很高且相近</li><li>模型幂次高，过度拟合，高方差，训练集误差小，交叉验证集误差大</li></ul><ol start="2"><li>选择正则化参数lambda：<br>已基于交叉验证集选择模型幂次，增加正则化项应对过度拟合问题。</li></ol><ul><li>逐个试验选择合适lambda：0，0.01，0.02，0.04，…，10</li><li>lambda小，过度拟合，高方差，训练集误差小，测试集误差大</li><li>lambda大，欠拟合，高偏差，训练集误差和测试集误差都很高且相近</li></ul><ol start="3"><li>学习曲线</li></ol><ul><li>增加样本数量对高方差有效，而对于高偏差则帮助不大</li></ul><h3 id="应对策略"><a href="#应对策略" class="headerlink" title="应对策略"></a>应对策略</h3><ul><li>增加样本数量，适合高方差，过度拟合</li><li>减少特征数量，适合高方差，过度拟合</li><li>增加特征数量，适合高偏差，欠拟合</li><li>增加多项式特征，适合高偏差，欠拟合</li><li>降低lambda，适合高偏差，欠拟合</li><li>增大lambda，适合高方差，过度拟合</li></ul><h2 id="L11-机器学习系统设计"><a href="#L11-机器学习系统设计" class="headerlink" title="L11 机器学习系统设计"></a>L11 机器学习系统设计</h2><ul><li>以垃圾邮件分类为例</li><li>选择训练集中出现频率最高的n个词语（10000-50000）作为垃圾邮件特征</li></ul><h3 id="推荐的系统设计思路"><a href="#推荐的系统设计思路" class="headerlink" title="推荐的系统设计思路"></a>推荐的系统设计思路</h3><ul><li>首先建立可以快速应用的简单模型，利用交叉验证集进行验证</li><li>绘制学习曲线，确定是否需要更多的样本、特性等</li><li>误差分析，手动分析算法出错的样本（交叉验证集），识别这些样本的类型以及有助于算法改进的特征</li></ul><p>量化评价的重要性</p><ul><li>误差分析并不能帮助确定使用词干提取软件能否改进算法表现，唯一的办法就是尝试</li><li>通过量化比较算法在不使用与使用词干提取软件时的表现，确定是否采用词干提取软件</li></ul><h3 id="歪斜样本的误差量化"><a href="#歪斜样本的误差量化" class="headerlink" title="歪斜样本的误差量化"></a>歪斜样本的误差量化</h3><p>训练集中，有些样本非常多，有些样本非常少，样本分布不均匀。如癌症分类算法，样本中患癌症的病人非常少，绝大多数正常</p><ul><li>预测准确度precision：预测为真的样本中确实为真的比例(P)</li><li>召回率recall：确实为真的样本中预测为真的比例(R)</li><li>F1：权衡预测准确度和召回率</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">F1 = 2*PR/(P+R)</span><br></pre></td></tr></table></figure><p><strong>设计一个高准确度的学习算法</strong></p><ul><li>有非常多参数（许多特征，有很多隐藏层的神经网络）</li><li>有非常大样本（不存在过度拟合）</li><li>训练集和测试集误差相近，测试集误差小，低方差</li></ul><h2 id="L12-支持向量机"><a href="#L12-支持向量机" class="headerlink" title="L12 支持向量机"></a>L12 支持向量机</h2><p><img src="/2018/11/15/Machine-Learning-Coursera/SVM.jpg" alt="SVM"></p><p>核函数与相似度</p><ul><li>基于样本，选择地标，将m个样本赋给m个地标</li><li>利用核函数计算相似度</li></ul><p>SVM参数</p><ul><li>C：C大，高方差；C小，高偏差。</li><li>sigma^2：sigma^2大，高偏差；sigma^2小，高方差</li></ul><p>使用SVM软件包</p><ul><li>选择参数C</li><li>选择核函数：无核函数（线性核函数），高斯核函数（选择sigma^2，特征缩放）</li></ul><p>多元分类</p><ul><li>许多SVM软件包内置多元分类函数</li><li>使用 one VS all方法，训练多个SVM</li></ul><p><strong>逻辑回归vs支持向量机</strong></p><p><img src="/2018/11/15/Machine-Learning-Coursera/logistics_regression_VS_SVM.jpg" alt="logistics_regression_VS_SVM"></p><h2 id="L13-非监督学习：聚类"><a href="#L13-非监督学习：聚类" class="headerlink" title="L13 非监督学习：聚类"></a>L13 非监督学习：聚类</h2><h3 id="K-均值算法"><a href="#K-均值算法" class="headerlink" title="K-均值算法"></a>K-均值算法</h3><ol><li>随机初始化K个聚类中心。<br> 聚类中心数目小于样本数，随机选取K个训练样本，作为K个聚类中心</li><li>将样本分别分配到相应的聚类中心</li><li>计算每个聚类中心所属样本的均值</li><li>重复步骤2和3，移动聚类中心位置，使得代价函数全局最小</li></ol><p><img src="/2018/11/15/Machine-Learning-Coursera/K-means.jpg" alt="K-means"><br><img src="/2018/11/15/Machine-Learning-Coursera/K-means_Cost.jpg" alt="K-means_Cost"></p><h3 id="K值的选择"><a href="#K值的选择" class="headerlink" title="K值的选择"></a>K值的选择</h3><ul><li><strong>肘部法</strong>，曲线变化趋势缓慢，没有明确的分界点</li><li>根据算法所要实现效果的好坏，选取合适的K值</li></ul><h2 id="L14-降维：主成分分析（PCA）"><a href="#L14-降维：主成分分析（PCA）" class="headerlink" title="L14 降维：主成分分析（PCA）"></a>L14 降维：主成分分析（PCA）</h2><h3 id="数据压缩及数据可视化"><a href="#数据压缩及数据可视化" class="headerlink" title="数据压缩及数据可视化"></a>数据压缩及数据可视化</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">A[nD] --&gt; |降维| B[3D立体]</span><br><span class="line">B --&gt; |降维| C[2D平面]</span><br><span class="line">C --&gt; |降维| D[1D线段]</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">A[多指标] --&gt; |降维| B[三指标]</span><br><span class="line">B --&gt; |降维| C[二指标]</span><br><span class="line">C --&gt; |降维| D[单指标]</span><br></pre></td></tr></table></figure><ul><li><strong>二维数据降至一维数据</strong>：寻找一个向量，样本在其方向上的投影误差最小</li><li><strong>n维数据降至k维数据</strong>：寻找k个向量，样本在其方向上的投影误差最小</li><li><strong>主成分分析不是线性回归</strong></li></ul><h3 id="主成分分析（PCA）算法"><a href="#主成分分析（PCA）算法" class="headerlink" title="主成分分析（PCA）算法"></a>主成分分析（PCA）算法</h3><ol><li><strong>数据预处理</strong>：均值归一化，有选择地特征缩放</li><li>算法主体：</li></ol><p><img src="/2018/11/15/Machine-Learning-Coursera/PCA.jpg" alt="PCA"></p><ol start="3"><li>由压缩模型重建原始模型</li></ol><h3 id="选择主成分数量"><a href="#选择主成分数量" class="headerlink" title="选择主成分数量"></a>选择主成分数量</h3><p><img src="/2018/11/15/Machine-Learning-Coursera/PCA-k.jpg" alt="PCA-k"></p><h3 id="主成分分析（PCA）应用建议"><a href="#主成分分析（PCA）应用建议" class="headerlink" title="主成分分析（PCA）应用建议"></a>主成分分析（PCA）应用建议</h3><ul><li>加速监督学习，提取浓缩输入，减少矩阵的维度</li><li>数据压缩，减少存储数据占用的内存和磁盘</li><li>数据可视化</li><li>防止过度拟合（不正确的应用）</li></ul><hr><h2 id="L15-异常检测"><a href="#L15-异常检测" class="headerlink" title="L15 异常检测"></a>L15 异常检测</h2><p><strong>问题产生</strong></p><ul><li>制造业产品质检，如飞行器发动机</li><li>网络欺诈检测</li><li>监测数据中心的电脑</li></ul><h3 id="高斯（正态）分布"><a href="#高斯（正态）分布" class="headerlink" title="高斯（正态）分布"></a>高斯（正态）分布</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x ~ (μ, σ^2)</span><br></pre></td></tr></table></figure><h3 id="异常检测算法"><a href="#异常检测算法" class="headerlink" title="异常检测算法"></a>异常检测算法</h3><ol><li>选择你认为能够表征异常样本的特征</li></ol><ul><li>选择不经常出现的大数值或小数值作为特征</li><li>如果已有特征不服从高斯分布，可通过取对数、开平方等，使其符合</li></ul><ol start="2"><li>拟合各个特征的均值和标准差</li><li>给定新样本，计算相应概率，概率小于临界值即为异常样本</li></ol><h3 id="开发-评价异常检测算法"><a href="#开发-评价异常检测算法" class="headerlink" title="开发|评价异常检测算法"></a>开发|评价异常检测算法</h3><ul><li>将样本分为训练集，交叉验证集，测试集</li><li>利用训练集拟合均值和标准差参数，计算样本异常概率，建立异常检测模型</li><li>利用交叉验证集或测试集，计算F1评价算法异常检测效果</li><li>利用交叉验证集或测试集，选择异常临界值ε</li></ul><h3 id="异常检测vs监督学习"><a href="#异常检测vs监督学习" class="headerlink" title="异常检测vs监督学习"></a>异常检测vs监督学习</h3><p><strong>异常检测</strong></p><ol><li>异常样本(y=1)较少，通常0-20个</li><li>大量的正常样本(y=0)，</li><li>异常类型很多，算法很难从已有异常样本中学习到异常的特征，未来出现的异常可能与我们目前见过的异常大不相同。</li><li>异常检测算法应用：欺诈检测，产品质检，监测数据中心中的机器…</li></ol><p><strong>监督学习</strong></p><ol><li>正面与反面样本都很多</li><li>有足够的反面样本让算法学习反面样本的特征，未来的算法检测结果可能与训练集中的情况相似</li><li>监督学习算法应用：垃圾邮件分类，天气预报，癌症分类…</li></ol><h3 id="多元高斯分布"><a href="#多元高斯分布" class="headerlink" title="多元高斯分布"></a>多元高斯分布</h3><p>综合所有特征建立一个异常检测模型，不再为每个特征分别建立模型</p><p><strong>一元高斯分布vs多元高斯分布</strong></p><p><img src="/2018/11/15/Machine-Learning-Coursera/Multivariate_Gaussian.jpg" alt="Multivariate_Gaussian"></p><hr><h2 id="L16-推荐系统"><a href="#L16-推荐系统" class="headerlink" title="L16 推荐系统"></a>L16 推荐系统</h2><p>问题产生：预测电影评分，用户给电影打分，从一星到五星。</p><h3 id="基于内容的推荐算法"><a href="#基于内容的推荐算法" class="headerlink" title="基于内容的推荐算法"></a>基于内容的推荐算法</h3><p><img src="/2018/11/15/Machine-Learning-Coursera/recommendation_algorithm.jpg" alt="recommendation_algorithm"></p><h3 id="协同过滤算法"><a href="#协同过滤算法" class="headerlink" title="协同过滤算法"></a>协同过滤算法</h3><p><img src="/2018/11/15/Machine-Learning-Coursera/collaborative_filtering_cost.jpg" alt="collaborative_filtering_cost"></p><p><img src="/2018/11/15/Machine-Learning-Coursera/collaborative_filtering_algorithm.jpg" alt="collaborative_filtering_algorithm"></p><p>向量化：低秩矩阵分解</p><p>寻找相关电影，最相似的5部电影</p><p>应用细节：均值归一化</p><hr><h2 id="L17-大型机器学习"><a href="#L17-大型机器学习" class="headerlink" title="L17 大型机器学习"></a>L17 大型机器学习</h2><p>大数据集机器学习</p><h3 id="随机梯度下降法"><a href="#随机梯度下降法" class="headerlink" title="随机梯度下降法"></a>随机梯度下降法</h3><p><strong>批量梯度下降vs随机梯度下降</strong></p><p><img src="/2018/11/15/Machine-Learning-Coursera/batch_vs_stochastic.jpg" alt="batch_vs_stochastic"></p><h3 id="微型批量梯度下降"><a href="#微型批量梯度下降" class="headerlink" title="微型批量梯度下降"></a>微型批量梯度下降</h3><p><img src="/2018/11/15/Machine-Learning-Coursera/mini-batch.jpg" alt="mini-batch"></p><p><strong>三种梯度下降法对比</strong></p><ul><li><strong>批量梯度下降</strong>：每次迭代使用训练集所有样本</li><li><strong>随机梯度下降</strong>：每次迭代使用训练集1个样本</li><li><strong>微型批量梯度下降</strong>：每次迭代使用训练集部分样本（2~100）</li></ul><p>检查梯度下降是否收敛</p><ul><li><strong>批量梯度下降</strong>，绘制代价函数随迭代次数的变化曲线</li><li><strong>随机梯度下降</strong>，每迭代1000次，计算前面1000次迭代的代价函数均值。在更新参数theta之前计算代价函数。<blockquote><p>如果出现代价函数随迭代次数上升，则应使用更小的学习速度</p></blockquote></li></ul><p><strong>随机梯度下降算法</strong></p><p><img src="/2018/11/15/Machine-Learning-Coursera/stochastic_gradient_descent.jpg" alt="stochastic_gradient_descent"></p><h3 id="线上学习"><a href="#线上学习" class="headerlink" title="线上学习"></a>线上学习</h3><ul><li>网上邮寄，根据用户特点、包裹从哪到哪等信息，实现最优价格</li><li>网上产品搜索，推荐最符合描述的产品</li><li>个性化推荐工作、新闻、产品等</li></ul><h3 id="映射规约和并行计算"><a href="#映射规约和并行计算" class="headerlink" title="映射规约和并行计算"></a>映射规约和并行计算</h3><ul><li>将训练集分为若干部分，分别由若干台机器同时计算，最后一台机器对上述所有机器的计算结果进行整合</li><li>许多学习算法都可以表示为，计算函数和（关于训练集）的形式</li><li>多核计算机，可利用多核实现并行计算</li></ul><h2 id="L18-应用实例：Photo-OCR"><a href="#L18-应用实例：Photo-OCR" class="headerlink" title="L18 应用实例：Photo OCR"></a>L18 应用实例：Photo OCR</h2><p><strong>问题描述及处理流程</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">A[图片]--&gt;B[文本检测]</span><br><span class="line">B --&gt; C[字符分割]</span><br><span class="line">C --&gt; D[字符识别]</span><br></pre></td></tr></table></figure><p>检测滑行窗口文本、行人</p><h3 id="人工合成数据，获取大量数据"><a href="#人工合成数据，获取大量数据" class="headerlink" title="人工合成数据，获取大量数据"></a>人工合成数据，获取大量数据</h3><ol><li>引入“<strong>扭曲</strong>”合成数据</li></ol><ul><li>以演讲识别为例，引入的“扭曲”应该代表噪音的类型或是测试集中存在的“扭曲”，如背景噪声、连接信号差等</li><li>通常添加纯粹随机或者无意义的噪音对数据合成帮助不大</li><li>在做更多的工作之前，确保你有一个低偏差的分类器，例如增加特征数量或是神经网络隐藏层的数量，直到得到一个低偏差的分类器</li></ul><ol start="2"><li>获取10倍于当前的数据，需要花费什么样的努力？</li></ol><ul><li>人工合成数据</li><li>自己收集或标记数据</li><li>众筹，如Amazon Mechanical Turk</li></ul><h3 id="上限分析：定位关键环节"><a href="#上限分析：定位关键环节" class="headerlink" title="上限分析：定位关键环节"></a>上限分析：定位关键环节</h3><p><img src="/2018/11/15/Machine-Learning-Coursera/ceiling_analysis_photo_OCR.jpg" alt="ceiling_analysis_photo_OCR"></p><p><img src="/2018/11/15/Machine-Learning-Coursera/ceiling_analysis_face_recognition.jpg" alt="ceiling_analysis_face_recognition"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/2018/11/15/Machine-Learning-Coursera/cover_machine_learning.jpg&quot; alt=&quot;cover_machine_learning&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Source: &lt;a 
      
    
    </summary>
    
      <category term="Machine Learning" scheme="http://zsx-cup.top/categories/Machine-Learning/"/>
    
    
      <category term="Coursera" scheme="http://zsx-cup.top/tags/Coursera/"/>
    
      <category term="Andrew Ng" scheme="http://zsx-cup.top/tags/Andrew-Ng/"/>
    
  </entry>
  
  <entry>
    <title>溶液粘度</title>
    <link href="http://zsx-cup.top/2018/11/14/%E6%BA%B6%E6%B6%B2%E7%B2%98%E5%BA%A6/"/>
    <id>http://zsx-cup.top/2018/11/14/溶液粘度/</id>
    <published>2018-11-14T15:57:06.000Z</published>
    <updated>2018-11-15T23:46:15.660Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>本文参考维基百科词条：<a href="https://zh.wikipedia.org/wiki/%E9%BB%8F%E5%BA%A6#.E5.89.AA.E5.88.87.E9.BB.8F.E5.BA.A6" target="_blank" rel="noopener">粘度</a><br>和<a href="https://zh.wikipedia.org/wiki/%E7%89%B9%E6%80%A7%E9%BB%8F%E5%BA%A6" target="_blank" rel="noopener">特性粘度</a></p></blockquote><p>对于溶液（尤其是高分子溶液），常用到以下几种黏度。</p><h2 id="相对粘度"><a href="#相对粘度" class="headerlink" title="相对粘度"></a>相对粘度</h2><p>又称黏度比，是溶液（或分散相）的黏度η与溶剂（或连续相）的黏度η0之比，即：</p><p>$$\eta_r=\frac{\eta}{\eta_0}$$</p><h2 id="增比粘度"><a href="#增比粘度" class="headerlink" title="增比粘度"></a>增比粘度</h2><p>又称比黏度，是溶液（或分散相）的黏度η与溶剂（或连续相）的黏度η0之差被溶剂（或连续相）黏度的η0除得之商，即：<br>$$<br>\eta _{sp}=\frac {\eta -\eta _0}{\eta _0}=\frac {\eta}{\eta _0}-1=\eta _{r}-1<br>$$</p><h2 id="比浓粘度"><a href="#比浓粘度" class="headerlink" title="比浓粘度"></a>比浓粘度</h2><p>又称换算黏度或黏度数,是单位浓度的溶液（或分散相）的增比浓度，即：<br>$$<br>{\displaystyle {\frac {\eta _{sp}}{c}}={\frac {\eta _{r}-1}{c}}}<br>$$</p><h2 id="比浓对数粘度"><a href="#比浓对数粘度" class="headerlink" title="比浓对数粘度"></a>比浓对数粘度</h2><p>又称对数粘度，是相对黏度的自然对数被溶液（或分散相）的浓度除得之商，即：<br>$$<br>{\displaystyle \left{\eta \right}={\frac {\ln {\eta _{r}}}{c}}}<br>$$</p><h2 id="特性粘度"><a href="#特性粘度" class="headerlink" title="特性粘度"></a><a href="https://zh.wikipedia.org/wiki/%E7%89%B9%E6%80%A7%E9%BB%8F%E5%BA%A6" target="_blank" rel="noopener">特性粘度</a></h2><p>又称极限粘度，是浓度趋于零时比浓粘度的极限值，即：<br>$$<br>{\displaystyle \left[\eta \right]=\lim _{c\to 0}{\frac {\eta _{sp}}{c}}}<br>$$</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;本文参考维基百科词条：&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E9%BB%8F%E5%BA%A6#.E5.89.AA.E5.88.87.E9.BB.8F.E5.BA.A6&quot; target=&quot;_blank&quot; r
      
    
    </summary>
    
      <category term="Research" scheme="http://zsx-cup.top/categories/Research/"/>
    
    
      <category term="Petroleum" scheme="http://zsx-cup.top/tags/Petroleum/"/>
    
  </entry>
  
  <entry>
    <title>岩心驱替实验流程及注意事项</title>
    <link href="http://zsx-cup.top/2018/11/14/%E5%B2%A9%E5%BF%83%E9%A9%B1%E6%9B%BF%E5%AE%9E%E9%AA%8C%E6%B5%81%E7%A8%8B%E5%8F%8A%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/"/>
    <id>http://zsx-cup.top/2018/11/14/岩心驱替实验流程及注意事项/</id>
    <published>2018-11-14T15:47:56.000Z</published>
    <updated>2018-11-14T15:55:09.806Z</updated>
    
    <content type="html"><![CDATA[<h2 id="岩心驱替实验流程"><a href="#岩心驱替实验流程" class="headerlink" title="岩心驱替实验流程"></a>岩心驱替实验流程</h2><p>岩心驱替实验的流程主要包括如下6个步骤：</p><ol><li>抽真空造束缚水</li><li>水测渗透率</li><li>饱和油</li><li>前期水驱</li><li>注驱油剂</li><li>后续水驱</li></ol><h3 id="抽真空造束缚水"><a href="#抽真空造束缚水" class="headerlink" title="抽真空造束缚水"></a>抽真空造束缚水</h3><p>首先，岩心烘干，量取岩心直径、长度，并称量岩心质量（若采用称量法测量孔隙体积会用到）。</p><p>其次，逐段检查管线是否漏气，并在-0.1MPa压力条件下抽取4-5h，然后将吸水后岩心取出，用纸将表面水快速擦去后，再次称量其质量，岩心吸水后增加的质量，即可得到岩心孔隙体积，并可计算出孔隙度。</p><p>另外，还可以直接在岩心夹持器内抽真空（无需称质量），抽完真空后岩心吸水体积即为岩心孔隙体积，并可计算出孔隙度。</p><ul><li><strong>注意</strong>：测量岩心孔隙体积时，若管线较长，需扣除管线内水的体积。</li></ul><h3 id="水测渗透率"><a href="#水测渗透率" class="headerlink" title="水测渗透率"></a>水测渗透率</h3><p>可分别采用3个注入速度进行水测渗透率，液测渗透率取平均值，岩心各测点的压力稳定即可转入下一阶段。</p><h3 id="饱和油"><a href="#饱和油" class="headerlink" title="饱和油"></a>饱和油</h3><p>以合适的注入速度（如0.05mL/min）进行饱和油，出口端用量筒计量排出水的体积，直到不再出水，排出水的总体积即为饱和油体积，并可计算出原始含油饱和度及束缚水饱和度。岩心饱和油之后老化12h，然后进行前期水驱。</p><ul><li><strong>注意</strong>：饱和油阶段时间较长，可安排在夜间进行。</li></ul><h3 id="前期水驱"><a href="#前期水驱" class="headerlink" title="前期水驱"></a>前期水驱</h3><p>以一定的速度水驱至岩心出口端含水率高于98%，通常需要注水2PV左右，转入注驱油剂阶段（如注聚）。</p><ul><li><strong>注意</strong>：前期水驱速度需要提前确定，并和水测渗透率阶段的其中1个注入速度相同。</li></ul><h3 id="注驱油剂"><a href="#注驱油剂" class="headerlink" title="注驱油剂"></a>注驱油剂</h3><p>选定驱油剂注入速度（如0.5mL/min），注入一定PV数的驱油剂，而后转入下一阶段。聚合物驱中，通常是注入0.3PV的聚合物溶液，或者是注入到岩心各测点的压力稳定时，停止驱油剂注入，大概在3PV左右。</p><ul><li><strong>注意</strong>：驱油剂注入速度需要提前确定，并和水测渗透率阶段的其中1个注入速度相同。</li></ul><h3 id="后续水驱"><a href="#后续水驱" class="headerlink" title="后续水驱"></a>后续水驱</h3><p>注驱油剂阶段结束，转入后续水驱阶段，以相同的注入速度进行后续水驱，直至岩心各测点压力稳定。</p><ul><li><strong>注意</strong>：尽可能缩短前后两个阶段的转换时间，因为岩心各测点的压力会快速下降。</li></ul><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol><li>水测渗透率阶段压力较小（kPa数量级，如20kPa），注驱油剂阶段的压力较大（MPa数量级，如2MPa），注入压力压力大小与岩心气测渗透率和驱油剂浓度有关，所以需要选取合适量程的压力传感器。</li><li>实验前最好将压力传感器进行校准，以减小计量误差。</li><li>岩心驱替实验的围压至少比入口端压力高2MPa。</li><li>实验过程中，注意泵压变化，若压力快速上升，可能有阀门没有打开，或是发生堵塞。实验开始前需要对各个阀门进行检查（是否通畅，是否排空气，螺母是否拧紧，阀门打开是否正确等）。”</li></ol><hr><p>这篇文章的 PRESS.one 签名:<br>“<a href="https://press.one/file/v?s=47dbd0703a580716265a192518095d41e4c5d4404307da4dc5eb8d264ecdd728b1d4b6ec28b0e36dec3a6f5cfda6a65cd5072ca33b99b7f21e41d9d94c4f40951&amp;h=f5de4f6e033b6f3333a7aaee393b558b4586c8accb8aeaad6dc1cf6da63a36f5&amp;a=5fff08474362b1e48d72b083abf18d2360881d5e&amp;f=P1&amp;v=2" target="_blank" rel="noopener">https://press.one/file/v?s=47dbd0703a580716265a192518095d41e4c5d4404307da4dc5eb8d264ecdd728b1d4b6ec28b0e36dec3a6f5cfda6a65cd5072ca33b99b7f21e41d9d94c4f40951&amp;h=f5de4f6e033b6f3333a7aaee393b558b4586c8accb8aeaad6dc1cf6da63a36f5&amp;a=5fff08474362b1e48d72b083abf18d2360881d5e&amp;f=P1&amp;v=2</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;岩心驱替实验流程&quot;&gt;&lt;a href=&quot;#岩心驱替实验流程&quot; class=&quot;headerlink&quot; title=&quot;岩心驱替实验流程&quot;&gt;&lt;/a&gt;岩心驱替实验流程&lt;/h2&gt;&lt;p&gt;岩心驱替实验的流程主要包括如下6个步骤：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;抽真空造束缚水&lt;/li&gt;
      
    
    </summary>
    
      <category term="Research" scheme="http://zsx-cup.top/categories/Research/"/>
    
    
      <category term="Guide" scheme="http://zsx-cup.top/tags/Guide/"/>
    
      <category term="Petroleum" scheme="http://zsx-cup.top/tags/Petroleum/"/>
    
  </entry>
  
  <entry>
    <title>哈克流变仪粘度测量步骤及注意事项</title>
    <link href="http://zsx-cup.top/2018/11/14/%E5%93%88%E5%85%8B%E6%B5%81%E5%8F%98%E4%BB%AA%E7%B2%98%E5%BA%A6%E6%B5%8B%E9%87%8F%E6%AD%A5%E9%AA%A4%E5%8F%8A%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/"/>
    <id>http://zsx-cup.top/2018/11/14/哈克流变仪粘度测量步骤及注意事项/</id>
    <published>2018-11-14T15:23:32.000Z</published>
    <updated>2018-11-14T15:52:09.946Z</updated>
    
    <content type="html"><![CDATA[<p>聚合物溶液流变性（如粘度）测量仪器为HAKKE RS6000旋转流变仪，流变仪由4部分组成：</p><ol><li>空气压缩机；</li><li>温控系统；</li><li>流变测量系统；</li><li>软件系统（控制-测量-数据处理）。</li></ol><h2 id="液体粘度测量的操作步骤："><a href="#液体粘度测量的操作步骤：" class="headerlink" title="液体粘度测量的操作步骤："></a>液体粘度测量的操作步骤：</h2><ol><li>开机，其顺序为：空气压缩机→温控仪→测量系统→电脑控制系统。</li><li>根据被测样品及其测量条件，选择安装合适的转子系统和温控器，并在测量程序中首先选择对应的转子和温控器。</li><li>新建测量文件（Job），文件包含常规要素（General elements）、测量要素（Measurement elements）、评价要素（Evaluation elements）3个部分。<strong>通常测量，只需将温度模块和测量方法两个模块拖至右侧，并进行简单设置即可（温度、剪切速率上下限）。</strong></li><li>测量台调平。使测量台处于水平状态。</li><li>校零（Zero point）。校准上下椎板的距离。</li><li>加样，用移液管向下椎板中心部位移取1.5mL左右的待测溶液。</li><li>开始测量，点击Start按钮开始测量，测量结束输入文件名保存文件。</li><li>分离并清洗上下椎板，并导出测量数据（数据全选复制到Excel表格中）。</li><li>关机，关机顺序与开机顺序刚好相反。</li></ol><h2 id="相关注意事项"><a href="#相关注意事项" class="headerlink" title="相关注意事项"></a>相关注意事项</h2><h3 id="设置剪切速率"><a href="#设置剪切速率" class="headerlink" title="设置剪切速率"></a>设置剪切速率</h3><p>在设置剪切速率时，首先需要选中测量模式的CR（控制剪切速率）才进行设置（CS是表示控制应力）。而且，除了设置上下限，还有剪切速率是以ln还是log进行分布，两者的区别在于：</p><ul><li><strong>ln模式</strong>：测量点在剪切速率上限附近多，下限附近稀疏，<strong>适合目标剪切速率较大的测量。</strong></li><li><strong>log模式</strong>：与ln模式相反，测量点在剪切速率上限附近稀疏，下限附近多，<strong>适合目标剪切速率较小（如7.34s-1）的测量。</strong></li></ul><h3 id="设置测量步数及单步测量停止条件"><a href="#设置测量步数及单步测量停止条件" class="headerlink" title="设置测量步数及单步测量停止条件"></a>设置测量步数及单步测量停止条件</h3><p>测量步数需要结合剪切速率上下限进行设置，以保证剪切速率与目标值尽可能接近，例如聚合物粘度测量常用的剪切速率0.1~1000，100个测量点，log模式，剪切速率目标值7.34s-1，实际值7.221-1很接近。</p><p><strong>单步测量停止条件</strong>：默认每个剪切速率测量30s时间，然后改变剪切速率再次测量，直到最后。测量步数和单步测量时间决定了每个样品的测试时间。以剪切速率0.1~1000,100步，单步测量时间30s，一个样品耗时3300s，即55min。样品量少，如果测量温度较高，则测量时间不能太久，否则样品挥发，导致测量失败。所以在不影响测量结果情况下，适当减少测量步数，缩短单步测量时间（如10s），以及设置限制条件gradient =0.5都可减少测量时间。</p><p>如果常用某种测量模式（JOB），新建并设置测量文件后，可保存并命名该测量文件，以便下次测试时直接调用。</p><h3 id="常见异常及处理"><a href="#常见异常及处理" class="headerlink" title="常见异常及处理"></a>常见异常及处理</h3><ol><li><strong>测量过程中，弹出温控系统Timeout错误信息。</strong> 需检查各插头连接是否良好，并重启温控系统重新测量。</li><li><p><strong>当测量出现粘度非常大（几十万），粘度及应力曲线出现异常的杂峰状况</strong>：</p><ul><li>一种情况，空气压缩机未打开，打开后再次测量即可。</li><li>第二种情况，测量台未处于水平状态（即把水平仪放置于测量台上，其中气泡偏离正常区域），可通过调节流变仪底座的四个支点使其处于水平状态，再次进行测量。</li><li><strong>另外，注意每次实验前必须检查测量台是否处于水平状态，然后进行归零校准！！！</strong></li></ul></li><li><p><strong>控制流变仪的电脑故障：主机指示灯状态为3和4，显示屏无法显示</strong>。请按照下图提示自行解决：<br><img src="/2018/11/14/哈克流变仪粘度测量步骤及注意事项/Bug.jpg" alt="Bug">“</p></li></ol><hr><p>这篇文章的 PRESS.one 签名:<br>“<a href="https://press.one/file/v?s=518e1251f8cf0d964dc9cb4b67f622974412f2cbad579673390d04c8671f03ec8e7f2e152ede080fc663f06eeb47db76f269ff3100f9da3eaa3fe17839f02e3f0&amp;h=8638863ba0c65b8bad2edeef7c0205fadb0a7eecdec5cfa0f528aedff9da4c7d&amp;a=5fff08474362b1e48d72b083abf18d2360881d5e&amp;f=P1&amp;v=2" target="_blank" rel="noopener">https://press.one/file/v?s=518e1251f8cf0d964dc9cb4b67f622974412f2cbad579673390d04c8671f03ec8e7f2e152ede080fc663f06eeb47db76f269ff3100f9da3eaa3fe17839f02e3f0&amp;h=8638863ba0c65b8bad2edeef7c0205fadb0a7eecdec5cfa0f528aedff9da4c7d&amp;a=5fff08474362b1e48d72b083abf18d2360881d5e&amp;f=P1&amp;v=2</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;聚合物溶液流变性（如粘度）测量仪器为HAKKE RS6000旋转流变仪，流变仪由4部分组成：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;空气压缩机；&lt;/li&gt;
&lt;li&gt;温控系统；&lt;/li&gt;
&lt;li&gt;流变测量系统；&lt;/li&gt;
&lt;li&gt;软件系统（控制-测量-数据处理）。&lt;/li&gt;
&lt;/ol&gt;

      
    
    </summary>
    
      <category term="Research" scheme="http://zsx-cup.top/categories/Research/"/>
    
    
      <category term="Guide" scheme="http://zsx-cup.top/tags/Guide/"/>
    
      <category term="Petroleum" scheme="http://zsx-cup.top/tags/Petroleum/"/>
    
  </entry>
  
  <entry>
    <title>MySQL数据库</title>
    <link href="http://zsx-cup.top/2018/11/13/MYSQL%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    <id>http://zsx-cup.top/2018/11/13/MYSQL数据库/</id>
    <published>2018-11-13T15:45:49.000Z</published>
    <updated>2018-12-02T15:23:16.322Z</updated>
    
    <content type="html"><![CDATA[<p>MySQL数据库是一个小型关系型数据库管理系统，开发者为瑞典MySQL AB公司。在2008年1月16号被Sun公司收购。而2009年，Sun公司又被Oracle公司收购。目前MySQL被广泛地应用在Internet上的中小型网站中。由于其体积小、速度快、总体拥有成本低，尤其是开放源码这一特点，许多中小型网站为了降低网站总体拥有成本而选择了MySQL作为网站数据库。</p><h2 id="MySQL数据库的下载安装"><a href="#MySQL数据库的下载安装" class="headerlink" title="MySQL数据库的下载安装"></a>MySQL数据库的下载安装</h2><p>MySQL官方下载地址：<a href="https://dev.mysql.com/downloads/mysql/" target="_blank" rel="noopener">MySQL</a></p><p>如果重装mysql，可先删除服务：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Sc delete MySQL</span><br></pre></td></tr></table></figure></p><p>①　解压mysql-5.7.17-winx64.zip压缩包（32位操作系统的请下载winx32的压缩包）</p><p>②　进入到刚才的解压目录，修改my-default.ini配置文件，修改后保存：</p><pre><code>//注意：替换MySQL安装路径basedir = C:\mysql\mysql-5.7.17-winx64datadir = C:\mysql\mysql-5.7.17-winx64\dataport = 3306</code></pre><p>③　添加环境变量：</p><pre><code>//注意：替换MySQL安装路径MYSQL_HOME：C:\mysql\mysql-5.7.17-winx64</code></pre><p>将MYSQL_HOME追加到系统的path变量的末尾， 注意用英文分号（;）隔开。追加内容： </p><pre><code>;%MYSQL_HOME%\bin;</code></pre><p>④　将MySQL添加到系统服务中并启动：</p><p>1)  右键“开始”——&gt; “运行(R)”或者快捷键：“开始”+“R”(以管理员身份运行cmd)<br>2)  cd 到MySQL所在的本地磁盘路径的bin目录，然后执行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//替换MySQL安装路径</span><br><span class="line">mysqld install MySQL --defaults-file=&quot;D:\Mysql01\mysql-5.7.17-winx64\my-default.ini&quot;</span><br></pre></td></tr></table></figure></p><p>启动mysql：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">net start mysql</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">此时会出现MySQL服务无法启动，服务没有报告任何错误。</span><br><span class="line">解决办法：</span><br><span class="line">执行如下代码：</span><br><span class="line">```mysql</span><br><span class="line">mysqld --install</span><br><span class="line">mysqld --initialize</span><br><span class="line">net start mysql</span><br></pre></td></tr></table></figure></p><p>⑤　修改mysql密码</p><p>Mysql在启动后会初始化一个默认密码，该密码在mysql的安装目录data/xxx.err结尾的文件中。</p><pre><code>[Note] A temporary password is generated for root@localhost: ******</code></pre><p>在cmd下执行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure></p><p>输入上面文件中的密码，即可进入mysql操作界面。<br>然后执行如下代码以修改密码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//root即为新密码</span><br><span class="line">SET PASSWORD = PASSWORD(&apos;root&apos;);</span><br></pre></td></tr></table></figure><p>使用quit或者exit退出mysql，在cmd下执行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure></p><p>然后输入设置的密码后就能登录到mysql中。</p><h2 id="数据库和表的操作"><a href="#数据库和表的操作" class="headerlink" title="数据库和表的操作"></a>数据库和表的操作</h2><h3 id="数据库的操作"><a href="#数据库的操作" class="headerlink" title="数据库的操作"></a>数据库的操作</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">1 查看当前所有的数据库</span><br><span class="line">show databases;</span><br><span class="line"></span><br><span class="line">2 创建数据库</span><br><span class="line">create database &lt;database name&gt;;</span><br><span class="line"></span><br><span class="line">3 展示创建数据库</span><br><span class="line">show create database &lt;database name&gt;;</span><br><span class="line"></span><br><span class="line">4 创建数据库指定编码</span><br><span class="line">create database &lt;database name&gt; character set utf8;</span><br><span class="line"></span><br><span class="line">5 删除数据库</span><br><span class="line">drop database &lt;database name&gt;;</span><br><span class="line"></span><br><span class="line">6 选择使用数据库</span><br><span class="line">use &lt;database name&gt;;</span><br><span class="line"></span><br><span class="line">7 查看当前使用数据库</span><br><span class="line">select database();</span><br></pre></td></tr></table></figure><h3 id="表的操作"><a href="#表的操作" class="headerlink" title="表的操作"></a>表的操作</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1 创建表</span><br><span class="line">create table &lt;tableName&gt;(id int, name varchar(30));</span><br><span class="line"></span><br><span class="line">2 查看当前数据库中所有的表</span><br><span class="line">show tables;</span><br><span class="line"> </span><br><span class="line">3 查看表结构</span><br><span class="line">desc &lt;tableName&gt;;</span><br><span class="line"> </span><br><span class="line">4 创建表时的数据约束类型</span><br><span class="line">create table &lt;tableName&gt;(id int primary key auot_increment, name varchar(30) not null, email varchar(30) noy null unique, role varchar(20) default &apos;VIP&apos;);</span><br></pre></td></tr></table></figure><h2 id="对数据进行操作"><a href="#对数据进行操作" class="headerlink" title="对数据进行操作"></a>对数据进行操作</h2><p>对数据进行操作主要有：增、删、改、查</p><h3 id="增加数据"><a href="#增加数据" class="headerlink" title="增加数据"></a>增加数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1 向表中插入指定字段的数据</span><br><span class="line">insert into &lt;tableName&gt; (id,name,email) values(1,&apos;zsx&apos;,&apos;zsx@qq.com&apos;);</span><br><span class="line"></span><br><span class="line">3 插入所有列的所有数据</span><br><span class="line">insert into &lt;tableName&gt; values(1,&apos;zsx&apos;,&apos;zsx@qq.com&apos;,&apos;MVP&apos;);</span><br></pre></td></tr></table></figure><h3 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1 删除表中所有数据</span><br><span class="line">delete from  表名   删除所有的数据</span><br><span class="line"></span><br><span class="line">2 删除表中指定条件的数据</span><br><span class="line">delete from 表名  where 条件</span><br><span class="line"></span><br><span class="line">3 将表的数据清空 ，表结构截断 ，相当于生成一个新的表格 。</span><br><span class="line">Truncate  table 表名</span><br></pre></td></tr></table></figure><h3 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Update 表名 set 字段1 = 值1 ，字段2 = 值2 ......where 条件</span><br></pre></td></tr></table></figure><h3 id="查询数据"><a href="#查询数据" class="headerlink" title="查询数据"></a>查询数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1 简单无条件查询所有的数据</span><br><span class="line">select * from 表名</span><br><span class="line"></span><br><span class="line">2 条件查询数据</span><br><span class="line">select * from 表名 where 条件</span><br></pre></td></tr></table></figure><p>条件查询代码示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">1.查询所有计算机类商品信息</span><br><span class="line">select * from products where category = &apos;计算机&apos;</span><br><span class="line"></span><br><span class="line">2.查询出商品价格大于90的商品信息</span><br><span class="line">select * from products where price &gt; 90</span><br><span class="line"></span><br><span class="line">3.查询出商品总价大于10000的商品信息</span><br><span class="line">select * from products where price*pnum &gt;10000</span><br><span class="line"></span><br><span class="line">4.查询出价格在100-200之间的商品信息</span><br><span class="line">select * from products where price &gt;=100 and price &lt;=200</span><br><span class="line">select * from products where price between 100 and 200</span><br><span class="line"></span><br><span class="line">5.查询出ID在1和5之间，并且价格在50和100之间</span><br><span class="line">select * from products where (id between 1 and 5) and (price between 50 and 100)</span><br><span class="line"></span><br><span class="line">6.查询出商品价格是65,100或190的商品信息(两种方式：or，in)</span><br><span class="line">select * from products where price = 65 or price = 100 or price = 190</span><br><span class="line">select * from products where price in (65,100,190)</span><br><span class="line"></span><br><span class="line">7.查询出商品的名称中包含java的商品信息。</span><br><span class="line">select * from products where name like &apos;%java%&apos; //含java</span><br><span class="line">select * from products where name like &apos;java%&apos; //以java开头</span><br><span class="line">select * from products where name like &apos;%java&apos; //以java结尾</span><br><span class="line">select * from products where name like &apos;_java%&apos; //java前有一个字符</span><br><span class="line"></span><br><span class="line">8.查询出商品价格不为null商品信息</span><br><span class="line">select * from products where price is not null</span><br></pre></td></tr></table></figure></p><h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1 查询出所有商品，根据数量进行升序排列，如果数量相同，根据价格进行降序排列</span><br><span class="line">select * from products order by pnum asc, price desc</span><br><span class="line"></span><br><span class="line">2 查询出id小于8的商品，根据数量进行升序排列，如果数量相同，根据价格进行降序排列</span><br><span class="line">select * from products where id &lt; 8 order by pnum asc, price desc</span><br></pre></td></tr></table></figure><h3 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">1.统计商品表中共有多少条记录</span><br><span class="line">select count(*) from products</span><br><span class="line"></span><br><span class="line">2.统计商品表中价格大于50的有多少条记录</span><br><span class="line">select count(*) from products where price &gt; 50</span><br><span class="line"></span><br><span class="line">3.统计有多少商品</span><br><span class="line">select sum(pnum) from products</span><br><span class="line"></span><br><span class="line">4.统计所有商品的总价值</span><br><span class="line">select sum(price*pnum) from products</span><br><span class="line"></span><br><span class="line">5.统计所有商品的平均价格</span><br><span class="line">select sum(price*pnum)/sum(pnum) from products</span><br><span class="line"></span><br><span class="line">6.统计出记录中price的平均值</span><br><span class="line">select avg(price) from products</span><br><span class="line"></span><br><span class="line">7.统计出商品表中price最大与最小值</span><br><span class="line">select max(price), min(price) from products</span><br></pre></td></tr></table></figure><h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//子查询：一条语句的查询结果作为另一条查询的条件</span><br><span class="line">select * from products where price in (select price from products where id &lt; 8)</span><br></pre></td></tr></table></figure><h3 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h3><p>GROUP BY 语句用于结合聚合函数，根据一个或多个列对结果集进行分组。语法解析如下：</p><pre><code>SELECT column_name, aggregate_function(column_name)FROM table_nameWHERE column_name operator valueGROUP BY column_nameHAVING 条件</code></pre><p>代码示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1 对商品分类别统计，求出每一种类商品的总数量</span><br><span class="line">select category,sum(pnum) from products group by category</span><br><span class="line"></span><br><span class="line">2 对商品分类别统计，求出每一种类商品的总数量，数量要大于100</span><br><span class="line">select category,sum(pnum) from products group by category having sum(pnum)&gt;100</span><br><span class="line"></span><br><span class="line">3 对id小于9的商品分类别统计，求出每一种类商品的总数量，要求数量要大于100，并以数量降序排列，而且只显示前两名</span><br><span class="line">select category,sum(pnum) from products where id&lt;9 group by category having sum(pnum)&gt;100 order by sum(pnum) desc limit 1,2</span><br></pre></td></tr></table></figure></p><p>Having与where的区别：</p><ol><li>having是在分组后对数据进行过滤，where是在分组前对数据进行过滤  </li><li>having后面可以使用分组函数(统计函数)，where后面不可以使用分组函数。</li></ol><h2 id="操作数据库的客户端"><a href="#操作数据库的客户端" class="headerlink" title="操作数据库的客户端"></a>操作数据库的客户端</h2><p>在dos命令中操作数据库有很多不方便，用数据库客户端软件Navicat操作数据库。</p><h2 id="多表设计"><a href="#多表设计" class="headerlink" title="多表设计"></a>多表设计</h2><ol><li><p>一对一：<br>如同身份证，一个人和唯一身份证绑定。实际中，不太常用。</p></li><li><p>一对多：<br>在进行表设计时，如果存在一对多关系，要求在多的一方加入一个外键，用于描述它来自于一方的主键。</p></li><li><p>多对多：<br>存在多对多关系，进行表设计时，产生一个中间的关系表，来描述关系。       </p></li></ol><h2 id="外键约束"><a href="#外键约束" class="headerlink" title="外键约束"></a>外键约束</h2><p>表与表之间的关系也包括：一对一，一对多，多对多。而表与表之间关系是通过外键来维护的。将两张表关联起来，让表和表发生关系。<br>外键约束特性如下：</p><ul><li>外键必须是另一表或自身表的主键的值；</li><li>外键可以重复；</li><li>外键可以为空；</li><li>一张表中可以有多个外键。</li></ul><p><strong>外键约束作用:可以保证数据的完整性。</strong><br>以用户与订单（一对多）进行说明，创建外键约束有两种方式：</p><h3 id="先建表后添加外键"><a href="#先建表后添加外键" class="headerlink" title="先建表后添加外键"></a>先建表后添加外键</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">-- 用户表</span><br><span class="line">CREATE TABLE USER(</span><br><span class="line">    uid INT PRIMARY KEY AUTO_INCREMENT, -- 用户编号</span><br><span class="line">    NAME VARCHAR(20)  -- 用户姓名</span><br><span class="line">);</span><br><span class="line">-- 用户表插入数据</span><br><span class="line">INSERT INTO USER VALUES(NULL,&quot;tom&quot;);</span><br><span class="line">INSERT INTO USER VALUES(NULL,&quot;fox&quot;);</span><br><span class="line"></span><br><span class="line">-- 订单表</span><br><span class="line">CREATE TABLE orders(</span><br><span class="line">    id INT PRIMARY KEY AUTO_INCREMENT, -- 订单编号</span><br><span class="line">    money DOUBLE, -- 订单总价</span><br><span class="line">    receiveraddress VARCHAR(50), -- 订单收货地址</span><br><span class="line">    uid INT  -- 用户id</span><br><span class="line">);</span><br><span class="line">-- 订单表插入数据</span><br><span class="line">INSERT INTO orders VALUES(NULL,1000,&quot;北京&quot;,1);</span><br><span class="line">INSERT INTO orders VALUES(NULL,2000,&quot;上海&quot;,1);</span><br><span class="line">INSERT INTO orders VALUES(NULL,3000,&quot;广州&quot;,2);</span><br><span class="line">INSERT INTO orders VALUES(NULL,4000,&quot;深圳&quot;,2);</span><br><span class="line"></span><br><span class="line">-- 表创建后添加外键</span><br><span class="line">ALTER TABLE orders ADD CONSTRAINT FK_UID  FOREIGN KEY(uid) REFERENCES USER(uid);</span><br></pre></td></tr></table></figure><h3 id="创建表时指定外键"><a href="#创建表时指定外键" class="headerlink" title="创建表时指定外键"></a>创建表时指定外键</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">-- 用户表</span><br><span class="line">CREATE TABLE USER(</span><br><span class="line">    uid INT PRIMARY KEY AUTO_INCREMENT, -- 用户编号</span><br><span class="line">    NAME VARCHAR(20)  -- 用户姓名</span><br><span class="line">);</span><br><span class="line">-- 用户表插入数据</span><br><span class="line">INSERT INTO USER VALUES(NULL,&quot;tom&quot;);</span><br><span class="line">INSERT INTO USER VALUES(NULL,&quot;fox&quot;);</span><br><span class="line"></span><br><span class="line">-- 创建表时指定外键</span><br><span class="line">CREATE TABLE orders(</span><br><span class="line">    id INT PRIMARY KEY AUTO_INCREMENT, -- 订单id</span><br><span class="line">    money DOUBLE, -- 订单总价</span><br><span class="line">    receiveraddress VARCHAR(50), -- 订单收货地址</span><br><span class="line">    uid INT, -- 用户id</span><br><span class="line">    CONSTRAINT FK_UID FOREIGN KEY orders(uid) REFERENCES USER(uid)  </span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 订单表插入数据</span><br><span class="line">INSERT INTO orders VALUES(NULL,1000,&quot;北京&quot;,1);</span><br><span class="line">INSERT INTO orders VALUES(NULL,2000,&quot;上海&quot;,1);</span><br><span class="line">INSERT INTO orders VALUES(NULL,3000,&quot;广州&quot;,2);</span><br><span class="line">INSERT INTO orders VALUES(NULL,4000,&quot;深圳&quot;,2);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;MySQL数据库是一个小型关系型数据库管理系统，开发者为瑞典MySQL AB公司。在2008年1月16号被Sun公司收购。而2009年，Sun公司又被Oracle公司收购。目前MySQL被广泛地应用在Internet上的中小型网站中。由于其体积小、速度快、总体拥有成本低，尤
      
    
    </summary>
    
      <category term="MySQL" scheme="http://zsx-cup.top/categories/MySQL/"/>
    
    
  </entry>
  
</feed>
